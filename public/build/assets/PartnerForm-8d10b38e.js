import{d as R,e as u,u as Q,x as W,Q as v,V as Z,o as d,R as O,w as g,k as U,t as i,g as o,b as a,c,a as x,n as p,i as n,h as b,a0 as j,v as f,f as q,_ as G,a9 as H,m as J,l as K,Z as X}from"./main-6e47ceb6.js";import{b as Y}from"./toggle-b1a111c5.js";import{s as k}from"./multiselect-27b4da8b.js";import{F as h}from"./formMode-f60a729f.js";import{P as w}from"./partnerType-65f9f978.js";const ee=["onSubmit"],ae={class:"grid grid-cols-2 gap-3"},re={key:0,class:"flex flex-wrap items-center"},se=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),te={key:0,class:"ml-36 w-full text-red-500 text-sm"},oe={class:"flex flex-wrap items-start"},le=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Center",-1),de={class:"flex flex-wrap items-start"},ne=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Type",-1),ue=["value"],ie=["value"],ce=["value"],pe={key:0,class:"ml-28 w-full text-red-500 text-sm"},be={class:"flex flex-wrap items-start"},me=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),ve={key:0,class:"w-full ml-36 text-red-500 text-sm"},fe={class:"flex flex-wrap items-start"},he=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Phone Number",-1),ye={key:0,class:"w-full ml-36 text-red-500 text-sm"},_e={class:"flex flex-wrap items-start"},ge=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Email",-1),xe={key:0,class:"w-full ml-36 text-red-500 text-sm"},we={class:"flex flex-wrap items-start"},Ve=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Address",-1),ke=a("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Price List",-1),Ie={class:"col-span-2 flex flex-wrap items-start"},Pe=a("span",{class:"w-full p-1 font-semibold"},"Notes",-1),Ce=["disabled"],De=R({__name:"PartnerForm",emits:["close"],setup(Ne,{emit:L}){const I=J(),S=K(),e=u({}),y=u(h.Create),_=u(!1),t=u({}),P=u([]),C=u([]),m=Q().user.branches;W(()=>{m.length===1&&(e.value.branchId=m[0].id,V()),I.path.endsWith("/edit")&&(y.value=h.Edit,$(I.params.id))});const B=async()=>{const{data:l}=await v.get(`/api/price-lists/list?branchId=${e.value.branchId}`);P.value=l.data},D=async()=>{const{data:l}=await v.get(`/api/partners/list?branchId=${e.value.branchId}&type=${w.Center}`);C.value=l.data},$=async l=>{const{data:r}=await v.get(`/api/partners/${l}`);e.value=r.data,V()},V=()=>{B(),D()},z=()=>{e.value.priceListId=null,e.value.centerId=null},A=async()=>{_.value=!0;try{y.value===h.Create?await E():await M(),X.fire()}catch(l){t.value=l.response.data.errors??{}}_.value=!1},E=async()=>{await v.post("/api/partners",e.value),T()},M=async()=>{await v.patch(`/api/partners/${e.value.id}`,e.value),N()},T=()=>{e.value={branchId:e.value.branchId},t.value=[]},N=()=>{L("close"),S.back()};return(l,r)=>{const F=Z("maska");return d(),O(H,{"modal-class":"!w-[60rem]"},{header:g(()=>[U(i(y.value===o(h).Create?"Create New Partner":"Edit Partner"),1)]),body:g(()=>[a("form",{id:"form",onSubmit:q(A,["prevent","stop"])},[a("div",ae,[o(m).length>1?(d(),c("div",re,[se,x(o(k),{modelValue:e.value.branchId,"onUpdate:modelValue":r[0]||(r[0]=s=>e.value.branchId=s),options:o(m),onSelect:V,onChange:z,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-clear":!1,"can-deselect":!1,class:p(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":t.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),t.value.hasOwnProperty("branchId")?(d(),c("p",te,i(t.value.branchId[0]),1)):n("",!0)])):n("",!0),a("div",oe,[le,x(o(k),{modelValue:e.value.centerId,"onUpdate:modelValue":r[1]||(r[1]=s=>e.value.centerId=s),options:C.value,searchable:!0,"value-prop":"id","track-by":"name",label:"name",class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])]),a("div",de,[ne,b(a("select",{"onUpdate:modelValue":r[2]||(r[2]=s=>e.value.type=s),class:p(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":t.value.hasOwnProperty("type")}])},[a("option",{value:o(w).Center},"Center",8,ue),a("option",{value:o(w).Lab},"Lab",8,ie),a("option",{value:o(w).Doctor},"Doctor",8,ce)],2),[[j,e.value.type]]),t.value.hasOwnProperty("type")?(d(),c("p",pe,i(t.value.type[0]),1)):n("",!0)]),a("div",be,[me,b(a("input",{"onUpdate:modelValue":r[3]||(r[3]=s=>e.value.name=s),size:"1",class:p(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":t.value.hasOwnProperty("name")}])},null,2),[[f,e.value.name]]),t.value.hasOwnProperty("name")?(d(),c("p",ve,i(t.value.name[0]),1)):n("",!0)]),a("div",fe,[he,b(a("input",{"onUpdate:modelValue":r[4]||(r[4]=s=>e.value.phoneNumber=s),"data-maska":"+0","data-maska-tokens":"0:[0-9]:multiple",size:"1",class:p(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":t.value.hasOwnProperty("phoneNumber")}])},null,2),[[f,e.value.phoneNumber],[F]]),t.value.hasOwnProperty("phoneNumber")?(d(),c("p",ye,i(t.value.phoneNumber[0]),1)):n("",!0)]),a("div",_e,[ge,b(a("input",{"onUpdate:modelValue":r[5]||(r[5]=s=>e.value.email=s),size:"1",class:p(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":t.value.hasOwnProperty("email")}])},null,2),[[f,e.value.email]]),t.value.hasOwnProperty("email")?(d(),c("p",xe,i(t.value.email[0]),1)):n("",!0)]),a("div",we,[Ve,b(a("input",{"onUpdate:modelValue":r[6]||(r[6]=s=>e.value.address=s),size:"1",class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512),[[f,e.value.address]])]),a("div",{class:p(["flex flex-wrap items-start",{"col-span-2":o(m).length===1}])},[ke,x(o(k),{modelValue:e.value.priceListId,"onUpdate:modelValue":r[7]||(r[7]=s=>e.value.priceListId=s),options:P.value,searchable:!0,"value-prop":"id","track-by":"name",label:"name",class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])],2),a("div",Ie,[Pe,b(a("textarea",{"onUpdate:modelValue":r[8]||(r[8]=s=>e.value.notes=s),class:"flex-1 p-2 border border-gray-300 rounded focus:border-blue-500"},null,512),[[f,e.value.notes]])])])],40,ee)]),footer:g(()=>[a("button",{class:"btn-blue mr-2",disabled:_.value,form:"form"},[x(G,{"is-loading":_.value},{default:g(()=>[U("Save")]),_:1},8,["is-loading"])],8,Ce),a("button",{onClick:N,class:"btn-gray"},"Cancel"),y.value===o(h).Edit?(d(),O(o(Y),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":r[9]||(r[9]=s=>e.value.isActive=s),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):n("",!0)]),_:1})}}});export{De as default};
