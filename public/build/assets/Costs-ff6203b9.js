import{d as k,g as p,x as $,y as M,o,c as r,a as f,w as v,i as _,Q as w,r as R,V as S,b as e,t as i,k as x,F as C,a2 as B,R as F,m as L,j as N,T,Z as A,a0 as I}from"./main-cee2eb24.js";import{M as Q}from"./Master-e24133cb.js";import{_ as U}from"./Paginator.vue_vue_type_script_setup_true_lang-fc9e564e.js";import{u as j}from"./urlQueryManager-ab4c0999.js";import{i as P}from"./index.es-89960bab.js";import{d as Y}from"./datepickerPresets-1f6bbcad.js";import{_ as q}from"./BranchFilter.vue_vue_type_script_setup_true_lang-d1bfbfa5.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-97a39018.js";const z={class:"ml-auto flex items-center gap-2"},E=k({__name:"CostsFilter",emits:["change"],setup(V,{emit:y}){const d=new URLSearchParams(location.search),n=p(""),s=p([null,null]);$(()=>{g()});const b=M(()=>s.value[0]===null||s.value[1]===null?"":`${s.value[0]}~${s.value[1]}`),g=()=>{n.value=d.get("branchId")??"",d.get("dateRange")&&(s.value=d.get("dateRange").split("~"))},h=()=>{let l=`branchId=${n.value}&dateRange=${b.value}&page=1`;y("change",l)};return(l,c)=>(o(),r("div",z,[f(q,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=a=>n.value=a),onChange:h},null,8,["modelValue"]),f(_(P),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:_(Y),placeholder:"Select date range",value:s.value,"onUpdate:value":c[1]||(c[1]=a=>s.value=a),onChange:h,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":v(()=>[]),_:1},8,["shortcuts","value"])]))}}),H={class:"flex justify-between"},O=e("h1",null,"Costs",-1),W={class:"mb-5 flex items-center gap-5"},Z={class:"pr-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},G={class:"w-full"},J={class:"sticky top-0 z-10 text-left"},K=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Reg. No.",-1),X=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Test",-1),ee=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Amount",-1),te=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Date",-1),se=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Branch",-1),oe={key:0,class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},ae={class:"transition even:bg-gray-100"},re={class:"border border-gray-200 px-2 py-1"},ne={key:1},le={class:"border border-gray-200 px-2 py-1"},ie={class:"border border-gray-200 px-2 py-1"},de={class:"border border-gray-200 px-2 py-1"},ce={class:"border border-gray-200 px-2 py-1"},ue={key:0,class:"border border-gray-200 px-2 py-1 text-center"},pe={class:"flex justify-center gap-3"},_e=["onClick"],he=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),me=[he],Ve=k({__name:"Costs",setup(V){const y=p([]),d=p({}),n=p(),s=p(!1),{updateUrlQuery:b}=j(),{hasPermissionTo:g,hasAnyPermission:h}=T();$(()=>l(location.search));const l=async a=>{const u=await b(a),{data:m}=await w.get(`/api/costs?${u}`);y.value=m.data,d.value=m.meta,n.value=m.total,s.value=!1},c=async a=>{const{isConfirmed:u}=await A.fire();u&&(await w.delete(`/api/costs/${a}`),I.fire(),await l(location.search))};return(a,u)=>{const m=R("router-link"),D=S("tip");return o(),r(C,null,[f(Q,null,{header:v(()=>[e("div",H,[O,e("p",null,"Total: "+i(n.value?.toLocaleString()),1)])]),body:v(()=>[e("div",W,[f(E,{onChange:l})]),e("section",Z,[e("table",G,[e("thead",null,[e("tr",J,[K,X,ee,te,se,_(h)("Cost.delete")?(o(),r("th",oe)):x("",!0)])]),e("tbody",null,[(o(!0),r(C,null,B(y.value,t=>(o(),r("tr",ae,[e("td",re,[_(g)("Visit.view")?(o(),F(m,{key:0,class:"text-blue-500 underline",to:`/visits?branchId=${t.branchId}&visitNumber=${t.visit.number}`},{default:v(()=>[L(i(t.visit.number),1)]),_:2},1032,["to"])):(o(),r("p",ne,i(t.visit.number),1))]),e("td",le,i(t.order.test.shortForm),1),e("td",ie,i(t.amount?.toLocaleString()),1),e("td",de,i(t.date),1),e("td",ce,i(t.branch.name),1),_(h)("Cost.delete")?(o(),r("td",ue,[e("div",pe,[_(g)("Cost.delete")?N((o(),r("button",{key:0,onClick:fe=>c(t.id),class:"cursor-pointer text-red-500"},me,8,_e)),[[D,"Delete"]]):x("",!0)])])):x("",!0)]))),256))])])])]),_:1}),f(U,{data:d.value,onChange:u[0]||(u[0]=t=>l(`page=${t}`)),class:"mt-3"},null,8,["data"])],64)}}});export{Ve as default};
