import{d as E,f as F,e as M,g as v,u as $,x as A,Q as f,V as R,o,R as V,w as h,m as N,t as m,i as n,b as a,c as b,a as C,n as y,k as d,j as _,v as g,h as T,_ as j,a5 as z,a0 as L}from"./main-0c5e983d.js";import{b as Q}from"./toggle-f29ee038.js";import{s as W}from"./multiselect-f0516a60.js";import{F as u}from"./formMode-f60a729f.js";const G=["onSubmit"],H={key:0,class:"mb-3 flex flex-wrap items-center"},J=a("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Branch",-1),K={key:0,class:"ml-24 w-full text-sm text-red-500"},X={class:"mb-3 flex flex-wrap items-center"},Y=a("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Seq. No.",-1),Z={key:0,class:"ml-24 w-full text-sm text-red-500"},ee={class:"mb-3 flex flex-wrap items-center"},ae=a("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Code",-1),re={key:0,class:"ml-24 w-full text-sm text-red-500"},se={class:"mb-3 flex flex-wrap items-center"},te=a("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Name",-1),oe={key:0,class:"ml-24 w-full text-sm text-red-500"},le={class:"flex flex-wrap items-center"},ne=a("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Description",-1),de=["disabled"],pe=E({__name:"DepartmentForm",emits:["close"],setup(ue,{emit:I}){const x=F(),q=M(),e=v({}),c=v(u.Create),p=v(!1),r=v({}),i=$().user.branches;A(()=>{i.length===1&&(e.value.branchId=i[0].id),x.path.endsWith("/edit")&&(c.value=u.Edit,S(x.params.id)),c.value===u.Create&&i.length===1&&w()});const w=async()=>{const{data:l}=await f.post("/api/departments/generate-sequence",{branchId:e.value.branchId});e.value.sequenceNumber=l},S=async l=>{const{data:s}=await f.get(`/api/departments/${l}`);e.value=s.data},D=async()=>{p.value=!0;try{c.value===u.Create?await O():await P(),L.fire()}catch(l){r.value=l.response.data.errors??{}}p.value=!1},O=async()=>{await f.post("/api/departments",e.value),U()},P=async()=>{await f.patch(`/api/departments/${e.value.id}`,e.value),k()},U=async()=>{e.value={branchId:e.value.branchId},r.value={},await w()},k=()=>{I("close"),q.back()};return(l,s)=>{const B=R("maska");return o(),V(z,null,{header:h(()=>[N(m(c.value===n(u).Create?"Create New Department":"Edit Department"),1)]),body:h(()=>[a("form",{id:"form",onSubmit:T(D,["prevent","stop"])},[n(i).length>1?(o(),b("div",H,[J,C(n(W),{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=t=>e.value.branchId=t),options:n(i),onSelect:w,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-clear":!1,"can-deselect":!1,class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(o(),b("p",K,m(r.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",X,[Y,_(a("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>e.value.sequenceNumber=t),"data-maska":"###",class:y(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("sequenceNumber")}])},null,2),[[g,e.value.sequenceNumber],[B]]),r.value.hasOwnProperty("sequenceNumber")?(o(),b("p",Z,m(r.value.sequenceNumber[0]),1)):d("",!0)]),a("div",ee,[ae,_(a("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>e.value.code=t),class:y(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[g,e.value.code]]),r.value.hasOwnProperty("code")?(o(),b("p",re,m(r.value.code[0]),1)):d("",!0)]),a("div",se,[te,_(a("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>e.value.name=t),class:y(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[g,e.value.name]]),r.value.hasOwnProperty("name")?(o(),b("p",oe,m(r.value.name[0]),1)):d("",!0)]),a("div",le,[ne,_(a("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>e.value.description=t),class:"flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500"},null,512),[[g,e.value.description]])])],40,G)]),footer:h(()=>[a("button",{class:"mr-2 btn-blue",disabled:p.value,form:"form"},[C(j,{"is-loading":p.value},{default:h(()=>[N("Save")]),_:1},8,["is-loading"])],8,de),a("button",{onClick:k,class:"btn-gray"},"Cancel"),c.value===n(u).Edit?(o(),V(n(Q),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[5]||(s[5]=t=>e.value.isActive=t),class:"toggle:off:red ml-auto"},null,8,["modelValue"])):d("",!0)]),_:1})}}});export{pe as default};
