import{d as Q,e as m,x as Y,y as K,o as l,c as i,a as w,b as e,h as x,v as L,a0 as T,t as s,g as t,V as q,F as R,a1 as M,w as B,p as a,Q as z,r as E,U as O,k as W,i as P,l as G,n as U,f as N,a2 as J,a3 as X,T as Z,$ as H,Y as ee}from"./main-DNdNUUJ7.js";import{M as te}from"./Master-b_S4sXaO.js";import{_ as se}from"./Paginator.vue_vue_type_script_setup_true_lang-ByzTMpQ9.js";import{u as ae}from"./urlQueryManager-rKHuCRUp.js";import{i as oe}from"./index.es-CdvJf4Rl.js";import{d as re}from"./datepickerPresets-BpsxgrFD.js";import{_ as ne}from"./BranchFilter.vue_vue_type_script_setup_true_lang-CgUfq7jM.js";import{P as I}from"./premaritalReferralStatus-CQMWPAtf.js";import{A as le}from"./ActivityLogSidebar-DQgEnTl4.js";import{u as ie,a as ce}from"./printService-Bcj_RmEK.js";import{P as F}from"./printTemplateType-BiK7zB0k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-K4eUN8Nz.js";const de={class:"flex flex-wrap items-center justify-end gap-2"},ue={class:"relative flex-1 min-w-[11rem]"},pe={class:"label"},me={class:"relative flex-1 min-w-[11rem]"},he={class:"label"},_e={class:"relative flex-1 min-w-[11rem]"},ve={class:"label"},ge={class:"relative flex-1"},be={value:""},fe=["value"],ye={class:"label"},we={class:"relative flex-1 min-w-[14rem]"},xe={class:"label"},Ce=Q({__name:"PremaritalReferralsFilter",emits:["change"],setup(j,{emit:S}){const C=S,u=new URLSearchParams(location.search),v=m(""),g=m(""),$=m(""),b=m("");m("");const f=m(""),d=m([null,null]);Y(()=>A());const y=K(()=>d.value[0]===null||d.value[1]===null?"":`${d.value[0]}~${d.value[1]}`),A=()=>{g.value=u.get("visitNumber")??"",v.value=u.get("branchId")??"",$.value=u.get("status")??"",b.value=u.get("name")??"",f.value=u.get("phoneNumber")??"",u.get("dateRange")&&(d.value=u.get("dateRange").split("~"))},_=()=>{let V=`branchId=${v.value}&visitNumber=${g.value}&name=${b.value}&phoneNumber=${f.value}&status=${$.value}&dateRange=${y.value}&page=1`;C("change",V)};return(V,c)=>(l(),i("div",de,[w(ne,{modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=n=>v.value=n),onChange:_},null,8,["modelValue"]),e("div",ue,[x(e("input",{"onUpdate:modelValue":c[1]||(c[1]=n=>g.value=n),onKeyup:T(_,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,g.value]]),e("label",pe,s(t(a)("Registration Number")),1)]),e("div",me,[x(e("input",{"onUpdate:modelValue":c[2]||(c[2]=n=>b.value=n),onKeyup:T(_,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,b.value]]),e("label",he,s(t(a)("Name")),1)]),e("div",_e,[x(e("input",{"onUpdate:modelValue":c[3]||(c[3]=n=>f.value=n),onKeyup:T(_,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,f.value]]),e("label",ve,s(t(a)("Phone Number")),1)]),e("div",ge,[x(e("select",{"onUpdate:modelValue":c[4]||(c[4]=n=>$.value=n),onChange:_,class:"input-sm peer"},[e("option",be,s(t(a)("All")),1),(l(!0),i(R,null,M(t(I),n=>(l(),i("option",{value:n},s(t(a)(n.startCase())),9,fe))),256))],544),[[q,$.value]]),e("label",ye,s(t(a)("Status")),1)]),e("div",we,[w(t(oe),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:t(re),value:d.value,"onUpdate:value":c[5]||(c[5]=n=>d.value=n),onChange:_,class:"w-full peer","input-class":"input-sm pt-0.5"},{"icon-calendar":B(()=>[]),_:1},8,["shortcuts","value"]),e("label",xe,s(t(a)("Date")),1)])]))}}),$e={class:"mb-5 flex items-start gap-1"},ke={class:"pe-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},Pe={class:"w-full"},Re={class:"sticky top-0 z-10 ltr:text-left rtl:text-right"},Ve={class:"bg-gray-600 p-2 font-semibold text-white rounded-ss"},Ne={class:"bg-gray-600 p-2 font-semibold text-white"},Me={class:"bg-gray-600 p-2 font-semibold text-white"},Se={class:"bg-gray-600 p-2 font-semibold text-white"},Ae={class:"bg-gray-600 p-2 font-semibold text-white"},De={class:"bg-gray-600 p-2 font-semibold text-white"},Le={class:"bg-gray-600 p-2 font-semibold text-white"},Te={class:"bg-gray-600 p-2 font-semibold text-white"},Ue={class:"bg-gray-600 p-2 font-semibold text-white"},Be={class:"bg-gray-600 p-2 font-semibold text-white"},Ie={key:0,class:"bg-gray-600 p-2 font-semibold text-white rounded-se"},ze=["onClick"],He={class:"border border-gray-200 p-1"},Fe={class:"border border-gray-200 p-1"},Qe={class:"border border-gray-200 p-1"},Ye={class:"border border-gray-200 p-1"},je={class:"flex flex-wrap gap-1"},Ke={class:"inline-block rounded bg-teal-500 px-1 text-xs font-bold text-white group-hover:bg-white group-hover:text-emerald-500"},qe={class:"border border-gray-200 p-1"},Ee={class:"flex items-center gap-3"},Oe=["href"],We={class:"border border-gray-200 p-1"},Ge={class:"border border-gray-200 p-1"},Je={class:"border border-gray-200 p-1"},Xe={class:"border border-gray-200 p-1"},Ze={key:0,class:"border border-gray-200 px-2 py-1 text-center"},et={class:"flex justify-center gap-3"},tt=["onClick"],st=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"},null,-1),at=[st],ot=["onClick"],rt=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),nt=[rt],lt=["onClick"],it=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),ct=[it],Ct=Q({__name:"PremaritalReferrals",setup(j){const{updateUrlQuery:S}=ae(),{hasPermissionTo:C,hasAnyPermission:u}=Z(),v=m([]),g=m({}),$=G(),{getDefaultTemplate:b}=ie(),f=ce(),d=m([]);Y(()=>y(location.search));const y=async r=>{const p=await S(r),{data:k}=await z.get(`/api/premarital/referrals?${p}`);v.value=k.data,g.value=k.meta},A=r=>r===I.Pending?"border-s-gray-300":"border-s-emerald-500",_=r=>r===I.Pending?"hover:bg-gray-300 hover:text-black":"hover:bg-emerald-500 hover:text-white",V=r=>{C("PremaritalReferral.update")&&$.push(`/premarital/referrals/${r}/edit`)},c=async(r,p)=>{if(d.value[r.id]===!0)return;d.value[r.id]=!0;const k=b(F.PremaritalReferral,r.branchId).printer;await f.premaritalReferral(r.id,{printMode:p,printer:k,fileName:`${r.personalInformation.name}-referral`}),H.fire(),d.value[r.id]=!1},n=async r=>{const{isConfirmed:p}=await ee.fire();p&&(await z.delete(`/api/premarital/referrals/${r}`),H.fire(),y(location.search))};return(r,p)=>{const k=E("router-view"),D=O("tip");return l(),i(R,null,[w(k,{onClose:y}),w(te,null,{header:B(()=>[W(s(t(a)("Premarital Referrals")),1)]),body:B(()=>[e("div",$e,[w(Ce,{onChange:y})]),e("section",ke,[e("table",Pe,[e("thead",null,[e("tr",Re,[e("th",Ve,s(t(a)("No.")),1),e("th",Ne,s(t(a)("Name")),1),e("th",Me,s(t(a)("Hospital")),1),e("th",Se,s(t(a)("Test")),1),e("th",Ae,s(t(a)("Procedures")),1),e("th",De,s(t(a)("Attachments")),1),e("th",Le,s(t(a)("Status")),1),e("th",Te,s(t(a)("Date")),1),e("th",Ue,s(t(a)("Receive Date")),1),e("th",Be,s(t(a)("Branch")),1),t(u)("ActivityLog.list","PremaritalReferral.delete","PremaritalReferral.print")?(l(),i("th",Ie)):P("",!0)])]),e("tbody",null,[(l(!0),i(R,null,M(v.value,o=>(l(),i("tr",{class:U(["cursor-pointer transition group even:bg-gray-100",_(o.status)]),onClick:h=>V(o.id)},[e("td",{class:U(["border border-gray-200 p-1 border-s-[5px]",A(o.status)])},s(o.premaritalVisit.number),3),e("td",He,s(o.personalInformation.name),1),e("td",Fe,s(o.hospital),1),e("td",Qe,s(o.order.test.name),1),e("td",Ye,[e("div",je,[(l(!0),i(R,null,M(o.procedures,h=>(l(),i("span",Ke,s(h),1))),256))])]),e("td",qe,[e("div",Ee,[(l(!0),i(R,null,M(o.attachments,h=>(l(),i("a",{onClick:p[0]||(p[0]=N(()=>{},["stop"])),href:h.path,target:"_blank",class:"text-blue-500 underline group-hover:text-white"},s(t(a)(h.type.startCase())),9,Oe))),256))])]),e("td",We,s(t(a)(o.status.startCase())),1),e("td",Ge,s(o.date),1),e("td",Je,s(o.receiveDate),1),e("td",Xe,s(o.branch.name),1),t(u)("ActivityLog.list","PremaritalReferral.delete","PremaritalReferral.print")?(l(),i("td",Ze,[e("div",et,[t(C)("PremaritalReferral.print")&&t(b)(t(F).PremaritalReferral,o.branchId)?x((l(),i("svg",{key:0,class:U(["h-6 w-6 cursor-pointer text-blue-500 group-hover:text-white",{"cursor-not-allowed opacity-50":d.value[o.id]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",onClick:N(h=>c(o,t(f).detectPrintMode(h)),["stop"])},at,10,tt)),[[D,t(a)("Print")]]):P("",!0),t(C)("PremaritalReferral.delete")?x((l(),i("button",{key:1,onClick:N(h=>n(o.id),["stop"]),class:"cursor-pointer text-red-500 group-hover:text-white"},nt,8,ot)),[[D,t(a)("Delete")]]):P("",!0),t(C)("ActivityLog.list")?x((l(),i("button",{key:2,onClick:N(h=>t(J).emit(t(X).Show,o.id),["stop"]),class:"cursor-pointer text-gray-600 group-hover:text-white"},ct,8,lt)),[[D,t(a)("View Activities")]]):P("",!0)])])):P("",!0)],10,ze))),256))])])])]),_:1}),w(se,{data:g.value,onChange:p[1]||(p[1]=o=>y(`page=${o}`)),class:"mt-3"},null,8,["data"]),w(le)],64)}}});export{Ct as default};
