import{d as C,g as _,x as D,y as L,o,c as r,a as m,w as h,i as n,f as N,Q as w,r as V,V as T,b as t,t as s,k as x,F as k,a2 as A,R,m as $,j as B,T as F,Z as P,a0 as Q}from"./main-bf2af1c2.js";import{M as j}from"./Master-fd48b992.js";import{_ as U}from"./Paginator.vue_vue_type_script_setup_true_lang-ae9d2a51.js";import{u as Y}from"./urlQueryManager-97734f58.js";import{i as q}from"./index.es-d69483ac.js";import{d as z}from"./datepickerPresets-09eddff9.js";import"./_plugin-vue_export-helper-c27b6911.js";const E={class:"ml-auto flex items-center gap-2"},H=C({__name:"RatesDetailsFilter",emits:["change"],setup(I,{emit:f}){const u=new URLSearchParams(location.search),a=_([null,null]);D(()=>{g()});const b=L(()=>a.value[0]===null||a.value[1]===null?"":`${a.value[0]}~${a.value[1]}`),g=()=>{u.get("dateRange")&&(a.value=u.get("dateRange").split("~"))},v=()=>{let i=`dateRange=${b.value}&page=1`;f("change",i)};return(i,p)=>(o(),r("div",E,[m(n(q),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:n(z),placeholder:"Select date range",value:a.value,"onUpdate:value":p[0]||(p[0]=l=>a.value=l),onChange:v,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":h(()=>[]),_:1},8,["shortcuts","value"])]))}}),O={class:"flex justify-between"},W=t("h1",null,"Rates Details",-1),Z={class:"mb-5 flex items-center gap-5"},G={class:"pr-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},J={class:"w-full"},K={class:"sticky top-0 z-10 text-left"},X=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Reg. No.",-1),tt=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Invoice No.",-1),et=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Item",-1),st=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Patient",-1),ot=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Total",-1),at=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Ratio",-1),rt=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Amount",-1),nt=t("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Date",-1),it={key:0,class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},lt={class:"transition even:bg-gray-100"},dt={class:"border border-gray-200 px-2 py-1"},ct={key:1},ut={class:"border border-gray-200 px-2 py-1"},pt={key:1},_t={class:"border border-gray-200 px-2 py-1"},ht={class:"border border-gray-200 px-2 py-1"},ft={class:"border border-gray-200 px-2 py-1"},yt={class:"border border-gray-200 px-2 py-1"},mt={class:"border border-gray-200 px-2 py-1"},bt={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},gt={key:0,class:"border border-gray-200 px-2 py-1 text-center"},vt={class:"flex justify-center gap-3"},xt=["onClick"],wt=t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),kt=[wt],Nt=C({__name:"RatesDetails",setup(I){const f=_([]),u=_({}),a=_(),b=_(!1),g=N(),{updateUrlQuery:v}=Y(),{hasPermissionTo:i,hasAnyPermission:p}=F();D(()=>l(location.search));const l=async y=>{const d=await v(y),{data:c}=await w.get(`/api/rates/${g.params.partnerId}/details?${d}`);f.value=c.data,u.value=c.meta,a.value=c.total,b.value=!1},M=async y=>{const{isConfirmed:d}=await P.fire();d&&(await w.delete(`/api/rates/${y}`),Q.fire(),await l(location.search))};return(y,d)=>{const c=V("router-link"),S=T("tip");return o(),r(k,null,[m(j,null,{header:h(()=>[t("div",O,[W,t("p",null,"Total: "+s(a.value?.toLocaleString()??0),1)])]),body:h(()=>[t("div",Z,[m(H,{onChange:l})]),t("section",G,[t("table",J,[t("thead",null,[t("tr",K,[X,tt,et,st,ot,at,rt,nt,n(p)("Rate.delete")?(o(),r("th",it)):x("",!0)])]),t("tbody",null,[(o(!0),r(k,null,A(f.value,e=>(o(),r("tr",lt,[t("td",dt,[n(i)("Visit.view")?(o(),R(c,{key:0,class:"text-blue-500 underline",to:`/visits?branchId=${e.branchId}&visitNumber=${e.visit.number}`},{default:h(()=>[$(s(e.visit.number),1)]),_:2},1032,["to"])):(o(),r("p",ct,s(e.visit.number),1))]),t("td",ut,[n(i)("Invoice.view")?(o(),R(c,{key:0,class:"text-blue-500 underline",to:`/invoices?branchId=${e.branchId}&number=${e.invoice.number}`},{default:h(()=>[$(s(e.invoice.number),1)]),_:2},1032,["to"])):(o(),r("p",pt,s(e.invoice.number),1))]),t("td",_t,s(e.item?.label),1),t("td",ht,s(e.visit.patient.name),1),t("td",ft,s(e.total?.toLocaleString()),1),t("td",yt,s(e.ratio?e.ratio+"%":""),1),t("td",mt,s(e.amount?.toLocaleString()),1),t("td",bt,s(e.date),1),n(p)("Rate.delete")?(o(),r("td",gt,[t("div",vt,[n(i)("Rate.delete")?B((o(),r("button",{key:0,onClick:Rt=>M(e.id),class:"cursor-pointer text-red-500"},kt,8,xt)),[[S,"Delete"]]):x("",!0)])])):x("",!0)]))),256))])])])]),_:1}),m(U,{data:u.value,onChange:d[0]||(d[0]=e=>l(`page=${e}`)),class:"mt-3"},null,8,["data"])],64)}}});export{Nt as default};
