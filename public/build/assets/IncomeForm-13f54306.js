import{d as S,e as o,x as $,A as i,o as v,C as I,w as c,k as b,t as _,g as N,b as s,a as g,n as B,c as M,i as R,h as T,v as E,f as F,_ as A,V as D,m as O,l as P,S as U}from"./main-c1f62c61.js";import{_ as z}from"./CurrencyInput.vue_vue_type_script_setup_true_lang-0c3f56bb.js";import{F as u}from"./formMode-f60a729f.js";const L=["onSubmit"],W={class:"flex flex-wrap items-center mb-3"},j=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Amount",-1),q={key:0,class:"w-full ml-24 text-red-500 text-sm"},G={class:"flex flex-wrap items-center mb-3"},H=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Notes",-1),J=["disabled"],Z=S({__name:"IncomeForm",emits:["close"],setup(K,{emit:y}){const m=O(),w=P(),e=o({}),r=o({}),n=o(u.Create),l=o(!1),d=o([]);$(async()=>{m.path.endsWith("/edit")&&(n.value=u.Edit,h(m.params.id)),n.value==="create"&&(await x(m.params.id),e.value.amount=r.value.total,e.value.registerId=r.value.id)});const h=async t=>{const{data:a}=await i.get(`/api/incomes/${t}`);e.value=a.data,r.value=a.data.register},x=async t=>{const{data:a}=await i.get(`/api/registers/${t}`);r.value=a.data},C=async()=>{l.value=!0;try{n.value===u.Create?await V():await k(),U.fire()}catch(t){d.value=t.response.data.errors??{}}l.value=!1},V=async()=>{await i.post("/api/incomes",e.value),p()},k=async()=>{await i.patch(`/api/incomes/${e.value.id}`,e.value),p()},p=()=>{y("close"),w.back()};return(t,a)=>(v(),I(D,null,{header:c(()=>[b(_(n.value===N(u).Create?"Transfer Register":"Edit Income"),1)]),body:c(()=>[s("form",{id:"form",onSubmit:F(C,["prevent","stop"])},[s("div",W,[j,g(z,{modelValue:e.value.amount,"onUpdate:modelValue":a[0]||(a[0]=f=>e.value.amount=f),class:B(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":d.value.hasOwnProperty("amount")}])},null,8,["modelValue","class"]),d.value.hasOwnProperty("amount")?(v(),M("p",q,_(d.value.amount[0]),1)):R("",!0)]),s("div",G,[H,T(s("input",{"onUpdate:modelValue":a[1]||(a[1]=f=>e.value.notes=f),class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512),[[E,e.value.notes]])])],40,L)]),footer:c(()=>[s("button",{class:"btn-blue mr-2",disabled:l.value,form:"form"},[g(A,{"is-loading":l.value},{default:c(()=>[b("Save")]),_:1},8,["is-loading"])],8,J),s("button",{onClick:p,class:"btn-gray"},"Cancel")]),_:1}))}});export{Z as default};
