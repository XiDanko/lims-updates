import{d as E,e as v,u as F,x as M,Q as f,V as $,o,R as V,w as h,k as N,t as m,g as n,b as a,c as b,a as C,n as y,i as d,h as _,v as g,f as A,_ as R,a9 as T,m as z,l as L,Z as Q}from"./main-6e47ceb6.js";import{b as W}from"./toggle-b1a111c5.js";import{s as Z}from"./multiselect-27b4da8b.js";import{F as u}from"./formMode-f60a729f.js";const j=["onSubmit"],G={key:0,class:"flex flex-wrap items-center mb-3"},H=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),J={key:0,class:"ml-24 w-full text-red-500 text-sm"},K={class:"flex flex-wrap items-center mb-3"},X=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Seq. No.",-1),Y={key:0,class:"w-full ml-24 text-red-500 text-sm"},ee={class:"flex flex-wrap items-center mb-3"},ae=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Code",-1),re={key:0,class:"w-full ml-24 text-red-500 text-sm"},se={class:"flex flex-wrap items-center mb-3"},te=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),oe={key:0,class:"w-full ml-24 text-red-500 text-sm"},le={class:"flex flex-wrap items-center"},ne=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Description",-1),de=["disabled"],pe=E({__name:"DepartmentForm",emits:["close"],setup(ue,{emit:I}){const x=z(),q=L(),e=v({}),c=v(u.Create),p=v(!1),r=v({}),i=F().user.branches;M(()=>{i.length===1&&(e.value.branchId=i[0].id),x.path.endsWith("/edit")&&(c.value=u.Edit,S(x.params.id)),c.value===u.Create&&i.length===1&&w()});const w=async()=>{const{data:l}=await f.post("/api/departments/generate-sequence",{branchId:e.value.branchId});e.value.sequenceNumber=l},S=async l=>{const{data:s}=await f.get(`/api/departments/${l}`);e.value=s.data},D=async()=>{p.value=!0;try{c.value===u.Create?await O():await P(),Q.fire()}catch(l){r.value=l.response.data.errors??{}}p.value=!1},O=async()=>{await f.post("/api/departments",e.value),U()},P=async()=>{await f.patch(`/api/departments/${e.value.id}`,e.value),k()},U=async()=>{e.value={branchId:e.value.branchId},r.value={},await w()},k=()=>{I("close"),q.back()};return(l,s)=>{const B=$("maska");return o(),V(T,null,{header:h(()=>[N(m(c.value===n(u).Create?"Create New Department":"Edit Department"),1)]),body:h(()=>[a("form",{id:"form",onSubmit:A(D,["prevent","stop"])},[n(i).length>1?(o(),b("div",G,[H,C(n(Z),{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=t=>e.value.branchId=t),options:n(i),onSelect:w,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-clear":!1,"can-deselect":!1,class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(o(),b("p",J,m(r.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",K,[X,_(a("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>e.value.sequenceNumber=t),"data-maska":"###",class:y(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("sequenceNumber")}])},null,2),[[g,e.value.sequenceNumber],[B]]),r.value.hasOwnProperty("sequenceNumber")?(o(),b("p",Y,m(r.value.sequenceNumber[0]),1)):d("",!0)]),a("div",ee,[ae,_(a("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>e.value.code=t),class:y(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[g,e.value.code]]),r.value.hasOwnProperty("code")?(o(),b("p",re,m(r.value.code[0]),1)):d("",!0)]),a("div",se,[te,_(a("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>e.value.name=t),class:y(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[g,e.value.name]]),r.value.hasOwnProperty("name")?(o(),b("p",oe,m(r.value.name[0]),1)):d("",!0)]),a("div",le,[ne,_(a("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>e.value.description=t),class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512),[[g,e.value.description]])])],40,j)]),footer:h(()=>[a("button",{class:"btn-blue mr-2",disabled:p.value,form:"form"},[C(R,{"is-loading":p.value},{default:h(()=>[N("Save")]),_:1},8,["is-loading"])],8,de),a("button",{onClick:k,class:"btn-gray"},"Cancel"),c.value===n(u).Edit?(o(),V(n(W),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[5]||(s[5]=t=>e.value.isActive=t),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):d("",!0)]),_:1})}}});export{pe as default};
