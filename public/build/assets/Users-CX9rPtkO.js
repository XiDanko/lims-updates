import{d as T,e as U,x as H,o as t,c as s,a as h,b as e,h as f,v as L,a0 as N,Q as A,r as z,U as D,w as C,k as S,g as i,R as V,i as c,F as _,a1 as m,t as u,a2 as F,a3 as I,T as Q,Y as M,$ as j}from"./main-DNdNUUJ7.js";import{M as E}from"./Master-b_S4sXaO.js";import{_ as P}from"./Paginator.vue_vue_type_script_setup_true_lang-ByzTMpQ9.js";import{u as R}from"./urlQueryManager-rKHuCRUp.js";import{_ as q}from"./BranchFilter.vue_vue_type_script_setup_true_lang-CgUfq7jM.js";import{A as K}from"./ActivityLogSidebar-DQgEnTl4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-K4eUN8Nz.js";const Y={class:"flex flex-wrap items-center gap-2 ms-auto"},G={class:"relative flex-1 min-w-[11rem]"},J=e("label",{class:"label"},"Name",-1),O=T({__name:"UsersFilter",emits:["change"],setup(B,{emit:g}){const w=g,x=new URLSearchParams(location.search),r=U(""),d=U("");H(()=>{p()});const p=()=>{r.value=x.get("name")??"",d.value=x.get("branchId")??""},y=()=>{const v=`name=${r.value}&branchId=${d.value}&page=1`;w("change",v)};return(v,n)=>(t(),s("div",Y,[h(q,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=a=>d.value=a),onChange:y},null,8,["modelValue"]),e("div",G,[f(e("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>r.value=a),onKeyup:N(y,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,r.value]]),J])]))}}),W={class:"mb-5 flex items-start gap-1"},X=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"h-4 w-4"},[e("path",{d:"M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"})],-1),Z=e("span",{class:"whitespace-nowrap font-semibold"},"Create New User",-1),ee={class:"pe-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},te={class:"w-full"},se={class:"sticky top-0 z-10 text-left"},oe=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Name",-1),re=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Username",-1),ae={key:0,class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},ne=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"View Departments",-1),ie=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Authorize Departments",-1),le=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Roles",-1),ce=e("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Branches",-1),de=e("th",{class:"bg-gray-600 p-2 text-center font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Active",-1),pe={key:1,class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},ue={class:"transition even:bg-gray-100"},_e={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},he={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},me={key:0,class:"break-all border border-gray-200 px-2 py-1"},fe={class:"border border-gray-200 px-2 py-1"},ge={class:"flex flex-wrap gap-1"},we={class:"inline-block rounded bg-teal-500 px-1 text-xs font-bold text-white"},xe={class:"border border-gray-200 px-2 py-1"},ye={class:"flex flex-wrap gap-1"},ve={class:"inline-block rounded bg-teal-500 px-1 text-xs font-bold text-white"},be={class:"border border-gray-200 px-2 py-1"},ke={class:"flex flex-wrap gap-1"},Ce={class:"inline-block rounded bg-teal-500 px-1 text-xs font-bold text-white"},Ue={class:"border border-gray-200 px-2 py-1"},Ae={class:"flex flex-wrap gap-1"},$e={class:"rounded bg-teal-500 px-1 text-xs font-bold text-white"},ze={class:"border border-gray-200 px-2 py-1 text-center"},Ve={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 text-emerald-500",viewBox:"0 0 16 16"},Me=e("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),Te=[Me],He={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 rotate-180 text-red-500",viewBox:"0 0 16 16"},Be=e("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),Le=[Be],Ne={key:1,class:"border border-gray-200 px-2 py-1 text-center"},De={class:"flex justify-center gap-3"},Se=["onClick"],Fe=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 w-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"})],-1),Ie=[Fe],Qe=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),je=["onClick"],Ee=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"w-[1.3rem] h-[1.3rem]"},[e("path",{d:"M224 16c-6.7 0-10.8-2.8-15.5-6.1C201.9 5.4 194 0 176 0c-30.5 0-52 43.7-66 89.4C62.7 98.1 32 112.2 32 128c0 14.3 25 27.1 64.6 35.9c-.4 4-.6 8-.6 12.1c0 17 3.3 33.2 9.3 48H45.4C38 224 32 230 32 237.4c0 1.7 .3 3.4 1 5l38.8 96.9C28.2 371.8 0 423.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7c0-58.5-28.2-110.4-71.7-143L415 242.4c.6-1.6 1-3.3 1-5c0-7.4-6-13.4-13.4-13.4H342.7c6-14.8 9.3-31 9.3-48c0-4.1-.2-8.1-.6-12.1C391 155.1 416 142.3 416 128c0-15.8-30.7-29.9-78-38.6C324 43.7 302.5 0 272 0c-18 0-25.9 5.4-32.5 9.9c-4.7 3.3-8.8 6.1-15.5 6.1zm56 208H267.6c-16.5 0-31.1-10.6-36.3-26.2c-2.3-7-12.2-7-14.5 0c-5.2 15.6-19.9 26.2-36.3 26.2H168c-22.1 0-40-17.9-40-40V169.6c28.2 4.1 61 6.4 96 6.4s67.8-2.3 96-6.4V184c0 22.1-17.9 40-40 40zm-88 96l16 32L176 480 128 288l64 32zm128-32L272 480 240 352l16-32 64-32z"})],-1),Pe=[Ee],Re=["onClick"],qe=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),Ke=[qe],tt=T({__name:"Users",setup(B){const g=U([]),w=U({}),{updateUrlQuery:x}=R(),{hasPermissionTo:r,hasAnyPermission:d}=Q();H(()=>p(location.search));const p=async n=>{const a=await x(n),{data:b}=await A.get(`/api/users?${a}`);g.value=b.data,w.value=b.meta},y=async n=>{const{isConfirmed:a}=await M.fire({html:"You will be logged out of your signed in account."});a&&(await A.post(`/api/users/${n}/impersonate`),window.open("/","_self"))},v=async n=>{const{isConfirmed:a}=await M.fire({html:"All previous tokens will be revoked."});a&&(await A.post(`/api/users/${n}/generate-token`),j.fire(),p(location.search))};return(n,a)=>{const b=z("router-view"),$=z("router-link"),k=D("tip");return t(),s(_,null,[h(b,{onClose:p}),h(E,null,{header:C(()=>[S("Users")]),body:C(()=>[e("div",W,[i(r)("User.create")?(t(),V($,{key:0,to:"/users/create",class:"inline-flex items-center gap-1 btn-blue"},{default:C(()=>[X,Z]),_:1})):c("",!0),h(O,{onChange:p})]),e("section",ee,[e("table",te,[e("thead",null,[e("tr",se,[oe,re,i(r)("User.generateTokens")?(t(),s("th",ae,"Access Token")):c("",!0),ne,ie,le,ce,de,i(d)("User.update","User.generateTokens","ActivityLog.list")?(t(),s("th",pe)):c("",!0)])]),e("tbody",null,[(t(!0),s(_,null,m(g.value,o=>(t(),s("tr",ue,[e("td",_e,u(o.name),1),e("td",he,u(o.username),1),i(r)("User.generateTokens")?(t(),s("td",me,u(o.accessToken),1)):c("",!0),e("td",fe,[e("div",ge,[(t(!0),s(_,null,m(o.viewableDepartments,l=>(t(),s("span",we,u(l.name),1))),256))])]),e("td",xe,[e("div",ye,[(t(!0),s(_,null,m(o.authorizableDepartments,l=>(t(),s("span",ve,u(l.name),1))),256))])]),e("td",be,[e("div",ke,[(t(!0),s(_,null,m(o.roles,l=>(t(),s("span",Ce,u(l.displayName),1))),256))])]),e("td",Ue,[e("div",Ae,[(t(!0),s(_,null,m(o.branches,l=>(t(),s("span",$e,u(l.name),1))),256))])]),e("td",ze,[o.isActive?(t(),s("svg",Ve,Te)):(t(),s("svg",He,Le))]),i(d)("User.update","User.generateTokens","ActivityLog.list")?(t(),s("td",Ne,[e("div",De,[i(r)("User.generateTokens")?f((t(),s("button",{key:0,onClick:l=>v(o.id),class:"cursor-pointer text-blue-500"},Ie,8,Se)),[[k,"Generate Token"]]):c("",!0),i(r)("User.update")?f((t(),V($,{key:1,to:`/users/${o.id}/edit`,class:"cursor-pointer text-orange-500"},{default:C(()=>[Qe]),_:2},1032,["to"])),[[k,"Edit"]]):c("",!0),i(r)("User.impersonate")?f((t(),s("button",{key:2,onClick:l=>y(o.id),class:"cursor-pointer text-gray-600"},Pe,8,je)),[[k,"Impersonate"]]):c("",!0),i(r)("ActivityLog.list")?f((t(),s("button",{key:3,onClick:l=>i(F).emit(i(I).Show,o.id),class:"cursor-pointer text-gray-600"},Ke,8,Re)),[[k,"View Activities"]]):c("",!0)])])):c("",!0)]))),256))])])])]),_:1}),h(P,{data:w.value,onChange:a[0]||(a[0]=o=>p(`page=${o}`)),class:"mt-3"},null,8,["data"]),h(K)],64)}}});export{tt as default};
