import{d as k,g as u,x as T,y as M,o as a,c,a as m,j as V,v as D,b as e,a1 as B,w as _,i as s,Q as N,r as C,V as P,m as x,k as w,F as $,a2 as Q,t as d,R,T as U}from"./main-cee2eb24.js";import{M as A}from"./Master-e24133cb.js";import{_ as F}from"./Paginator.vue_vue_type_script_setup_true_lang-fc9e564e.js";import{u as z}from"./urlQueryManager-ab4c0999.js";import{i as I}from"./index.es-89960bab.js";import{d as Y}from"./datepickerPresets-1f6bbcad.js";import{_ as K}from"./BranchFilter.vue_vue_type_script_setup_true_lang-d1bfbfa5.js";import{T as j}from"./transactionType-f4dd2750.js";import{T as q}from"./transactionStatus-76f595ca.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-97a39018.js";const E={class:"ml-auto flex items-center gap-2"},H=["onKeyup"],O=k({__name:"RatesFilter",emits:["change"],setup(L,{emit:g}){const i=new URLSearchParams(location.search),p=u(""),y=u(""),r=u([null,null]);T(()=>{b()});const f=M(()=>r.value[0]===null||r.value[1]===null?"":`${r.value[0]}~${r.value[1]}`),b=()=>{p.value=i.get("branchId")??"",y.value=i.get("name")??"",i.get("dateRange")&&(r.value=i.get("dateRange").split("~"))},l=()=>{let h=`branchId=${p.value}&name=${y.value}&dateRange=${f.value}&page=1`;g("change",h)};return(h,o)=>(a(),c("div",E,[m(K,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=n=>p.value=n),onChange:l},null,8,["modelValue"]),V(e("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>y.value=n),onKeyup:B(l,["enter"]),type:"text",placeholder:"Name",class:"w-56 rounded border border-gray-300 p-1.5 focus:border-blue-500"},null,40,H),[[D,y.value]]),m(s(I),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:s(Y),placeholder:"Select date range",value:r.value,"onUpdate:value":o[2]||(o[2]=n=>r.value=n),onChange:l,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":_(()=>[]),_:1},8,["shortcuts","value"])]))}}),W={class:"mb-5 flex items-center gap-5"},G={class:"pr-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},J={class:"w-full"},X={class:"sticky top-0 z-10 text-left"},Z=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Type",-1),ee=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Name",-1),te=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Total",-1),oe=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Paid",-1),ae=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Remaining",-1),se=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Branch",-1),re={key:0,class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},ne={class:"transition even:bg-gray-100"},le={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},de={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},ce={class:"border border-gray-200 px-2 py-1"},ie={key:1},ue={class:"border border-gray-200 px-2 py-1"},pe={key:1},ye={class:"border border-gray-200 px-2 py-1"},_e={class:"border border-gray-200 px-2 py-1"},me={key:0,class:"border border-gray-200 px-2 py-1 text-center"},fe={class:"flex justify-center gap-3"},he=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",fill:"currentColor",class:"mx-auto h-5 w-5 cursor-pointer text-blue-500"},[e("path",{d:"M568.2 336.3c-13.12-17.81-38.14-21.66-55.93-8.469l-119.7 88.17h-120.6c-8.748 0-15.1-7.25-15.1-15.99c0-8.75 7.25-16 15.1-16h78.25c15.1 0 30.75-10.88 33.37-26.62c3.25-20-12.12-37.38-31.62-37.38H191.1c-26.1 0-53.12 9.25-74.12 26.25l-46.5 37.74L15.1 383.1C7.251 383.1 0 391.3 0 400v95.98C0 504.8 7.251 512 15.1 512h346.1c22.03 0 43.92-7.188 61.7-20.27l135.1-99.52C577.5 379.1 581.3 354.1 568.2 336.3zM279.3 175C271.7 173.9 261.7 170.3 252.9 167.1L248 165.4C235.5 160.1 221.8 167.5 217.4 179.1s2.121 26.2 14.59 30.64l4.655 1.656c8.486 3.061 17.88 6.095 27.39 8.312V232c0 13.25 10.73 24 23.98 24s24-10.75 24-24V221.6c25.27-5.723 42.88-21.85 46.1-45.72c8.688-50.05-38.89-63.66-64.42-70.95L288.4 103.1C262.1 95.64 263.6 92.42 264.3 88.31c1.156-6.766 15.3-10.06 32.21-7.391c4.938 .7813 11.37 2.547 19.65 5.422c12.53 4.281 26.21-2.312 30.52-14.84s-2.309-26.19-14.84-30.53c-7.602-2.627-13.92-4.358-19.82-5.721V24c0-13.25-10.75-24-24-24s-23.98 10.75-23.98 24v10.52C238.8 40.23 221.1 56.25 216.1 80.13C208.4 129.6 256.7 143.8 274.9 149.2l6.498 1.875c31.66 9.062 31.15 11.89 30.34 16.64C310.6 174.5 296.5 177.8 279.3 175z"})],-1),Le=k({__name:"Rates",setup(L){const g=u([]),i=u({});u();const p=u(!1),{updateUrlQuery:y,urlQuery:r}=z(),{hasPermissionTo:f,hasAnyPermission:b}=U();T(()=>l(location.search));const l=async h=>{const o=await y(h),{data:n}=await N.get(`/api/rates?${o}`);g.value=n.data,i.value=n.meta,p.value=!1};return(h,o)=>{const n=C("router-view"),v=C("router-link"),S=P("tip");return a(),c($,null,[m(n,{onClose:l}),m(A,null,{header:_(()=>[x("Rates")]),body:_(()=>[e("div",W,[m(O,{onChange:l})]),e("section",G,[e("table",J,[e("thead",null,[e("tr",X,[Z,ee,te,oe,ae,se,s(b)("Rate.pay")?(a(),c("th",re)):w("",!0)])]),e("tbody",null,[(a(!0),c($,null,Q(g.value,t=>(a(),c("tr",ne,[e("td",le,d(t.type),1),e("td",de,d(t.name),1),e("td",ce,[s(f)("Rate.viewDetails")?(a(),R(v,{key:0,to:`/rates/${t.id}/details?dateRange=${s(r).get("dateRange")??""}`,class:"cursor-pointer text-blue-500 underline"},{default:_(()=>[x(d(t.total?.toLocaleString()??0),1)]),_:2},1032,["to"])):(a(),c("p",ie,d(t.total?.toLocaleString()??0),1))]),e("td",ue,[s(f)("Transaction.view")?(a(),R(v,{key:0,class:"cursor-pointer text-blue-500 underline",to:`/transactions?partnerId=${t.id}&type=${s(j).Expense}&status=${s(q).Received}&dateRange=${s(r).get("dateRange")??""}`},{default:_(()=>[x(d(t.paidAmount?.toLocaleString()??0),1)]),_:2},1032,["to"])):(a(),c("p",pe,d(t.total?.toLocaleString()??0),1))]),e("td",ye,d((t.total-t.paidAmount).toLocaleString()??0),1),e("td",_e,d(t.branch.name),1),s(b)("Rate.pay")?(a(),c("td",me,[e("div",fe,[s(f)("Rate.pay")?V((a(),R(v,{key:0,to:`/rates/${t.id}/pay`,class:"cursor-pointer text-blue-500"},{default:_(()=>[he]),_:2},1032,["to"])),[[S,"Pay"]]):w("",!0)])])):w("",!0)]))),256))])])])]),_:1}),m(F,{data:i.value,onChange:o[0]||(o[0]=t=>l(`page=${t}`)),class:"mt-3"},null,8,["data"])],64)}}});export{Le as default};
