import{d as N,g as h,x as D,y as E,Q as A,o as c,c as v,a as m,i as s,R as P,k as $,j as T,v as Q,b as e,a1 as Y,W as k,w as C,T as U,r as L,V as K,t as o,F as I,a2 as O,m as j,a3 as q,a4 as W}from"./main-bf2af1c2.js";import{M as H}from"./Master-fd48b992.js";import{_ as G}from"./Paginator.vue_vue_type_script_setup_true_lang-ae9d2a51.js";import{u as J}from"./urlQueryManager-97734f58.js";import{i as X}from"./index.es-d69483ac.js";import{d as Z}from"./datepickerPresets-09eddff9.js";import{_ as ee}from"./BranchFilter.vue_vue_type_script_setup_true_lang-7984eace.js";import{T as g}from"./transactionType-f4dd2750.js";import{T as V}from"./transactionStatus-76f595ca.js";import{s as te}from"./multiselect-4f06085e.js";import{A as oe}from"./ActivityLogSidebar-27791482.js";import"./_plugin-vue_export-helper-c27b6911.js";const se={class:"ml-auto flex flex-wrap items-center gap-2"},ae=["onKeyup"],re=e("option",{value:"",selected:""},"Select type",-1),le=["value"],ne=["value"],ie=["value"],de=["value"],ce=["value"],ue=["value"],pe=["value"],he=e("option",{value:"",selected:""},"Select status",-1),ve=["value"],_e=["value"],ye=N({__name:"TransactionsFilter",emits:["change"],setup(M,{emit:a}){const u=new URLSearchParams(location.search),{hasPermissionTo:w}=U(),x=h([]),i=h(""),_=h(""),r=h(""),l=h([null,null]),y=h(""),f=h("");D(()=>{S(),R()});const t=E(()=>l.value[0]===null||l.value[1]===null?"":`${l.value[0]}~${l.value[1]}`),S=()=>{i.value=u.get("branchId")??"",r.value=u.get("invoiceNumber")??"",u.get("dateRange")&&(l.value=u.get("dateRange").split("~")),y.value=u.get("status")??"",f.value=u.get("type")??""},R=async()=>{if(!w("Register.list"))return;const{data:p}=await A.get(`/api/registers/list?branchId=${i.value}`);x.value=p.data},B=p=>{_.value=p??"",b()},F=()=>{const p=r.value;z(),r.value=p,b()},b=()=>{let p=`branchId=${i.value}&registerId=${_.value}&invoiceNumber=${r.value}&type=${f.value}&status=${y.value}&dateRange=${t.value}&page=1`;a("change",p)},z=()=>{i.value="",_.value="",r.value="",l.value=[null,null],y.value="",f.value=""};return(p,n)=>(c(),v("div",se,[m(ee,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=d=>i.value=d),onChange:n[1]||(n[1]=d=>{b(),R()})},null,8,["modelValue"]),s(w)("Register.list")?(c(),P(s(te),{key:0,"model-value":_.value,options:x.value,"value-prop":"id","track-by":"userName",label:"userName",searchable:!0,placeholder:"Select register",onChange:B,class:"w-56 min-h-[38px] border border-gray-300 !rounded focus:border-blue-500"},null,8,["model-value","options"])):$("",!0),T(e("input",{"onUpdate:modelValue":n[2]||(n[2]=d=>r.value=d),onKeyup:Y(F,["enter"]),type:"text",placeholder:"Invoice number",class:"w-56 rounded border border-gray-300 p-1.5 focus:border-blue-500"},null,40,ae),[[Q,r.value]]),T(e("select",{"onUpdate:modelValue":n[3]||(n[3]=d=>f.value=d),onChange:b,class:"px-2 h-[38px] border border-gray-300 !rounded"},[re,e("option",{value:s(g).Payment},"Payment",8,le),e("option",{value:s(g).Discount},"Discount",8,ne),e("option",{value:s(g).Refund},"Refund",8,ie),e("option",{value:s(g).TransferIn},"Transfer-in",8,de),e("option",{value:s(g).TransferOut},"Transfer-out",8,ce),e("option",{value:s(g).TopUp},"Top-up",8,ue),e("option",{value:s(g).Expense},"Expense",8,pe)],544),[[k,f.value]]),T(e("select",{"onUpdate:modelValue":n[4]||(n[4]=d=>y.value=d),onChange:b,class:"px-2 h-[38px] border border-gray-300 !rounded"},[he,e("option",{value:s(V).Received},"Received",8,ve),e("option",{value:s(V).Canceled},"Canceled",8,_e)],544),[[k,y.value]]),m(s(X),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:s(Z),placeholder:"Select date range",value:l.value,"onUpdate:value":n[5]||(n[5]=d=>l.value=d),onChange:b,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":C(()=>[]),_:1},8,["shortcuts","value"])]))}}),fe={class:"flex items-center gap-5 overflow-x-auto overflow-y-hidden"},ge=e("h1",null,"Transactions",-1),me={class:"w-full text-center text-lg"},be=e("tr",null,[e("th",{class:""},"Payment"),e("th",{class:""},"Discount"),e("th",{class:""},"Refund"),e("th",{class:"whitespace-nowrap"},"Transfer-in"),e("th",{class:"whitespace-nowrap"},"Transfer-out"),e("th",{class:"whitespace-nowrap"},"Top-up"),e("th",{class:""},"Expense"),e("th",{class:""},"Profit"),e("th",{class:""},"Cash")],-1),we={class:"mb-5 flex items-center"},xe={class:"pr-1 h-[calc(100vh-17.4rem)] overflow-y-auto"},$e={class:"w-full"},Te={class:"sticky top-0 z-10 text-left"},Ce=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Creator",-1),Se=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Register",-1),Re=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Reference Register",-1),ke=e("th",{class:"whitespace-nowrap first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Invoice No.",-1),Le=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Type",-1),Ie=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Amount",-1),Ve=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Status",-1),Ne=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Notes",-1),De=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Date",-1),Ae=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Branch",-1),Pe={key:0,class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},Ue={class:"transition even:bg-gray-100"},Me={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},Be={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},Fe={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},ze={class:"border border-gray-200 px-2 py-1"},Ee={key:1},Qe={class:"border border-gray-200 px-2 py-1"},Ye={class:"border border-gray-200 px-2 py-1"},Ke={class:"border border-gray-200 px-2 py-1"},Oe={class:"border border-gray-200 px-2 py-1"},je={class:"whitespace-nowrap border border-gray-200 px-2 py-1"},qe={class:"border border-gray-200 px-2 py-1"},We={key:0,class:"border border-gray-200 px-2 py-1 text-center"},He={class:"flex items-center justify-center gap-3"},Ge=["onClick"],Je=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),Xe=[Je],ut=N({__name:"Transactions",setup(M){const a=h({}),{updateUrlQuery:u}=J(),{hasPermissionTo:w,hasAnyPermission:x}=U();D(()=>i(location.search));const i=async _=>{const r=await u(_),{data:l}=await A.get(`/api/transactions?${r}`);a.value=l};return(_,r)=>{const l=L("router-view"),y=L("router-link"),f=K("tip");return c(),v(I,null,[m(l,{onClose:i}),m(H,null,{header:C(()=>[e("div",fe,[ge,e("table",me,[be,e("tr",null,[e("td",null,o(a.value.totalPayment?.toLocaleString()??0),1),e("td",null,o(a.value.totalDiscount?.toLocaleString()??0),1),e("td",null,o(a.value.totalRefund?.toLocaleString()??0),1),e("td",null,o(a.value.totalTransferIn?.toLocaleString()??0),1),e("td",null,o(a.value.totalTransferOut?.toLocaleString()??0),1),e("td",null,o(a.value.totalTopUp?.toLocaleString()??0),1),e("td",null,o(a.value.totalExpense?.toLocaleString()??0),1),e("td",null,o(a.value.profit?.toLocaleString()??0),1),e("td",null,o(a.value.cash?.toLocaleString()??0),1)])])])]),body:C(()=>[e("div",we,[m(ye,{onChange:i})]),e("section",xe,[e("table",$e,[e("thead",null,[e("tr",Te,[Ce,Se,Re,ke,Le,Ie,Ve,Ne,De,Ae,s(x)("ActivityLog.list")?(c(),v("th",Pe)):$("",!0)])]),e("tbody",null,[(c(!0),v(I,null,O(a.value.data,t=>(c(),v("tr",Ue,[e("td",Me,o(t.creator?.name),1),e("td",Be,o(t.register.user.name),1),e("td",Fe,o(t.referenceRegister?.user?.name),1),e("td",ze,[t.invoice&&s(w)("Invoice.view")?(c(),P(y,{key:0,class:"text-blue-500 underline",to:`/invoices?branchId=${t.branchId}&number=${t.invoice.number}`},{default:C(()=>[j(o(t.invoice.number),1)]),_:2},1032,["to"])):t.invoice?(c(),v("p",Ee,o(t.invoice.number),1)):$("",!0)]),e("td",Qe,o(t.type.capitalize()),1),e("td",Ye,o(t.amount?.toLocaleString()),1),e("td",Ke,o(t.status.capitalize()),1),e("td",Oe,o(t.notes),1),e("td",je,o(t.date),1),e("td",qe,o(t.branch.name),1),s(x)("ActivityLog.list")?(c(),v("td",We,[e("div",He,[s(w)("ActivityLog.list")?T((c(),v("button",{key:0,onClick:S=>s(q).emit(s(W).Show,t.id),class:"cursor-pointer text-gray-600"},Xe,8,Ge)),[[f,"View Activities"]]):$("",!0)])])):$("",!0)]))),256))])])])]),_:1}),m(G,{data:a.value.meta,onChange:r[0]||(r[0]=t=>i(`page=${t}`)),class:"mt-3"},null,8,["data"]),m(oe)],64)}}});export{ut as default};
