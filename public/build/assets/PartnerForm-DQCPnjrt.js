import{d as Q,e as m,u as W,x as j,Q as h,U as q,o as r,R as N,w as V,k as D,t as c,g as o,b as a,c as u,a as p,i as n,h as v,V as G,n as i,v as b,f as J,_ as K,a4 as X,m as Y,l as Z,$ as ee}from"./main-BgbWFIXK.js";import{b as w}from"./toggle-CP_W0i88.js";import{s as L}from"./multiselect-DeMhawmc.js";import{F as _}from"./formMode-Bz--3d4P.js";import{P as x}from"./partnerType-BuqidEbA.js";import{_ as ae}from"./BranchSelect.vue_vue_type_script_setup_true_lang-ChkyAztq.js";const se={key:0,class:"relative col-span-2"},te={class:"relative"},le=["value"],oe=["value"],re=["value"],ne={key:0,class:"text-sm text-red-500"},ue={class:"relative"},de={key:0,class:"text-sm text-red-500"},ie={class:"relative"},ce=a("label",{class:"label"},"Phone Number",-1),pe={key:0,class:"text-sm text-red-500"},ve={class:"relative"},me=a("label",{class:"label"},"Email",-1),be={key:0,class:"text-sm text-red-500"},he={class:"relative"},_e=a("label",{class:"label"},"Address",-1),ye={class:"relative"},fe={class:"flex"},Ve=a("label",{class:"label"},"Ratio",-1),we=a("span",{class:"border-2 border-gray-300 bg-gray-100 px-5 py-2 rounded-e border-s-0"},"%",-1),ge={key:0,class:"text-sm text-red-500"},Ie={key:1,class:"relative"},xe=a("label",{class:"label"},"Include Discount",-1),Pe={key:2,class:"relative"},ke=a("label",{class:"label"},"Include Charges",-1),Ue={class:"relative"},Ce=a("label",{class:"label"},"Price List",-1),Oe={class:"relative"},Ne=a("label",{class:"label"},"User",-1),De={key:0,class:"text-sm text-red-500"},Le={class:"relative"},$e=a("label",{class:"label"},"Has Register",-1),Ee={class:"relative"},Re=a("label",{class:"label"},"Notes",-1),Se=["disabled"],Qe=Q({__name:"PartnerForm",emits:["close"],setup(Be,{emit:$}){const E=$,P=Y(),R=Z(),e=m({}),y=m(_.Create),f=m(!1),l=m({}),k=m([]),U=m([]),g=W().user.branches;j(()=>{g.length===1&&(e.value.branchId=g[0].id,I()),P.path.endsWith("/edit")&&(y.value=_.Edit,A(P.params.id))});const S=async()=>{const{data:d}=await h.get(`/api/price-lists/list?branchId=${e.value.branchId}`);k.value=d.data},B=async()=>{const{data:d}=await h.get(`/api/users/list?branchId=${e.value.branchId}&isPartner=true`);U.value=d.data},A=async d=>{const{data:s}=await h.get(`/api/partners/${d}`);e.value=s.data,I()},I=()=>{S(),B()},M=()=>{e.value.priceListId=null,e.value.userId=null},T=async()=>{f.value=!0;try{y.value===_.Create?await F():await z(),l.value={},ee.fire()}catch(d){l.value=d.response.data.errors??{}}f.value=!1},F=async()=>{await h.post("/api/partners",e.value),H()},z=async()=>{await h.patch(`/api/partners/${e.value.id}`,e.value),C()},H=()=>{e.value={branchId:e.value.branchId},l.value=[]},C=()=>{E("close"),R.back()};return(d,s)=>{const O=q("maska");return r(),N(X,{"modal-class":"!w-[60rem]"},{header:V(()=>[D(c(y.value===o(_).Create?"Create New Partner":"Edit Partner"),1)]),body:V(()=>[a("form",{id:"form",onSubmit:J(T,["prevent","stop"]),class:"grid grid-cols-2 gap-4"},[o(g).length>1?(r(),u("div",se,[p(ae,{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=t=>e.value.branchId=t),error:l.value.branchId,onSelect:I,onChange:M},null,8,["modelValue","error"])])):n("",!0),a("div",te,[v(a("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>e.value.type=t),class:i(["input h-[2.75rem] peer",{"border-red-500":l.value.hasOwnProperty("type")}])},[a("option",{value:o(x).Center},"Center",8,le),a("option",{value:o(x).Lab},"Lab",8,oe),a("option",{value:o(x).Doctor},"Doctor",8,re)],2),[[G,e.value.type]]),a("label",{class:i(["label",{"text-red-500":l.value.hasOwnProperty("type")}])},"Type",2),l.value.hasOwnProperty("type")?(r(),u("p",ne,c(l.value.type[0]),1)):n("",!0)]),a("div",ue,[v(a("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>e.value.name=t),class:i(["input peer",{"border-red-500":l.value.hasOwnProperty("name")}])},null,2),[[b,e.value.name]]),a("label",{class:i(["label",{"text-red-500":l.value.hasOwnProperty("name")}])},"Name",2),l.value.hasOwnProperty("name")?(r(),u("p",de,c(l.value.name[0]),1)):n("",!0)]),a("div",ie,[v(a("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>e.value.phoneNumber=t),"data-maska":"###########",class:i(["input peer",{"border-red-500":l.value.hasOwnProperty("phoneNumber")}])},null,2),[[b,e.value.phoneNumber],[O]]),ce,l.value.hasOwnProperty("phoneNumber")?(r(),u("p",pe,c(l.value.phoneNumber[0]),1)):n("",!0)]),a("div",ve,[v(a("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>e.value.email=t),class:i(["input peer",{"border-red-500":l.value.hasOwnProperty("email")}])},null,2),[[b,e.value.email]]),me,l.value.hasOwnProperty("email")?(r(),u("p",be,c(l.value.email[0]),1)):n("",!0)]),a("div",he,[v(a("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>e.value.address=t),class:"input peer"},null,512),[[b,e.value.address]]),_e]),a("div",ye,[a("div",fe,[v(a("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>e.value.ratio=t),"data-maska":"###",class:i(["input peer !rounded-e-none",{"border-red-500":l.value.hasOwnProperty("ratio")}])},null,2),[[b,e.value.ratio],[O]]),Ve,we]),l.value.hasOwnProperty("ratio")?(r(),u("p",ge,c(l.value.ratio[0]),1)):n("",!0)]),e.value.ratio?(r(),u("div",Ie,[p(o(w),{modelValue:e.value.isDiscountIncluded,"onUpdate:modelValue":s[7]||(s[7]=t=>e.value.isDiscountIncluded=t),class:"input peer pt-2.5"},null,8,["modelValue"]),xe])):n("",!0),e.value.ratio?(r(),u("div",Pe,[p(o(w),{modelValue:e.value.isExtraChargesIncluded,"onUpdate:modelValue":s[8]||(s[8]=t=>e.value.isExtraChargesIncluded=t),class:"input peer pt-2.5"},null,8,["modelValue"]),ke])):n("",!0),a("div",Ue,[p(o(L),{modelValue:e.value.priceListId,"onUpdate:modelValue":s[9]||(s[9]=t=>e.value.priceListId=t),options:k.value,searchable:!0,"value-prop":"id","track-by":"name",label:"name",class:"input peer"},null,8,["modelValue","options"]),Ce]),a("div",Oe,[p(o(L),{modelValue:e.value.userId,"onUpdate:modelValue":s[10]||(s[10]=t=>e.value.userId=t),options:U.value,searchable:!0,"value-prop":"id","track-by":"name",label:"name",class:i(["input peer",{"border-red-500":l.value.hasOwnProperty("userId")}])},null,8,["modelValue","options","class"]),Ne,l.value.hasOwnProperty("userId")?(r(),u("p",De,c(l.value.userId[0]),1)):n("",!0)]),a("div",Le,[p(o(w),{modelValue:e.value.hasRegister,"onUpdate:modelValue":s[11]||(s[11]=t=>e.value.hasRegister=t),class:"input peer pt-2.5"},null,8,["modelValue"]),$e]),a("div",Ee,[v(a("input",{"onUpdate:modelValue":s[12]||(s[12]=t=>e.value.notes=t),class:"input peer"},null,512),[[b,e.value.notes]]),Re])],32)]),footer:V(()=>[a("button",{class:"me-2 btn-blue",disabled:f.value,form:"form"},[p(K,{"is-loading":f.value},{default:V(()=>[D("Save")]),_:1},8,["is-loading"])],8,Se),a("button",{onClick:C,class:"btn-gray"},"Cancel"),y.value===o(_).Edit?(r(),N(o(w),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[13]||(s[13]=t=>e.value.isActive=t),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):n("",!0)]),_:1})}}});export{Qe as default};
