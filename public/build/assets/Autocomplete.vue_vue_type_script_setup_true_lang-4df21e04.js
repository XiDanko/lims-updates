import{d as k,e as u,x as B,s as I,y as $,o as r,c as i,b as E,a2 as K,z as c,n as d,a3 as S,g as q,F as z,D as A,i as H,f as M,t as L,A as _}from"./main-c1f62c61.js";const D=["value","onKeyup","onKeydown"],F=["onMouseover"],N={inheritAttrs:!1},j=k({...N,__name:"Autocomplete",props:{modelValue:null,endpoint:null,query:null,limit:null,label:null,maxHeight:null,parentClasses:null,listClasses:null},emits:["update:modelValue","select"],setup(a,{emit:h}){const n=a,l=u([]),e=u(-1),m=u(0),v=u(null);B(()=>{const t=document.querySelector(".autocomplete input");m.value=t.offsetHeight,document.addEventListener("mousedown",p)}),I(()=>document.removeEventListener("mousedown",p));const p=t=>v.value=t.target,w=$(()=>({"max-height":(n.maxHeight??200)+"px",top:m.value+"px"})),x=async()=>{if(e.value=-1,n.modelValue===""){s();return}const{data:t}=await _.get(`${n.endpoint}&${n.query}=${n.modelValue}`);l.value=n.limit?t.data.splice(0,n.limit):t.data},C=()=>{v.value!==document.querySelector("li.selected")&&s()},b=()=>{e.value<l.value.length-1&&e.value++},V=()=>{e.value>0&&e.value--},y=()=>{if(l.value.length!==0){if(e.value===-1){s();return}h("select",l.value[e.value]),s()}},s=()=>{l.value=[]};return(t,f)=>(r(),i("div",{class:d(["autocomplete relative",a.parentClasses])},[E("input",K({type:"text",value:a.modelValue},t.$attrs,{class:{"!rounded-b-none":l.value.length!==0},onInput:f[0]||(f[0]=o=>t.$emit("update:modelValue",o.target.value)),onKeyup:[c(x,["space"]),c(b,["down"]),c(V,["up"])],onKeydown:c(M(y,["prevent"]),["enter"]),onBlur:C}),null,16,D),l.value.length!==0?(r(),i("ul",{key:0,class:d(["absolute inset-x-0 bg-white shadow rounded-b overflow-y-auto z-50",a.listClasses]),style:S(q(w))},[(r(!0),i(z,null,A(l.value,(o,g)=>(r(),i("li",{key:o.id,onMouseover:P=>e.value=g,onClick:y,class:d(["py-1 px-2 cursor-pointer",{"selected bg-gray-100":g===e.value}])},L(o[a.label]),43,F))),128))],6)):H("",!0)],2))}});export{j as _};
