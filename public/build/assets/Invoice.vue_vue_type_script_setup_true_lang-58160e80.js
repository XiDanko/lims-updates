import{d as q,g as L,x as se,a3 as F,an as X,s as re,Q as D,o as l,c as d,b as e,n as U,F as B,a2 as Q,k as v,t as _,ao as Y,aa as oe,V as ae,R as pe,w as G,m as ne,i as o,h as fe,a5 as me,j as I,T as le,Z as j,a0 as J,y as H,A as te,U as be,a as P,v as W,$ as A,ap as he}from"./main-cee2eb24.js";import{s as ve}from"./multiselect-97a39018.js";import{_ as N}from"./CurrencyInput.vue_vue_type_script_setup_true_lang-8eeeffea.js";import{b as ye}from"./toggle-afba85dd.js";import{I as O}from"./itemType-8f96b3f7.js";import{O as V}from"./orderStatus-e3a3f9a7.js";import{F as z}from"./formMode-f60a729f.js";import{I as Z}from"./invoiceStatus-af715b0d.js";const ge=()=>{const S=(a,n)=>m(n)+y(a,n)-$(a,n),m=a=>a.filter(n=>n.status!=="canceled").reduce((n,i)=>n+i.price,0),$=(a,n)=>n.filter(i=>i.status!=="canceled").reduce((i,f)=>i+f.discount,0)+a.discount,y=(a,n)=>n.filter(i=>i.status!=="canceled").reduce((i,f)=>i+f.extraCharges,0)+a.extraCharges;return{total:S,subtotal:m,totalDiscount:$,totalExtraCharges:y,totalPayments:a=>a.reduce((n,i)=>n+i.amount,0)}},_e={key:0,class:"fixed inset-0 flex select-none items-center justify-center bg-black/80 z-[100]"},xe={class:"overflow-hidden rounded bg-white w-[90rem]"},we={class:"flex items-center overflow-x-auto rounded-t bg-gradient-to-br from-blue-400 to-indigo-500 text-white"},Ce=["onClick"],ke={class:"p-3 flex flex-wrap max-h-[calc(100vh-15rem)] overflow-y-auto"},$e=["onClick"],Se=q({__name:"QuickAddModal",props:{branchId:{}},emits:["select"],setup(S,{emit:m}){const $=S,y=L(!1),u=L([]),a=L([]),n=L(""),i=L([]),f=L([]);se(()=>{F.on(X.Show,async()=>{y.value=!0,await T(),await g(),C("all")})}),re(()=>F.off(X.Show));const g=async()=>{const h=a.value.map(c=>c.item.departmentId),{data:x}=await D.get(`/api/departments/list?branchId=${$.branchId}`);u.value=x.data.filter(c=>h.includes(c.id))},T=async()=>{const{data:h}=await D.get(`/api/quick-add-items/list?branchId=${$.branchId}`);a.value=h.data},C=(h,x=null)=>{h==="all"?(n.value="all",i.value=a.value):h==="tests"?(n.value=x.name,i.value=a.value.filter(c=>c.item.departmentId===x.id)):h==="packages"?(n.value="packages",i.value=a.value.filter(c=>c.itemType===O.Package)):h==="services"&&(n.value="services",i.value=a.value.filter(c=>c.itemType===O.Service))},b=h=>{if(h.isSelected=!h.isSelected,h.isSelected)f.value.push(h.itemId);else{const x=f.value.findIndex(c=>c.id===h.itemId);f.value.splice(x,1)}},R=()=>{m("select",f.value),M()},M=()=>{f.value=[],y.value=!1};return(h,x)=>y.value?(l(),d("div",_e,[e("div",xe,[e("header",we,[e("span",{class:U(["cursor-pointer border-b-4 border-transparent p-5 text-lg font-semibold transition hover:border-gray-600",{"!border-red-500":n.value==="all"}]),onClick:x[0]||(x[0]=c=>C("all"))},"All",2),(l(!0),d(B,null,Q(u.value,c=>(l(),d("span",{class:U(["cursor-pointer whitespace-nowrap border-b-4 border-transparent p-5 text-lg font-semibold transition hover:border-gray-600",{"!border-red-500":n.value===c.name}]),onClick:K=>C("tests",c)},_(c.name.capitalize()),11,Ce))),256)),e("span",{class:U(["cursor-pointer border-b-4 border-transparent p-5 text-lg font-semibold transition hover:border-gray-600",{"!border-red-500":n.value==="packages"}]),onClick:x[1]||(x[1]=c=>C("packages"))},"Packages",2),e("span",{class:U(["cursor-pointer border-b-4 border-transparent p-5 text-lg font-semibold transition hover:border-gray-600",{"!border-red-500":n.value==="services"}]),onClick:x[2]||(x[2]=c=>C("services"))},"Services",2)]),e("main",ke,[(l(!0),d(B,null,Q(i.value,c=>(l(),d("span",{onClick:K=>b(c),class:U(["my-1 ml-2 cursor-pointer rounded bg-blue-500 px-2 py-1 text-white transition hover:bg-blue-600",{"bg-teal-500 hover:bg-teal-600":c.isSelected}])},_(c.item.shortForm??c.item.name),11,$e))),256))]),e("footer",{class:"flex items-center rounded-b border-t border-gray-300 bg-gray-100 px-5 py-3"},[e("button",{class:"mr-2 btn-blue",onClick:R},"Save"),e("button",{class:"btn-gray",onClick:M},"Cancel")])])])):v("",!0)}});var E=(S=>(S.Ordered="ordered",S.Canceled="canceled",S))(E||{});const Ie=["onSubmit"],Ve={class:"w-full"},Le={class:"border border-transparent"},Pe={class:"sticky top-0 z-10 text-left"},Te=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Test Name",-1),Me=e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Status",-1),ze={key:0,class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},Oe={class:"border border-gray-200 px-2 py-1"},De={class:"border border-gray-200 px-2 py-1"},Ue={key:0,class:"border border-gray-200 px-2 py-1"},Ee=["onClick"],Be=e("path",{d:"M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM99.5 144.8C77.15 176.1 64 214.5 64 256C64 362 149.1 448 256 448C297.5 448 335.9 434.9 367.2 412.5L99.5 144.8zM448 256C448 149.1 362 64 256 64C214.5 64 176.1 77.15 144.8 99.5L412.5 367.2C434.9 335.9 448 297.5 448 256V256z"},null,-1),Fe=[Be],Ae=["onClick"],Ne=e("path",{d:"M468.9 32.11c13.87 0 27.18 10.77 27.18 27.04v145.9c0 10.59-8.584 19.17-19.17 19.17h-145.7c-16.28 0-27.06-13.32-27.06-27.2c0-6.634 2.461-13.4 7.96-18.9l45.12-45.14c-28.22-23.14-63.85-36.64-101.3-36.64c-88.09 0-159.8 71.69-159.8 159.8S167.8 415.9 255.9 415.9c73.14 0 89.44-38.31 115.1-38.31c18.48 0 31.97 15.04 31.97 31.96c0 35.04-81.59 70.41-147 70.41c-123.4 0-223.9-100.5-223.9-223.9S132.6 32.44 256 32.44c54.6 0 106.2 20.39 146.4 55.26l47.6-47.63C455.5 34.57 462.3 32.11 468.9 32.11z"},null,-1),je=[Ne],Qe=["onClick"],Re=e("path",{d:"M468.9 32.11c13.87 0 27.18 10.77 27.18 27.04v145.9c0 10.59-8.584 19.17-19.17 19.17h-145.7c-16.28 0-27.06-13.32-27.06-27.2c0-6.634 2.461-13.4 7.96-18.9l45.12-45.14c-28.22-23.14-63.85-36.64-101.3-36.64c-88.09 0-159.8 71.69-159.8 159.8S167.8 415.9 255.9 415.9c73.14 0 89.44-38.31 115.1-38.31c18.48 0 31.97 15.04 31.97 31.96c0 35.04-81.59 70.41-147 70.41c-123.4 0-223.9-100.5-223.9-223.9S132.6 32.44 256 32.44c54.6 0 106.2 20.39 146.4 55.26l47.6-47.63C455.5 34.57 462.3 32.11 468.9 32.11z"},null,-1),He=[Re],Ze=e("button",{class:"mr-2 btn-blue",form:"ModalForm"},"Save",-1),Ge=q({__name:"InvoicePackageModal",emits:["save","close"],setup(S,{emit:m}){const $=L(!1),y=L({}),{hasPermissionTo:u}=le();se(()=>{F.on(Y.Show,g=>{y.value=oe.cloneDeep(g),$.value=!0})}),re(()=>F.off(Y.Show));const a=async g=>{if(g.id){const{isConfirmed:T}=await j.fire();if(!T)return;await D.post("/api/orders/cancel",{orders:[g]}),J.fire()}g.status=V.Canceled},n=async g=>{if(g.id){const{isConfirmed:T}=await j.fire();if(!T)return;const{data:C}=await D.post(`/api/orders/${g.id}/reorder`);g.status=C.data.status,J.fire()}else g.status=V.Pending},i=async()=>{m("save",y.value),f()},f=()=>{$.value=!1,m("close")};return(g,T)=>{const C=ae("tip");return $.value?(l(),pe(me,{key:0},{header:G(()=>[ne(_(y.value.name)+" - Package Orders",1)]),body:G(()=>[e("form",{id:"ModalForm",onSubmit:fe(i,["prevent","stop"]),class:"max-h-96 overflow-y-auto pr-1"},[e("table",Ve,[e("thead",Le,[e("tr",Pe,[Te,Me,y.value.status===o(E).Ordered?(l(),d("th",ze)):v("",!0)])]),e("tbody",null,[(l(!0),d(B,null,Q(y.value.orders,(b,R)=>(l(),d("tr",{class:U(["transition even:bg-gray-100",{"!bg-red-500 !text-white":b.status===o(V).Canceled}])},[e("td",Oe,_(b.test.shortForm),1),e("td",De,_(b.status),1),y.value.status===o(E).Ordered?(l(),d("td",Ue,[![o(V).Released,o(V).Canceled].includes(b.status)&&o(u)("Order.cancel")?I((l(),d("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-5 w-5 cursor-pointer text-red-500",onClick:M=>a(b)},Fe,8,Ee)),[[C,"Cancel"]]):v("",!0),!b.id&&b.status===o(V).Canceled?I((l(),d("svg",{key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-5 w-5 -scale-x-100 cursor-pointer text-white",onClick:M=>n(b)},je,8,Ae)),[[C,"Reorder"]]):v("",!0),b.id&&b.status===o(V).Canceled&&o(u)("Order.reorder")?I((l(),d("svg",{key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-5 w-5 -scale-x-100 cursor-pointer text-white",onClick:M=>n(b)},He,8,Qe)),[[C,"Reorder"]]):v("",!0)])):v("",!0)],2))),256))])])],40,Ie)]),footer:G(()=>[Ze,e("button",{onClick:f,class:"btn-gray"},"Cancel")]),_:1})):v("",!0)}}}),Je={key:0,class:"mt-2 flex items-center"},Ke={class:"flex w-full items-center justify-between"},We={class:"rounded bg-teal-500 px-2 text-sm text-white"},Xe={key:1,class:"mt-3 mb-2 flex select-none flex-wrap items-center"},Ye=["onClick"],qe={key:2,class:"rounded border-l-4 border-red-500 bg-red-50 p-2 text-red-500"},et={key:3},tt={class:"pr-1 max-h-[calc(100vh-34rem)] overflow-y-auto"},st={class:"w-full"},rt=e("thead",{class:"border border-transparent"},[e("tr",{class:"sticky top-0 z-10 text-left"},[e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Item"),e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Price"),e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Discount"),e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Extra Charges"),e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"},"Notes"),e("th",{class:"first-of-type:rounded-tl last-of-type:rounded-tr bg-gray-600 p-2 font-semibold text-white"})])],-1),ot={class:"truncate border border-gray-200 px-2 py-1 max-w-[20rem]"},at=["onClick"],nt={key:1},lt={class:"border border-gray-200 px-2 py-1"},dt={class:"w-32 border border-gray-200 px-2 py-1"},it={class:"w-32 border border-gray-200 px-2 py-1"},ct={class:"border border-gray-200 px-2 py-1"},ut=["onUpdate:modelValue"],pt={class:"border border-gray-200 px-2 py-1"},ft=["onClick"],mt=e("path",{d:"M576 384C576 419.3 547.3 448 512 448H205.3C188.3 448 172 441.3 160 429.3L9.372 278.6C3.371 272.6 0 264.5 0 256C0 247.5 3.372 239.4 9.372 233.4L160 82.75C172 70.74 188.3 64 205.3 64H512C547.3 64 576 92.65 576 128V384zM271 208.1L318.1 256L271 303C261.7 312.4 261.7 327.6 271 336.1C280.4 346.3 295.6 346.3 304.1 336.1L352 289.9L399 336.1C408.4 346.3 423.6 346.3 432.1 336.1C442.3 327.6 442.3 312.4 432.1 303L385.9 256L432.1 208.1C442.3 199.6 442.3 184.4 432.1 175C423.6 165.7 408.4 165.7 399 175L352 222.1L304.1 175C295.6 165.7 280.4 165.7 271 175C261.7 184.4 261.7 199.6 271 208.1V208.1z"},null,-1),bt=[mt],ht=["onClick"],vt=e("path",{d:"M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM99.5 144.8C77.15 176.1 64 214.5 64 256C64 362 149.1 448 256 448C297.5 448 335.9 434.9 367.2 412.5L99.5 144.8zM448 256C448 149.1 362 64 256 64C214.5 64 176.1 77.15 144.8 99.5L412.5 367.2C434.9 335.9 448 297.5 448 256V256z"},null,-1),yt=[vt],gt=["onClick"],_t=e("path",{d:"M468.9 32.11c13.87 0 27.18 10.77 27.18 27.04v145.9c0 10.59-8.584 19.17-19.17 19.17h-145.7c-16.28 0-27.06-13.32-27.06-27.2c0-6.634 2.461-13.4 7.96-18.9l45.12-45.14c-28.22-23.14-63.85-36.64-101.3-36.64c-88.09 0-159.8 71.69-159.8 159.8S167.8 415.9 255.9 415.9c73.14 0 89.44-38.31 115.1-38.31c18.48 0 31.97 15.04 31.97 31.96c0 35.04-81.59 70.41-147 70.41c-123.4 0-223.9-100.5-223.9-223.9S132.6 32.44 256 32.44c54.6 0 106.2 20.39 146.4 55.26l47.6-47.63C455.5 34.57 462.3 32.11 468.9 32.11z"},null,-1),xt=[_t],wt={class:"mt-5 grid grid-cols-3 gap-2"},Ct={class:"flex flex-wrap items-start"},kt=e("span",{class:"w-20 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Discount",-1),$t={class:"flex flex-wrap items-start"},St=e("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Extra Charges",-1),It={class:"flex flex-wrap items-start"},Vt=e("span",{class:"rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Notes",-1),Lt={key:0,class:"flex flex-wrap items-start"},Pt=e("span",{class:"w-20 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Closed",-1),Tt={key:1,class:"flex flex-wrap items-start"},Mt=e("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Paid Amount",-1),zt={key:2,class:"flex flex-wrap items-start"},Ot=e("span",{class:"rounded-l border border-r-0 border-gray-300 bg-gray-100 p-1"},"Notes",-1),Dt=e("hr",{class:"mt-5 mb-3 border border-dashed border-gray-200"},null,-1),Ut={class:"flex justify-between"},Ht=q({__name:"Invoice",props:{branchId:{},priceList:{},invoice:{},invoiceItems:{},payment:{},errors:{},mode:{}},setup(S){const m=S,$=L([]),y=L(null),u=H(()=>m.invoice),a=H(()=>m.invoiceItems),n=H(()=>m.payment),i=ge(),{hasPermissionTo:f}=le(),g=H(()=>$.value.filter(t=>!C(t))),T=async()=>{const{data:t}=await D.get(`/api/items/list?branchId=${m.branchId}&orderBy=clickCount`);$.value=t.data},C=t=>!!a.value.find(r=>r.itemId===t.id&&r.itemType===t.type&&r.status===E.Ordered),b=async t=>{if(t.tests?.length===0){A.fire({icon:"error",title:"Package doesnt contain any test."});return}t.notes&&he.fire({html:`<pre class="font-sans">${t.notes}</pre>`});const r=oe.cloneDeep(t);if(y.value.clear(),!await h(r))return;const s=m.priceList.priceListItems.find(k=>k.itemId===r.id&&k.itemType===r.type);s?a.value.push({itemId:r.id,itemType:r.type,name:r.shortForm??r.name,price:s.price,discount:s.discount,extraCharges:0,notes:"",status:"ordered",orders:M(r)}):A.fire({icon:"error",title:"Price has not been defined for selected item."}),ie(r)},R=t=>{const r=a.value.findIndex(p=>p.itemType===O.Package&&p.itemId===t.itemId);a.value.splice(r,1,t)},M=t=>{if(t.type===O.Service)return[];if(t.type===O.Test)return[{testId:t.id,status:V.Pending,test:t}];if(t.type===O.Package){const r=[];return t.tests.forEach(p=>r.push({testId:p.id,status:V.Pending,test:p})),r}},h=async t=>{if(C(t)){A.fire({icon:"error",title:`${t.name} already added.`});return}const r=M(t),s=a.value.flatMap(k=>k.orders).filter(k=>r.some(w=>k.testId===w.testId&&k.status!==V.Canceled));if(s.length===0)return!0;if(t.type===O.Test)return A.fire({icon:"error",title:"Test already exists within a package."}),!1;{const{isConfirmed:k}=await j.fire({title:"Duplicate tests detected!",html:`
          <p>${s.flatMap(w=>w.test.shortForm).join(", ")}</p>
          <strong>If you proceed those tests will be execluded from package.</strong>
        `});return k?(t.tests=t.tests.filter(w=>s.every(ue=>w.id!==ue.testId)),!0):!1}},x=t=>a.value.splice(t,1),c=async(t,r)=>{const{isConfirmed:p}=await j.fire();if(!p)return;const{data:s}=await D.post(`/api/invoice-items/${t.id}/cancel`);a.value.splice(r,1,s.data),J.fire()},K=async(t,r)=>{const{isConfirmed:p}=await j.fire();if(!p)return;const{data:s}=await D.post(`/api/invoice-items/${t.id}/reorder`);a.value.splice(r,1,s.data),J.fire()},de=t=>t.forEach(r=>{const p=$.value.find(s=>s.id===r);p&&b(p)}),ie=async t=>{await D.post("/api/items/click",{id:t.id,type:t.type})},ce=()=>{a.value.forEach(t=>{const r=m.priceList.priceListItems.find(p=>p.itemId===t.itemId&&p.itemType===t.itemType);r?(t.price=r.price,t.discount=t.discount>0?t.discount:r.discount):(A.fire({icon:"error",title:"Price has not been defined for some selected items."}),t.price=null,t.discount=0)})},ee=()=>{m.mode!==z.Edit&&(u.value.status===Z.Closed?n.value.amount=i.total(u.value,a.value):n.value.amount=0)};return te(()=>m.priceList.id,(t,r)=>{r===void 0||t===r||ce()}),te(()=>[a.value,u.value],()=>{setTimeout(ee,10)},{deep:!0}),be(()=>T()),(t,r)=>{const p=ae("tip");return l(),d(B,null,[e("div",null,[t.mode===o(z).Create||t.mode===o(z).Edit&&o(f)("Invoice.addItems")?(l(),d("div",Je,[P(o(ve),{options:g.value,searchable:!0,placeholder:"Select item to add","value-prop":"name","track-by":"searchableForm",label:"label",object:!0,class:"flex-1 !rounded-l border border-gray-300 min-h-[34px]",ref_key:"multiselectInstance",ref:y,onSelect:b},{option:G(({option:s})=>[e("div",Ke,[e("span",null,_(s.label),1),e("span",We,_(s.type),1)])]),_:1},8,["options"]),e("span",{class:"cursor-pointer rounded-r border border-l-0 border-gray-300 p-1 px-4 transition hover:border-transparent hover:bg-blue-500 hover:text-white",onClick:r[0]||(r[0]=s=>o(F).emit(o(X).Show))},"Quick Add")])):v("",!0),t.mode===o(z).Create||t.mode===o(z).Edit&&o(f)("Invoice.addItems")?(l(),d("div",Xe,[(l(!0),d(B,null,Q(g.value.slice(0,20),s=>(l(),d("span",{onClick:k=>b(s),class:"mr-1 mb-1 cursor-pointer rounded bg-blue-500 p-1 text-xs text-white transition hover:bg-blue-600"},_(s.label),9,Ye))),256))])):v("",!0),t.errors.hasOwnProperty("invoiceItems")&&a.value.length===0?(l(),d("p",qe,"Select at least one item to continue.")):v("",!0),a.value.length>0?(l(),d("div",et,[e("div",tt,[e("table",st,[rt,e("tbody",null,[(l(!0),d(B,null,Q(a.value,(s,k)=>(l(),d("tr",{class:U(["even:bg-gray-100",{"!bg-red-500 !text-white":s.status===o(E).Canceled}])},[e("td",ot,[s.itemType===o(O).Package&&s.orders.length>0?I((l(),d("span",{key:0,class:"cursor-pointer underline",onClick:w=>o(F).emit(o(Y).Show,s)},[ne(_(s.name),1)],8,at)),[[p,"Open Package"]]):(l(),d("span",nt,_(s.name),1))]),e("td",lt,_(s.price!==null?s.price?.toLocaleString():"Undefined"),1),e("td",dt,[P(N,{disabled:!o(f)("Invoice.discount")||s.hasOwnProperty("id"),modelValue:s.discount,"onUpdate:modelValue":w=>s.discount=w,min:0,max:s.price,class:"w-full bg-transparent"},null,8,["disabled","modelValue","onUpdate:modelValue","max"])]),e("td",it,[P(N,{modelValue:s.extraCharges,"onUpdate:modelValue":w=>s.extraCharges=w,min:0,class:"w-full bg-transparent"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ct,[I(e("input",{type:"text","onUpdate:modelValue":w=>s.notes=w,class:"w-full bg-transparent"},null,8,ut),[[W,s.notes]])]),e("td",pt,[s.id?v("",!0):I((l(),d("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",fill:"currentColor",class:"h-5 w-5 cursor-pointer text-red-500",onClick:w=>x(k)},bt,8,ft)),[[p,"Remove"]]),s.id&&s.status===o(E).Ordered&&o(f)("Invoice.cancelItems")?I((l(),d("svg",{key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5 cursor-pointer text-red-500",onClick:w=>c(s,k)},yt,8,ht)),[[p,"Cancel"]]):v("",!0),s.status===o(E).Canceled&&o(f)("Invoice.reorderItems")?I((l(),d("svg",{key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5 -scale-x-100 cursor-pointer text-white",onClick:w=>K(s,k)},xt,8,gt)),[[p,"Reorder"]]):v("",!0)])],2))),256))])])]),e("div",wt,[e("div",Ct,[kt,P(N,{modelValue:u.value.discount,"onUpdate:modelValue":r[1]||(r[1]=s=>u.value.discount=s),size:"1",disabled:!o(f)("Invoice.discount")||t.mode===o(z).Edit,min:0,max:o(i).subtotal(a.value),class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,8,["modelValue","disabled","max"])]),e("div",$t,[St,P(N,{modelValue:u.value.extraCharges,"onUpdate:modelValue":r[2]||(r[2]=s=>u.value.extraCharges=s),size:"1",min:0,class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,8,["modelValue"])]),e("div",It,[Vt,I(e("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=s=>u.value.notes=s),size:"1",class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,512),[[W,u.value.notes]])]),t.mode===o(z).Create?(l(),d("div",Lt,[Pt,P(o(ye),{modelValue:u.value.status,"onUpdate:modelValue":r[4]||(r[4]=s=>u.value.status=s),"false-value":o(Z).Open,"true-value":o(Z).Closed,onChange:ee,class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,8,["modelValue","false-value","true-value"])])):v("",!0),t.mode===o(z).Create?(l(),d("div",Tt,[Mt,P(N,{modelValue:n.value.amount,"onUpdate:modelValue":r[5]||(r[5]=s=>n.value.amount=s),size:"1",min:0,max:o(i).total(u.value,a.value),disabled:u.value.status===o(Z).Closed,class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,8,["modelValue","max","disabled"])])):v("",!0),t.mode==="create"?(l(),d("div",zt,[Ot,I(e("input",{type:"text","onUpdate:modelValue":r[6]||(r[6]=s=>n.value.notes=s),size:"1",class:"flex-1 rounded-r border border-gray-300 p-1 focus:border-blue-500"},null,512),[[W,n.value.notes]])])):v("",!0)]),Dt,e("div",Ut,[e("span",null,"Total: "+_(o(i).total(u.value,a.value)?.toLocaleString()),1),e("span",null,"Subtotal: "+_(o(i).subtotal(a.value)?.toLocaleString()),1),e("span",null,"Total Discount: "+_(o(i).totalDiscount(u.value,a.value)?.toLocaleString()),1),e("span",null,"Paid Amount: "+_(n.value.amount?.toLocaleString()),1),e("span",null,"Due Balance: "+_((o(i).total(u.value,a.value)-n.value.amount).toLocaleString()),1)])])):v("",!0)]),P(Se,{branchId:m.branchId,onSelect:de},null,8,["branchId"]),P(Ge,{onSave:R})],64)}}});export{Ht as _,ge as u};
