import{d as D,u as I,e as l,x as F,Q as v,o as n,R as k,w as m,k as C,t as y,g as u,b as t,c as _,a as w,i as p,h as U,v as $,n as b,f as R,_ as T,a4 as j,m as z,l as L,$ as Q}from"./main-DmoZ1fz4.js";import{b as W}from"./toggle-DyRQkDOQ.js";import{s as q}from"./multiselect-DAhRltj6.js";import{F as i}from"./formMode-Bz--3d4P.js";import{_ as G}from"./BranchSelect.vue_vue_type_script_setup_true_lang-D_pdW9WT.js";const H={key:0,class:"relative"},J={class:"relative"},K={key:0,class:"text-sm text-red-500"},X={class:"relative"},Y={key:0,class:"text-sm text-red-500"},Z={class:"relative"},ee=t("label",{class:"label"},"Description",-1),ae=["disabled"],ue=D({__name:"InventoryForm",emits:["close"],setup(se,{emit:N}){const O=N,g=z(),P=L(),f=I().user.branches,x=l([]),e=l({}),d=l(i.Create),c=l(!1),s=l({});F(()=>{f.length===1&&(e.value.branchId=f[0].id,h()),g.path.endsWith("/edit")&&(d.value=i.Edit,S(g.params.id))});const h=async()=>{const{data:r}=await v.get(`/api/users/list?branchId=${e.value.branchId}`);x.value=r.data},S=async r=>{const{data:a}=await v.get(`/api/inventories/${r}`);e.value=a.data,h()},A=async()=>{c.value=!0;try{d.value===i.Create?await B():await E(),s.value={},Q.fire()}catch(r){s.value=r.response.data.errors??{}}c.value=!1},B=async()=>{await v.post("/api/inventories",e.value),M()},E=async()=>{await v.patch(`/api/inventories/${e.value.id}`,e.value),V()},M=()=>{e.value={branchId:e.value.branchId},s.value=[]},V=()=>{I().fetchAuthUser(),O("close"),P.back()};return(r,a)=>(n(),k(j,null,{header:m(()=>[C(y(d.value===u(i).Create?"Create New Inventory":"Edit Inventory"),1)]),body:m(()=>[t("form",{id:"form",onSubmit:R(A,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[u(f).length>1?(n(),_("div",H,[w(G,{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.branchId=o),onSelect:h,onChange:a[1]||(a[1]=o=>e.value.users=[]),error:s.value.branchId},null,8,["modelValue","error"])])):p("",!0),t("div",J,[U(t("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.name=o),class:b(["input peer",{"border-red-500":s.value.hasOwnProperty("name")}])},null,2),[[$,e.value.name]]),t("label",{class:b(["label",{"text-red-500":s.value.hasOwnProperty("name")}])},"Name",2),s.value.hasOwnProperty("name")?(n(),_("p",K,y(s.value.name[0]),1)):p("",!0)]),t("div",X,[w(u(q),{modelValue:e.value.users,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.users=o),mode:"tags",options:x.value,searchable:!0,object:!0,"value-prop":"id","track-by":"name",label:"name",class:b(["px-0 input peer",{"border-red-500":s.value.hasOwnProperty("users")}])},null,8,["modelValue","options","class"]),t("label",{class:b(["label",{"text-red-500":s.value.hasOwnProperty("users")}])},"Users",2),s.value.hasOwnProperty("users")?(n(),_("p",Y,y(s.value.users[0]),1)):p("",!0)]),t("div",Z,[U(t("textarea",{"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.description=o),rows:"4",class:"py-2 input peer"},null,512),[[$,e.value.description]]),ee])],32)]),footer:m(()=>[t("button",{class:"me-2 btn-blue",disabled:c.value,form:"form"},[w(T,{"is-loading":c.value},{default:m(()=>[C("Save")]),_:1},8,["is-loading"])],8,ae),t("button",{onClick:V,class:"btn-gray"},"Cancel"),d.value===u(i).Edit?(n(),k(u(W),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):p("",!0)]),_:1}))}});export{ue as default};
