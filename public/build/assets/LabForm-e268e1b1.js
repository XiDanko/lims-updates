import{d as A,e as v,u as F,x as M,Q as g,U as R,o as t,R as P,w as _,k as C,t as u,g as l,b as a,c as i,a as x,n as c,i as d,h as b,v as p,f as D,_ as T,a9 as Q,m as W,l as Z,Z as j}from"./main-56f58ed8.js";import{b as q}from"./toggle-876d3de4.js";import{s as L}from"./multiselect-167e14f5.js";import{F as f}from"./formMode-f60a729f.js";const G=["onSubmit"],H={class:"grid grid-cols-2 gap-3"},J={key:0,class:"flex flex-wrap items-center"},K=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),X={key:0,class:"ml-32 w-full text-red-500 text-sm"},Y={class:"flex flex-wrap items-start"},ee=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),ae={key:0,class:"w-full ml-32 text-red-500 text-sm"},re={class:"flex flex-wrap items-start"},se=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Phone Number",-1),oe={key:0,class:"w-full ml-32 text-red-500 text-sm"},te={class:"flex flex-wrap items-start"},le=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Email",-1),de={key:0,class:"w-full ml-32 text-red-500 text-sm"},ne=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Address",-1),ue={class:"flex flex-wrap items-start"},ie=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Ratio",-1),ce=a("span",{class:"w-16 p-2 border border-gray-300 border-l-0 rounded-r bg-gray-100 text-center"},"%",-1),be={key:0,class:"w-full ml-32 text-red-500 text-sm"},pe={class:"flex flex-wrap items-start"},me=a("span",{class:"w-32 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Price List",-1),ve={class:"col-span-2 flex flex-wrap items-start"},fe=a("span",{class:"w-full p-1 font-semibold"},"Notes",-1),he=["disabled"],ke=A({__name:"LabForm",emits:["close"],setup(ye,{emit:O}){const k=W(),U=Z(),e=v({}),h=v(f.Create),y=v(!1),o=v({}),V=v([]),m=F().user.branches;M(()=>{m.length===1&&(e.value.branchId=m[0].id,w()),k.path.endsWith("/edit")&&(h.value=f.Edit,S(k.params.id))});const w=async()=>{const{data:n}=await g.get(`/api/price-lists/list?branchId=${e.value.branchId}`);V.value=n.data},S=async n=>{const{data:r}=await g.get(`/api/labs/${n}`);e.value=r.data,w()},z=async()=>{y.value=!0;try{h.value===f.Create?await $():await B(),j.fire()}catch(n){o.value=n.response.data.errors??{}}y.value=!1},$=async()=>{await g.post("/api/labs",e.value),E()},B=async()=>{await g.patch(`/api/labs/${e.value.id}`,e.value),I()},E=()=>{e.value={branchId:e.value.branchId},o.value=[]},I=()=>{O("close"),U.back()};return(n,r)=>{const N=R("maska");return t(),P(Q,{"modal-class":"!w-[60rem]"},{header:_(()=>[C(u(h.value===l(f).Create?"Create New Lab":"Edit Lab"),1)]),body:_(()=>[a("form",{id:"form",onSubmit:D(z,["prevent","stop"])},[a("div",H,[l(m).length>1?(t(),i("div",J,[K,x(l(L),{modelValue:e.value.branchId,"onUpdate:modelValue":r[0]||(r[0]=s=>e.value.branchId=s),options:l(m),onSelect:w,onChange:r[1]||(r[1]=s=>e.value.priceListId=null),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-clear":!1,"can-deselect":!1,class:c(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":o.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),o.value.hasOwnProperty("branchId")?(t(),i("p",X,u(o.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",Y,[ee,b(a("input",{"onUpdate:modelValue":r[2]||(r[2]=s=>e.value.name=s),size:"1",class:c(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":o.value.hasOwnProperty("name")}])},null,2),[[p,e.value.name]]),o.value.hasOwnProperty("name")?(t(),i("p",ae,u(o.value.name[0]),1)):d("",!0)]),a("div",re,[se,b(a("input",{"onUpdate:modelValue":r[3]||(r[3]=s=>e.value.phoneNumber=s),"data-maska":"+0","data-maska-tokens":"0:[0-9]:multiple",size:"1",class:c(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":o.value.hasOwnProperty("phoneNumber")}])},null,2),[[p,e.value.phoneNumber],[N]]),o.value.hasOwnProperty("phoneNumber")?(t(),i("p",oe,u(o.value.phoneNumber[0]),1)):d("",!0)]),a("div",te,[le,b(a("input",{"onUpdate:modelValue":r[4]||(r[4]=s=>e.value.email=s),size:"1",class:c(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":o.value.hasOwnProperty("email")}])},null,2),[[p,e.value.email]]),o.value.hasOwnProperty("email")?(t(),i("p",de,u(o.value.email[0]),1)):d("",!0)]),a("div",{class:c(["flex flex-wrap items-start",{"col-span-2":l(m).length>1}])},[ne,b(a("input",{"onUpdate:modelValue":r[5]||(r[5]=s=>e.value.address=s),size:"1",class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512),[[p,e.value.address]])],2),a("div",ue,[ie,b(a("input",{"onUpdate:modelValue":r[6]||(r[6]=s=>e.value.ratio=s),size:"1","data-maska":"###",class:c(["flex-1 p-2 border border-gray-300 focus:border-blue-500",{"!border-red-500":o.value.hasOwnProperty("ratio")}])},null,2),[[p,e.value.ratio],[N]]),ce,o.value.hasOwnProperty("ratio")?(t(),i("p",be,u(o.value.ratio[0]),1)):d("",!0)]),a("div",pe,[me,x(l(L),{modelValue:e.value.priceListId,"onUpdate:modelValue":r[7]||(r[7]=s=>e.value.priceListId=s),options:V.value,searchable:!0,"value-prop":"id","track-by":"name",label:"name",class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])]),a("div",ve,[fe,b(a("textarea",{"onUpdate:modelValue":r[8]||(r[8]=s=>e.value.notes=s),class:"flex-1 p-2 border border-gray-300 rounded focus:border-blue-500"},null,512),[[p,e.value.notes]])])])],40,G)]),footer:_(()=>[a("button",{class:"btn-blue mr-2",disabled:y.value,form:"form"},[x(T,{"is-loading":y.value},{default:_(()=>[C("Save")]),_:1},8,["is-loading"])],8,he),a("button",{onClick:I,class:"btn-gray"},"Cancel"),h.value===l(f).Edit?(t(),P(l(q),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":r[9]||(r[9]=s=>e.value.isActive=s),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):d("",!0)]),_:1})}}});export{ke as default};
