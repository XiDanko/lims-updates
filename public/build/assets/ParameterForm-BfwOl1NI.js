import{d as H,e as y,x as B,Q as w,A as K,o as u,c as i,b as t,a as h,g as r,u as Y,X as Z,U as ee,R as q,w as R,k as E,t as g,i as d,n as p,h as m,v as f,V as F,F as te,a1 as le,f as ae,_ as se,a4 as oe,m as re,l as ne,$ as ue}from"./main-DmoZ1fz4.js";import{b as M}from"./toggle-DyRQkDOQ.js";import{s as T}from"./multiselect-DAhRltj6.js";import{_ as ie}from"./Tinymce.vue_vue_type_script_setup_true_lang-DGYN-s2o.js";import{F as $}from"./formMode-Bz--3d4P.js";import{R as v}from"./resultType-V5I8keIQ.js";import{_ as de}from"./BranchSelect.vue_vue_type_script_setup_true_lang-D_pdW9WT.js";const ve={class:"flex"},pe={class:"mx-auto mt-3 grid w-52 select-none grid-cols-4 gap-1"},ce=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-6 w-6 mt-0.5"},[t("path",{d:"M9.375 233.4l128-128c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H480c17.69 0 32 14.31 32 32s-14.31 32-32 32H109.3l73.38 73.38c12.5 12.5 12.5 32.75 0 45.25c-12.49 12.49-32.74 12.51-45.25 0l-128-128C-3.125 266.1-3.125 245.9 9.375 233.4z"})],-1),be=[ce],me=H({__name:"FormulaGenerator",props:{modelValue:{},branchId:{}},emits:["update:modelValue"],setup(N,{emit:O}){const k=N,P=O,I=y([]),e=y([]),b=y("");B(()=>{k.modelValue&&(b.value=k.modelValue),V()});const V=async()=>{if(!k.branchId)return;const{data:x}=await w.get(`/api/parameters/list?branchId=${k.branchId}`);I.value=x.data},l=x=>{b.value+=x,P("update:modelValue",b.value)},_=()=>{b.value="",e.value=[],P("update:modelValue",b.value)},C=()=>{b.value=b.value.slice(0,-1),P("update:modelValue",b.value)};return K(()=>k.branchId,()=>{_(),V()}),(x,s)=>(u(),i("div",null,[t("div",ve,[h(r(T),{options:I.value,modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=n=>e.value=n),mode:"multiple",onSelect:s[1]||(s[1]=n=>l(`{${n}}`)),searchable:!0,"value-prop":"shortForm","track-by":"searchableForm",label:"shortForm",class:"w-52 input"},null,8,["options","modelValue"])]),t("div",pe,[t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[2]||(s[2]=n=>l("("))},"("),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[3]||(s[3]=n=>l(")"))},")"),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[4]||(s[4]=n=>l("%"))},"%"),t("div",{class:"cursor-pointer rounded bg-red-500 py-1 text-center text-lg font-bold text-white transition hover:bg-red-600",onClick:C},be),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[5]||(s[5]=n=>l("7"))},"7"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[6]||(s[6]=n=>l("8"))},"8"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[7]||(s[7]=n=>l("9"))},"9"),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[8]||(s[8]=n=>l("+"))},"+"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[9]||(s[9]=n=>l("4"))},"4"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[10]||(s[10]=n=>l("5"))},"5"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[11]||(s[11]=n=>l("6"))},"6"),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[12]||(s[12]=n=>l("-"))},"-"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[13]||(s[13]=n=>l("1"))},"1"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[14]||(s[14]=n=>l("2"))},"2"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[15]||(s[15]=n=>l("3"))},"3"),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[16]||(s[16]=n=>l("*"))},"*"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[17]||(s[17]=n=>l("0"))},"0"),t("div",{class:"cursor-pointer rounded bg-blue-500 py-1 text-center text-lg font-bold text-white transition hover:bg-blue-600",onClick:s[18]||(s[18]=n=>l("."))},"."),t("div",{class:"cursor-pointer rounded bg-red-500 py-1 text-center text-lg font-bold text-white transition hover:bg-red-600",onClick:_},"AC"),t("div",{class:"cursor-pointer rounded bg-gray-600 py-1 text-center text-lg font-bold text-white transition hover:bg-gray-700",onClick:s[19]||(s[19]=n=>l("/"))},"/")])]))}}),ge={key:0,class:"relative"},ye={class:"relative"},he={key:0,class:"text-sm text-red-500"},xe={class:"relative"},fe={key:0,class:"text-sm text-red-500"},we={class:"relative"},ke={key:0,class:"text-sm text-red-500"},Ve={class:"relative"},Pe={key:0,class:"text-sm text-red-500"},Ce={class:"relative"},_e={key:0,class:"text-sm text-red-500"},$e={class:"relative"},Ie=t("label",{class:"label"},"Heading",-1),Re=["value"],Te=["value"],Oe=["value"],Fe=["value"],Ne=["value"],Ue=["value"],Se=["value"],Le={key:0,class:"text-sm text-red-500"},qe={key:1,class:"relative col-span-2"},Ee={key:0,class:"text-sm text-red-500"},Me={class:"relative col-span-2"},He=t("option",{value:""},null,-1),Be=t("option",{value:"negative"},"Negative",-1),Ae=t("option",{value:"positive"},"Positive",-1),De=[He,Be,Ae],ze=t("option",{value:""},null,-1),We=["value"],je=["readonly"],Ge={key:5},Qe={key:7,class:"label"},Xe={key:8,class:"text-sm text-red-500"},Je={class:"relative col-span-2"},Ke=t("label",{class:"label"},"Printable",-1),Ye={key:2,class:"col-span-2"},Ze={class:"relative justify-center"},et=["disabled"],ut=H({__name:"ParameterForm",emits:["close"],setup(N,{emit:O}){const k=O,P=re(),I=ne(),e=y({isPrintable:!0}),b=y($.Create),V=y(!1),l=y({}),_=y([]),C=Y().user.branches,x=y([]),s=y({});B(()=>{C.length===1&&(e.value.branchId=C[0].id,n()),P.path.endsWith("/edit")&&(b.value=$.Edit,j(P.params.id))});const n=()=>{W(),D(),s.value=Z().data.general?.find(c=>c.branchId===e.value.branchId)},A=()=>{e.value.testId=null,e.value.heading=null,e.value.sequenceNumber=null},D=async()=>{const{data:c}=await w.get(`/api/suggestions/list?branchId=${e.value.branchId}&type=parameterHeading`);x.value=c.data},z=async({content:c})=>{const{data:a}=await w.post("/api/suggestions",{branchId:e.value.branchId,type:"parameterHeading",content:c});return x.value.push(a.data),a.data},W=async()=>{const{data:c}=await w.get(`/api/tests/list?branchId=${e.value.branchId}`);_.value=c.data},U=async()=>{const{data:c}=await w.post("/api/parameters/generate-sequence",{testId:e.value.testId});e.value.sequenceNumber=c},j=async c=>{const{data:a}=await w.get(`/api/parameters/${c}`);e.value=a.data,n()},G=async()=>{V.value=!0;try{b.value===$.Create?await Q():await X(),l.value={},ue.fire()}catch(c){l.value=c.response.data.errors??{}}V.value=!1},Q=async()=>{await w.post("/api/parameters",e.value),J(),await U()},X=async()=>{await w.patch(`/api/parameters/${e.value.id}`,e.value),S()},J=()=>{e.value={branchId:e.value.branchId,testId:e.value.testId,heading:e.value.heading,isPrintable:!0},l.value=[]},S=()=>{k("close"),I.back()};return(c,a)=>{const L=ee("maska");return u(),q(oe,{"modal-class":"!w-[56rem]"},{header:R(()=>[E(g(b.value===r($).Create?"Create New Parameter":"Edit Parameter"),1)]),body:R(()=>[t("form",{id:"form",onSubmit:ae(G,["prevent","stop"]),class:"grid grid-cols-2 gap-4"},[r(C).length>1?(u(),i("div",ge,[h(de,{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.branchId=o),error:l.value.branchId,onSelect:n,onChange:A},null,8,["modelValue","error"])])):d("",!0),t("div",ye,[h(r(T),{modelValue:e.value.testId,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.testId=o),options:_.value,onSelect:U,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("testId")}])},null,8,["modelValue","options","class"]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("testId")}])},"Test",2),l.value.hasOwnProperty("testId")?(u(),i("p",he,g(l.value.testId[0]),1)):d("",!0)]),t("div",xe,[m(t("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.sequenceNumber=o),"data-maska":"###",class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("sequenceNumber")}])},null,2),[[f,e.value.sequenceNumber],[L]]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("sequenceNumber")}])},"Seq. No.",2),l.value.hasOwnProperty("sequenceNumber")?(u(),i("p",fe,g(l.value.sequenceNumber[0]),1)):d("",!0)]),t("div",we,[m(t("input",{"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.name=o),class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("name")}])},null,2),[[f,e.value.name]]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("name")}])},"Name",2),l.value.hasOwnProperty("name")?(u(),i("p",ke,g(l.value.name[0]),1)):d("",!0)]),t("div",Ve,[m(t("input",{"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.code=o),class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("code")}])},null,2),[[f,e.value.code]]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("code")}])},"Code",2),l.value.hasOwnProperty("code")?(u(),i("p",Pe,g(l.value.code[0]),1)):d("",!0)]),t("div",Ce,[m(t("input",{"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.shortForm=o),class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("shortForm")}])},null,2),[[f,e.value.shortForm]]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("shortForm")}])},"Short Form",2),l.value.hasOwnProperty("shortForm")?(u(),i("p",_e,g(l.value.shortForm[0]),1)):d("",!0)]),t("div",$e,[h(r(T),{modelValue:e.value.heading,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value.heading=o),options:x.value,"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":!0,"on-create":z,class:"input peer"},null,8,["modelValue","options"]),Ie]),t("div",{class:p(["relative",{"col-span-2 ":r(C).length===1}])},[m(t("select",{"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.resultType=o),onChange:a[8]||(a[8]=o=>e.value.defaultResult=null),class:p(["input h-[2.75rem] peer",{"border-red-500":l.value.hasOwnProperty("resultType")}])},[t("option",{value:r(v).NegativePositive},"N/P",8,Re),t("option",{value:r(v).Numeric},"Numeric",8,Te),t("option",{value:r(v).Text},"Text",8,Oe),t("option",{value:r(v).Multiline},"Multiline",8,Fe),t("option",{value:r(v).List},"List",8,Ne),t("option",{value:r(v).Formula},"Formula",8,Ue),t("option",{value:r(v).Editor},"Editor",8,Se)],34),[[F,e.value.resultType]]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("resultType")}])},"Result Type",2),l.value.hasOwnProperty("resultType")?(u(),i("p",Le,g(l.value.resultType[0]),1)):d("",!0)],2),e.value.resultType===r(v).List?(u(),i("div",qe,[h(r(T),{class:p(["px-0 input peer",{"border-red-500":l.value.hasOwnProperty("resultsList")}]),placeholder:"Type then press enter to create",modelValue:e.value.resultsList,"onUpdate:modelValue":a[9]||(a[9]=o=>e.value.resultsList=o),options:e.value.resultsList,mode:"tags","create-option":!0,searchable:!0,"close-on-select":!1},null,8,["class","modelValue","options"]),t("label",{class:p(["label",{"text-red-500":l.value.hasOwnProperty("resultsList")}])},"Results List",2),l.value.hasOwnProperty("resultsList")?(u(),i("p",Ee,g(l.value.resultsList[0]),1)):d("",!0)])):d("",!0),t("div",Me,[e.value.resultType===r(v).NegativePositive?m((u(),i("select",{key:0,"onUpdate:modelValue":a[10]||(a[10]=o=>e.value.defaultResult=o),class:"input peer"},De,512)),[[F,e.value.defaultResult]]):d("",!0),e.value.resultType===r(v).List?m((u(),i("select",{key:1,"onUpdate:modelValue":a[11]||(a[11]=o=>e.value.defaultResult=o),class:"input peer"},[ze,(u(!0),i(te,null,le(e.value.resultsList,o=>(u(),i("option",{value:o},g(o),9,We))),256))],512)),[[F,e.value.defaultResult]]):d("",!0),[r(v).Text,r(v).Formula].includes(e.value.resultType)?m((u(),i("input",{key:2,"onUpdate:modelValue":a[12]||(a[12]=o=>e.value.defaultResult=o),readonly:e.value.resultType===r(v).Formula,class:p(["input peer",{"border-red-500":l.value.hasOwnProperty("defaultResult")}])},null,10,je)),[[f,e.value.defaultResult]]):d("",!0),e.value.resultType===r(v).Multiline?m((u(),i("textarea",{key:3,"onUpdate:modelValue":a[13]||(a[13]=o=>e.value.defaultResult=o),rows:"3",class:p(["py-2 input peer",{"border-red-500":l.value.hasOwnProperty("defaultResult")}])},null,2)),[[f,e.value.defaultResult]]):d("",!0),e.value.resultType===r(v).Numeric?m((u(),i("input",{key:4,"onUpdate:modelValue":a[14]||(a[14]=o=>e.value.defaultResult=o),"data-maska":"0.0","data-maska-tokens":"0:[0-9]:multiple",class:"input peer"},null,512)),[[f,e.value.defaultResult],[L]]):d("",!0),e.value.resultType===r(v).Editor?(u(),i("div",Ge,[h(ie,{modelValue:e.value.defaultResult,"onUpdate:modelValue":a[15]||(a[15]=o=>e.value.defaultResult=o),"limit-width":s.value?.resultEditorMaxWidth,"limit-height":s.value?.resultEditorMaxHeight},null,8,["modelValue","limit-width","limit-height"])])):d("",!0),e.value.resultType?d("",!0):m((u(),i("input",{key:6,"onUpdate:modelValue":a[16]||(a[16]=o=>e.value.defaultResult=o),disabled:"",class:"input peer"},null,512)),[[f,e.value.defaultResult]]),e.value.resultType!==r(v).Editor?(u(),i("label",Qe,"Default Result")):d("",!0),l.value.hasOwnProperty("defaultResult")?(u(),i("p",Xe,g(l.value.defaultResult[0]),1)):d("",!0)]),t("div",Je,[h(r(M),{modelValue:e.value.isPrintable,"onUpdate:modelValue":a[17]||(a[17]=o=>e.value.isPrintable=o),class:"input peer pt-2.5"},null,8,["modelValue"]),Ke]),e.value.resultType===r(v).Formula?(u(),i("div",Ye,[t("div",Ze,[h(me,{modelValue:e.value.defaultResult,"onUpdate:modelValue":a[18]||(a[18]=o=>e.value.defaultResult=o),branchId:e.value.branchId},null,8,["modelValue","branchId"])])])):d("",!0)],32)]),footer:R(()=>[t("button",{class:"me-2 btn-blue",disabled:V.value,form:"form"},[h(se,{"is-loading":V.value},{default:R(()=>[E("Save")]),_:1},8,["is-loading"])],8,et),t("button",{onClick:S,class:"btn-gray"},"Cancel"),b.value===r($).Edit?(u(),q(r(M),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[19]||(a[19]=o=>e.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):d("",!0)]),_:1})}}});export{ut as default};
