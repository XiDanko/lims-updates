import{d as V,e as h,x as $,o as s,c as n,a as _,h as v,v as w,b as e,T as x,Q as C,r as M,V as U,w as S,k as B,g as p,i as y,F as k,W as T,t as f,X as F,Y as K,U as z,a3 as D,Z as N}from"./main-6e47ceb6.js";import{M as Q}from"./Master-c2e1e299.js";import{_ as I}from"./Paginator.vue_vue_type_script_setup_true_lang-161ff6db.js";import{u as P}from"./urlQueryManager-757a21bf.js";import{A as j}from"./ActivityLogSidebar-44a5ec42.js";import{_ as q}from"./BranchFilter.vue_vue_type_script_setup_true_lang-d104a2b1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-27b4da8b.js";const E={class:"flex gap-2 items-center ml-auto"},H=["onKeyup"],R=["onKeyup"],W=V({__name:"SuggestionsFilter",emits:["change"],setup(A,{emit:m}){const d=new URLSearchParams(location.search),u=h(""),r=h(""),a=h("");h(""),$(()=>{i()});const i=()=>{u.value=d.get("branchId")??"",a.value=d.get("type")??"",r.value=d.get("content")??""},g=()=>{const l=`branchId=${u.value}&type=${a.value}&content=${r.value}&page=1`;m("change",l)};return(l,t)=>(s(),n("div",E,[_(q,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=o=>u.value=o),onChange:g},null,8,["modelValue"]),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value=o),onKeyup:x(g,["enter"]),type:"text",placeholder:"Suggestion type",class:"p-1.5 w-56 border border-gray-300 rounded focus:border-blue-500"},null,40,H),[[w,a.value]]),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.value=o),onKeyup:x(g,["enter"]),type:"text",placeholder:"Suggestion content",class:"p-1.5 w-56 border border-gray-300 rounded focus:border-blue-500"},null,40,R),[[w,r.value]])]))}}),X={class:"flex items-center mb-5"},Y={class:"pr-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},Z={class:"w-full"},G={class:"sticky top-0 z-10 text-left"},J=e("th",{class:"p-2 bg-gray-600 text-white font-semibold first-of-type:rounded-tl last-of-type:rounded-tr"},"Type",-1),O=e("th",{class:"p-2 bg-gray-600 text-white font-semibold first-of-type:rounded-tl last-of-type:rounded-tr"},"Content",-1),ee=e("th",{class:"p-2 bg-gray-600 text-white font-semibold first-of-type:rounded-tl last-of-type:rounded-tr"},"Branch",-1),te={key:0,class:"p-2 bg-gray-600 text-white font-semibold first-of-type:rounded-tl last-of-type:rounded-tr"},oe={class:"transition even:bg-gray-100"},se={class:"py-1 px-2 border border-gray-200"},ne={class:"py-1 px-2 border border-gray-200"},re={class:"py-1 px-2 border border-gray-200"},ae={key:0,class:"py-1 px-2 border border-gray-200 text-center"},ie={class:"flex justify-center items-center gap-3"},le=["onClick"],ce=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),de=[ce],ue=["onClick"],pe=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"w-5 h-5"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),_e=[pe],xe=V({__name:"Suggestions",setup(A){const m=h([]),d=h({}),{updateUrlQuery:u}=P(),{hasPermissionTo:r,hasAnyPermission:a}=z();$(()=>i(location.search));const i=async l=>{const t=await u(l),{data:o}=await C.get(`/api/suggestions?${t}`);m.value=o.data,d.value=o.meta},g=async l=>{const{isConfirmed:t}=await D.fire();t&&(await C.delete(`/api/suggestions/${l}`),N.fire(),await i(location.search))};return(l,t)=>{const o=M("router-view"),b=U("tip");return s(),n(k,null,[_(o,{onClose:i}),_(Q,null,{header:S(()=>[B("Suggestions")]),body:S(()=>[e("div",X,[_(W,{onChange:i})]),e("section",Y,[e("table",Z,[e("thead",null,[e("tr",G,[J,O,ee,p(a)("Suggestion.delete","ActivityLog.list")?(s(),n("th",te)):y("",!0)])]),e("tbody",null,[(s(!0),n(k,null,T(m.value,c=>(s(),n("tr",oe,[e("td",se,f(c.type),1),e("td",ne,f(c.content),1),e("td",re,f(c.branch.name),1),p(a)("Suggestion.delete","ActivityLog.list")?(s(),n("td",ae,[e("div",ie,[p(r)("Suggestion.delete")?v((s(),n("button",{key:0,onClick:L=>g(c.id),class:"text-red-500 cursor-pointer"},de,8,le)),[[b,"Delete"]]):y("",!0),p(r)("ActivityLog.list")?v((s(),n("button",{key:1,onClick:L=>p(F).emit(p(K).Show,c.id),class:"text-gray-600 cursor-pointer"},_e,8,ue)),[[b,"View Activities"]]):y("",!0)])])):y("",!0)]))),256))])])])]),_:1}),_(I,{data:d.value,onChange:t[0]||(t[0]=c=>i(`page=${c}`)),class:"mt-3"},null,8,["data"]),_(j)],64)}}});export{xe as default};
