import{d as E,u as M,e as d,x as A,Q as f,o as l,R as V,w as c,k as C,t as h,g as v,b as t,c as _,a as k,i as m,h as y,v as w,n as p,f as F,_ as R,a4 as T,m as D,l as z,$ as L}from"./main-BgbWFIXK.js";import{b as Q}from"./toggle-CP_W0i88.js";import{F as r}from"./formMode-Bz--3d4P.js";import{_ as W}from"./BranchSelect.vue_vue_type_script_setup_true_lang-ChkyAztq.js";import"./multiselect-DeMhawmc.js";const j={key:0,class:"relative"},q={class:"relative"},G={key:0,class:"text-sm text-red-500"},H={class:"relative"},J={key:0,class:"text-sm text-red-500"},K={class:"relative"},X=t("label",{class:"label"},"Notes",-1),Y=["disabled"],le=E({__name:"ServiceForm",emits:["close"],setup(Z,{emit:S}){const I=S,g=D(),N=z(),b=M().user.branches,e=d({}),n=d(r.Create),i=d(!1),a=d({});A(()=>{b.length===1&&(e.value.branchId=b[0].id),g.path.endsWith("/edit")&&(n.value=r.Edit,O(g.params.id))});const O=async u=>{const{data:s}=await f.get(`/api/services/${u}`);e.value=s.data},P=async()=>{i.value=!0;try{n.value===r.Create?await $():await U(),a.value={},L.fire()}catch(u){a.value=u.response.data.errors??{}}i.value=!1},$=async()=>{await f.post("/api/services",e.value),B()},U=async()=>{await f.patch(`/api/services/${e.value.id}`,e.value),x()},B=()=>{e.value={branchId:e.value.branchId},a.value=[]},x=()=>{I("close"),N.back()};return(u,s)=>(l(),V(T,null,{header:c(()=>[C(h(n.value===v(r).Create?"Create New Service":"Edit Service"),1)]),body:c(()=>[t("form",{id:"form",onSubmit:F(P,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[v(b).length>1?(l(),_("div",j,[k(W,{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=o=>e.value.branchId=o),error:a.value.branchId},null,8,["modelValue","error"])])):m("",!0),t("div",q,[y(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.name=o),class:p(["input peer",{"border-red-500":a.value.hasOwnProperty("name")}])},null,2),[[w,e.value.name]]),t("label",{class:p(["label",{"text-red-500":a.value.hasOwnProperty("name")}])},"Name",2),a.value.hasOwnProperty("name")?(l(),_("p",G,h(a.value.name[0]),1)):m("",!0)]),t("div",H,[y(t("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>e.value.code=o),class:p(["input peer",{"border-red-500":a.value.hasOwnProperty("code")}])},null,2),[[w,e.value.code]]),t("label",{class:p(["label",{"text-red-500":a.value.hasOwnProperty("code")}])},"Code",2),a.value.hasOwnProperty("code")?(l(),_("p",J,h(a.value.code[0]),1)):m("",!0)]),t("div",K,[y(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=o=>e.value.notes=o),rows:"4",class:"py-2 input peer"},null,512),[[w,e.value.notes]]),X])],32)]),footer:c(()=>[t("button",{class:"me-2 btn-blue",disabled:i.value,form:"form"},[k(R,{"is-loading":i.value},{default:c(()=>[C("Save")]),_:1},8,["is-loading"])],8,Y),t("button",{onClick:x,class:"btn-gray"},"Cancel"),n.value===v(r).Edit?(l(),V(v(Q),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[4]||(s[4]=o=>e.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):m("",!0)]),_:1}))}});export{le as default};
