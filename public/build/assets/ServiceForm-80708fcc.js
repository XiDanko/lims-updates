import{d as E,u as F,e as b,x as M,Q as h,o as t,R as V,w as p,k,t as v,g as l,b as a,c as f,a as C,n as _,i as d,h as y,v as w,f as $,_ as A,a9 as R,m as T,l as D,Z as z}from"./main-56f58ed8.js";import{b as L}from"./toggle-876d3de4.js";import{s as Q}from"./multiselect-167e14f5.js";import{F as n}from"./formMode-f60a729f.js";const W=["onSubmit"],Z={key:0,class:"flex flex-wrap items-center mb-3"},j=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),q={key:0,class:"ml-24 w-full text-red-500 text-sm"},G={class:"flex flex-wrap items-center mb-3"},H=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Code",-1),J={key:0,class:"w-full ml-24 text-red-500 text-sm"},K={class:"flex flex-wrap items-center mb-3"},X=a("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),Y={key:0,class:"w-full ml-24 text-red-500 text-sm"},ee={class:"flex flex-wrap items-center"},ae=a("span",{class:"w-full"},"Notes",-1),se=["disabled"],ne=E({__name:"ServiceForm",emits:["close"],setup(re,{emit:S}){const x=T(),I=D(),u=F().user.branches,e=b({}),c=b(n.Create),i=b(!1),r=b({});M(()=>{u.length===1&&(e.value.branchId=u[0].id),x.path.endsWith("/edit")&&(c.value=n.Edit,N(x.params.id))});const N=async m=>{const{data:s}=await h.get(`/api/services/${m}`);e.value=s.data},O=async()=>{i.value=!0;try{c.value===n.Create?await P():await B(),z.fire()}catch(m){r.value=m.response.data.errors??{}}i.value=!1},P=async()=>{await h.post("/api/services",e.value),U()},B=async()=>{await h.patch(`/api/services/${e.value.id}`,e.value),g()},U=()=>{e.value={branchId:e.value.branchId},r.value=[]},g=()=>{S("close"),I.back()};return(m,s)=>(t(),V(R,null,{header:p(()=>[k(v(c.value===l(n).Create?"Create New Service":"Edit Service"),1)]),body:p(()=>[a("form",{id:"form",onSubmit:$(O,["prevent","stop"])},[l(u).length>1?(t(),f("div",Z,[j,C(l(Q),{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=o=>e.value.branchId=o),options:l(u),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:_(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(t(),f("p",q,v(r.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",G,[H,y(a("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.code=o),class:_(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[w,e.value.code]]),r.value.hasOwnProperty("code")?(t(),f("p",J,v(r.value.code[0]),1)):d("",!0)]),a("div",K,[X,y(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>e.value.name=o),class:_(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[w,e.value.name]]),r.value.hasOwnProperty("name")?(t(),f("p",Y,v(r.value.name[0]),1)):d("",!0)]),a("div",ee,[ae,y(a("textarea",{"onUpdate:modelValue":s[3]||(s[3]=o=>e.value.notes=o),rows:"4",class:"flex-1 p-2 border border-gray-300 rounded focus:border-blue-500"},null,512),[[w,e.value.notes]])])],40,W)]),footer:p(()=>[a("button",{class:"btn-blue mr-2",disabled:i.value,form:"form"},[C(A,{"is-loading":i.value},{default:p(()=>[k("Save")]),_:1},8,["is-loading"])],8,se),a("button",{onClick:g,class:"btn-gray"},"Cancel"),c.value===l(n).Edit?(t(),V(l(L),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[4]||(s[4]=o=>e.value.isActive=o),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):d("",!0)]),_:1}))}});export{ne as default};
