import{d as B,u as E,e as c,x as M,Q as p,o as d,R as g,w as m,k as y,t as V,g as o,b as s,c as w,a as f,i as b,h as U,v as A,n as x,f as F,_ as O,a4 as R,m as T,l as z,$ as Q}from"./main-BgbWFIXK.js";import{b as C}from"./toggle-CP_W0i88.js";import{F as r}from"./formMode-Bz--3d4P.js";import{_ as W}from"./BranchSelect.vue_vue_type_script_setup_true_lang-ChkyAztq.js";import"./multiselect-DeMhawmc.js";const j={key:0,class:"relative"},q={class:"relative"},G={key:0,class:"text-sm text-red-500"},H={class:"relative"},J=s("label",{class:"label"},"Default",-1),K=["disabled"],se=B({__name:"PriceListForm",emits:["close"],setup(X,{emit:k}){const I=k,h=T(),P=z(),v=E().user.branches,e=c({}),i=c(r.Create),n=c(!1),t=c({});M(()=>{v.length===1&&(e.value.branchId=v[0].id),h.path.endsWith("/edit")&&(i.value=r.Edit,L(h.params.id))});const L=async u=>{const{data:a}=await p.get(`/api/price-lists/${u}`);e.value=a.data},N=async()=>{n.value=!0;try{i.value===r.Create?await $():await D(),t.value={},Q.fire()}catch(u){t.value=u.response.data.errors??{}}n.value=!1},$=async()=>{await p.post("/api/price-lists",e.value),S()},D=async()=>{await p.patch(`/api/price-lists/${e.value.id}`,e.value),_()},S=()=>{e.value={branchId:e.value.branchId},t.value=[]},_=()=>{I("close"),P.back()};return(u,a)=>(d(),g(R,null,{header:m(()=>[y(V(i.value===o(r).Create?"Create New Price List":"Edit Price List"),1)]),body:m(()=>[s("form",{id:"form",onSubmit:F(N,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[o(v).length>1?(d(),w("div",j,[f(W,{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.branchId=l),error:t.value.branchId},null,8,["modelValue","error"])])):b("",!0),s("div",q,[U(s("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.name=l),class:x(["input peer",{"border-red-500":t.value.hasOwnProperty("name")}])},null,2),[[A,e.value.name]]),s("label",{class:x(["label",{"text-red-500":t.value.hasOwnProperty("name")}])},"Name",2),t.value.hasOwnProperty("name")?(d(),w("p",G,V(t.value.name[0]),1)):b("",!0)]),s("div",H,[f(o(C),{modelValue:e.value.isDefault,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.isDefault=l),class:"input peer pt-2.5"},null,8,["modelValue"]),J])],32)]),footer:m(()=>[s("button",{class:"me-2 btn-blue",disabled:n.value,form:"form"},[f(O,{"is-loading":n.value},{default:m(()=>[y("Save")]),_:1},8,["is-loading"])],8,K),s("button",{onClick:_,class:"btn-gray"},"Cancel"),i.value===o(r).Edit?(d(),g(o(C),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.isActive=l),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):b("",!0)]),_:1}))}});export{se as default};
