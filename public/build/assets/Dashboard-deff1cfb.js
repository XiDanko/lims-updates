import{M as nt}from"./Master-c8d301f4.js";import{d as y,g as L,x as m,y as x,o as _,c as g,a as f,w as A,i as H,C as b,z as it,A as w,b as v,B as R,D as ot,E as p,G as lt,H as dt,I as ut,J as X,K as C,L as ct,P as pt,M as vt,N as ft,O as ht,Q as _t,R as yt,S as mt}from"./main-5548143a.js";import{i as gt}from"./index.es-721e1c12.js";import{d as xt}from"./datepickerPresets-afa0dfdf.js";import{_ as bt}from"./BranchFilter.vue_vue_type_script_setup_true_lang-9c1eb286.js";import{u as wt}from"./urlQueryManager-a6ec7c9d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-30de6652.js";const $t={class:"flex items-center justify-center gap-2 text-base font-normal text-gray-600"},kt=y({__name:"DashboardFilter",emits:["change"],setup(e,{emit:a}){const t=new URLSearchParams(location.search),r=L(""),s=L([null,null]);m(()=>i());const n=x(()=>s.value[0]===null||s.value[1]===null?"":`${s.value[0]}~${s.value[1]}`),i=()=>{r.value=t.get("branchId")??"",t.get("dateRange")&&(s.value=t.get("dateRange").split("~"))},o=()=>{let d=`branchId=${r.value}&dateRange=${n.value}`;a("change",d)};return(d,l)=>(_(),g("div",$t,[f(bt,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=u=>r.value=u),onChange:o},null,8,["modelValue"]),f(H(gt),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:H(xt),placeholder:"Select date range",value:s.value,"onUpdate:value":l[1]||(l[1]=u=>s.value=u),onChange:o,clearable:!1,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":A(()=>[]),_:1},8,["shortcuts","value"])]))}});b.register(...it);const St=v("canvas",{id:"visitsStatistics"},null,-1),Mt=[St],Pt=y({__name:"VisitsStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(a.data.newPatients)}% New Patients`,`${r(a.data.recurringPatients)}%  Recurring Patients`],datasets:[{data:[a.data.newPatients,a.data.recurringPatients]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Total Visits: ${a.data.total?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("visitsStatistics"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,Mt))}}),Ct=v("canvas",{id:"visitsChart"},null,-1),Et=[Ct],It=y({__name:"VisitsChart",props:{data:{}},setup(e){const a=e;let t=null;const r=x(()=>({type:"line",data:{labels:a.data.totalVisits.map(s=>s.label),datasets:[{label:"New Patients",data:a.data.newPatients.map(s=>s.count)},{label:"Recurring Patients",data:a.data.recurringPatients.map(s=>s.count)},{label:"Total Visits",data:a.data.totalVisits.map(s=>s.count)}]},options:{responsive:!0,interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,text:"Visits Chart"}}}}));return m(()=>{t=new b(document.getElementById("visitsChart"),r.value)}),w(a,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),g("div",null,Et))}}),Rt=v("canvas",{id:"testsStatistics"},null,-1),Tt=[Rt],Bt=y({__name:"TestsStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:a.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:a.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Ordered Tests: ${a.data.total?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("testsStatistics"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,Tt))}}),Nt=v("canvas",{id:"packagesStatistics"},null,-1),Ot=[Nt],Dt=y({__name:"PackagesStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:a.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:a.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Ordered Packages: ${a.data.total?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("packagesStatistics"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,Ot))}}),At=v("canvas",{id:"ordersStatistics"},null,-1),Lt=[At],Ut=y({__name:"OrdersStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(a.data.tests)}% Tests`,`${r(a.data.packages)}%  Packages`,`${r(a.data.services)}%  Services`],datasets:[{data:[a.data.tests,a.data.packages,a.data.services]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Total Orders: ${a.data.total?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("ordersStatistics"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,Lt))}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Y=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),E={toTextLines:function(e){var a=[],t;for(e=[].concat(e);e.length;)t=e.pop(),typeof t=="string"?a.unshift.apply(a,t.split(`
`)):Array.isArray(t)?e.push.apply(e,t):C(e)||a.unshift(""+t);return a},textSize:function(e,a,t){var r=[].concat(a),s=r.length,n=e.font,i=0,o;for(e.font=t.string,o=0;o<s;++o)i=Math.max(e.measureText(r[o]).width,i);return e.font=n,{height:s*t.lineHeight,width:i}},bound:function(e,a,t){return Math.max(e,Math.min(a,t))},arrayDiff:function(e,a){var t=e.slice(),r=[],s,n,i,o;for(s=0,i=a.length;s<i;++s)o=a[s],n=t.indexOf(o),n===-1?r.push([o,1]):t.splice(n,1);for(s=0,i=t.length;s<i;++s)r.push([t[s],-1]);return r},rasterize:function(e){return Math.round(e*Y)/Y}};function F(e,a){var t=a.x,r=a.y;if(t===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var s=e.x-t,n=e.y-r,i=Math.sqrt(s*s+n*n);return{x:i?s/i:0,y:i?n/i:-1}}function zt(e,a,t,r,s){switch(s){case"center":t=r=0;break;case"bottom":t=0,r=1;break;case"right":t=1,r=0;break;case"left":t=-1,r=0;break;case"top":t=0,r=-1;break;case"start":t=-t,r=-r;break;case"end":break;default:s*=Math.PI/180,t=Math.cos(s),r=Math.sin(s);break}return{x:e,y:a,vx:t,vy:r}}var Ft=0,q=1,J=2,K=4,Z=8;function B(e,a,t){var r=Ft;return e<t.left?r|=q:e>t.right&&(r|=J),a<t.top?r|=Z:a>t.bottom&&(r|=K),r}function jt(e,a){for(var t=e.x0,r=e.y0,s=e.x1,n=e.y1,i=B(t,r,a),o=B(s,n,a),d,l,u;!(!(i|o)||i&o);)d=i||o,d&Z?(l=t+(s-t)*(a.top-r)/(n-r),u=a.top):d&K?(l=t+(s-t)*(a.bottom-r)/(n-r),u=a.bottom):d&J?(u=r+(n-r)*(a.right-t)/(s-t),l=a.right):d&q&&(u=r+(n-r)*(a.left-t)/(s-t),l=a.left),d===i?(t=l,r=u,i=B(t,r,a)):(s=l,n=u,o=B(s,n,a));return{x0:t,x1:s,y0:r,y1:n}}function N(e,a){var t=a.anchor,r=e,s,n;return a.clamp&&(r=jt(r,a.area)),t==="start"?(s=r.x0,n=r.y0):t==="end"?(s=r.x1,n=r.y1):(s=(r.x0+r.x1)/2,n=(r.y0+r.y1)/2),zt(s,n,e.vx,e.vy,a.align)}var O={arc:function(e,a){var t=(e.startAngle+e.endAngle)/2,r=Math.cos(t),s=Math.sin(t),n=e.innerRadius,i=e.outerRadius;return N({x0:e.x+r*n,y0:e.y+s*n,x1:e.x+r*i,y1:e.y+s*i,vx:r,vy:s},a)},point:function(e,a){var t=F(e,a.origin),r=t.x*e.options.radius,s=t.y*e.options.radius;return N({x0:e.x-r,y0:e.y-s,x1:e.x+r,y1:e.y+s,vx:t.x,vy:t.y},a)},bar:function(e,a){var t=F(e,a.origin),r=e.x,s=e.y,n=0,i=0;return e.horizontal?(r=Math.min(e.x,e.base),n=Math.abs(e.base-e.x)):(s=Math.min(e.y,e.base),i=Math.abs(e.base-e.y)),N({x0:r,y0:s+i,x1:r+n,y1:s,vx:t.x,vy:t.y},a)},fallback:function(e,a){var t=F(e,a.origin);return N({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:t.x,vy:t.y},a)}},k=E.rasterize;function Wt(e){var a=e.borderWidth||0,t=e.padding,r=e.size.height,s=e.size.width,n=-s/2,i=-r/2;return{frame:{x:n-t.left-a,y:i-t.top-a,w:s+t.width+a*2,h:r+t.height+a*2},text:{x:n,y:i,w:s,h:r}}}function Vt(e,a){var t=a.chart.getDatasetMeta(a.datasetIndex).vScale;if(!t)return null;if(t.xCenter!==void 0&&t.yCenter!==void 0)return{x:t.xCenter,y:t.yCenter};var r=t.getBasePixel();return e.horizontal?{x:r,y:null}:{x:null,y:r}}function Gt(e){return e instanceof ct?O.arc:e instanceof pt?O.point:e instanceof vt?O.bar:O.fallback}function Ht(e,a,t,r,s,n){var i=Math.PI/2;if(n){var o=Math.min(n,s/2,r/2),d=a+o,l=t+o,u=a+r-o,c=t+s-o;e.moveTo(a,l),d<u&&l<c?(e.arc(d,l,o,-Math.PI,-i),e.arc(u,l,o,-i,0),e.arc(u,c,o,0,i),e.arc(d,c,o,i,Math.PI)):d<u?(e.moveTo(d,t),e.arc(u,l,o,-i,i),e.arc(d,l,o,i,Math.PI+i)):l<c?(e.arc(d,l,o,-Math.PI,0),e.arc(d,c,o,0,Math.PI)):e.arc(d,l,o,-Math.PI,Math.PI),e.closePath(),e.moveTo(a,t)}else e.rect(a,t,r,s)}function Yt(e,a,t){var r=t.backgroundColor,s=t.borderColor,n=t.borderWidth;!r&&(!s||!n)||(e.beginPath(),Ht(e,k(a.x)+n/2,k(a.y)+n/2,k(a.w)-n,k(a.h)-n,t.borderRadius),e.closePath(),r&&(e.fillStyle=r,e.fill()),s&&n&&(e.strokeStyle=s,e.lineWidth=n,e.lineJoin="miter",e.stroke()))}function Qt(e,a,t){var r=t.lineHeight,s=e.w,n=e.x,i=e.y+r/2;return a==="center"?n+=s/2:(a==="end"||a==="right")&&(n+=s),{h:r,w:s,x:n,y:i}}function Xt(e,a,t){var r=e.shadowBlur,s=t.stroked,n=k(t.x),i=k(t.y),o=k(t.w);s&&e.strokeText(a,n,i,o),t.filled&&(r&&s&&(e.shadowBlur=0),e.fillText(a,n,i,o),r&&s&&(e.shadowBlur=r))}function qt(e,a,t,r){var s=r.textAlign,n=r.color,i=!!n,o=r.font,d=a.length,l=r.textStrokeColor,u=r.textStrokeWidth,c=l&&u,$;if(!(!d||!i&&!c))for(t=Qt(t,s,o),e.font=o.string,e.textAlign=s,e.textBaseline="middle",e.shadowBlur=r.textShadowBlur,e.shadowColor=r.textShadowColor,i&&(e.fillStyle=n),c&&(e.lineJoin="round",e.lineWidth=u,e.strokeStyle=l),$=0,d=a.length;$<d;++$)Xt(e,a[$],{stroked:c,filled:i,w:t.w,x:t.x,y:t.y+t.h*$})}var tt=function(e,a,t,r){var s=this;s._config=e,s._index=r,s._model=null,s._rects=null,s._ctx=a,s._el=t};R(tt.prototype,{_modelize:function(e,a,t,r){var s=this,n=s._index,i=ot(p([t.font,{}],r,n)),o=p([t.color,lt.color],r,n);return{align:p([t.align,"center"],r,n),anchor:p([t.anchor,"center"],r,n),area:r.chart.chartArea,backgroundColor:p([t.backgroundColor,null],r,n),borderColor:p([t.borderColor,null],r,n),borderRadius:p([t.borderRadius,0],r,n),borderWidth:p([t.borderWidth,0],r,n),clamp:p([t.clamp,!1],r,n),clip:p([t.clip,!1],r,n),color:o,display:e,font:i,lines:a,offset:p([t.offset,4],r,n),opacity:p([t.opacity,1],r,n),origin:Vt(s._el,r),padding:dt(p([t.padding,4],r,n)),positioner:Gt(s._el),rotation:p([t.rotation,0],r,n)*(Math.PI/180),size:E.textSize(s._ctx,a,i),textAlign:p([t.textAlign,"start"],r,n),textShadowBlur:p([t.textShadowBlur,0],r,n),textShadowColor:p([t.textShadowColor,o],r,n),textStrokeColor:p([t.textStrokeColor,o],r,n),textStrokeWidth:p([t.textStrokeWidth,0],r,n)}},update:function(e){var a=this,t=null,r=null,s=a._index,n=a._config,i,o,d,l=p([n.display,!0],e,s);l&&(i=e.dataset.data[s],o=ut(X(n.formatter,[i,e]),i),d=C(o)?[]:E.toTextLines(o),d.length&&(t=a._modelize(l,d,n,e),r=Wt(t))),a._model=t,a._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,a){var t=this,r=e.ctx,s=t._model,n=t._rects,i;this.visible()&&(r.save(),s.clip&&(i=s.area,r.beginPath(),r.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),r.clip()),r.globalAlpha=E.bound(0,s.opacity,1),r.translate(k(a.x),k(a.y)),r.rotate(s.rotation),Yt(r,n.frame,s),qt(r,s.lines,n.text,s),r.restore())}});var Jt=Number.MIN_SAFE_INTEGER||-9007199254740991,Kt=Number.MAX_SAFE_INTEGER||9007199254740991;function P(e,a,t){var r=Math.cos(t),s=Math.sin(t),n=a.x,i=a.y;return{x:n+r*(e.x-n)-s*(e.y-i),y:i+s*(e.x-n)+r*(e.y-i)}}function Q(e,a){var t=Kt,r=Jt,s=a.origin,n,i,o,d,l;for(n=0;n<e.length;++n)i=e[n],o=i.x-s.x,d=i.y-s.y,l=a.vx*o+a.vy*d,t=Math.min(t,l),r=Math.max(r,l);return{min:t,max:r}}function D(e,a){var t=a.x-e.x,r=a.y-e.y,s=Math.sqrt(t*t+r*r);return{vx:(a.x-e.x)/s,vy:(a.y-e.y)/s,origin:e,ln:s}}var at=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};R(at.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,a,t){this._rotation=t,this._rect={x:a.x+e.x,y:a.y+e.y,w:a.w,h:a.h}},contains:function(e){var a=this,t=1,r=a._rect;return e=P(e,a.center(),-a._rotation),!(e.x<r.x-t||e.y<r.y-t||e.x>r.x+r.w+t*2||e.y>r.y+r.h+t*2)},intersects:function(e){var a=this._points(),t=e._points(),r=[D(a[0],a[1]),D(a[0],a[3])],s,n,i;for(this._rotation!==e._rotation&&r.push(D(t[0],t[1]),D(t[0],t[3])),s=0;s<r.length;++s)if(n=Q(a,r[s]),i=Q(t,r[s]),n.max<i.min||i.max<n.min)return!1;return!0},_points:function(){var e=this,a=e._rect,t=e._rotation,r=e.center();return[P({x:a.x,y:a.y},r,t),P({x:a.x+a.w,y:a.y},r,t),P({x:a.x+a.w,y:a.y+a.h},r,t),P({x:a.x,y:a.y+a.h},r,t)]}});function et(e,a,t){var r=a.positioner(e,a),s=r.vx,n=r.vy;if(!s&&!n)return{x:r.x,y:r.y};var i=t.w,o=t.h,d=a.rotation,l=Math.abs(i/2*Math.cos(d))+Math.abs(o/2*Math.sin(d)),u=Math.abs(i/2*Math.sin(d))+Math.abs(o/2*Math.cos(d)),c=1/Math.max(Math.abs(s),Math.abs(n));return l*=s*c,u*=n*c,l+=a.offset*s,u+=a.offset*n,{x:r.x+l,y:r.y+u}}function Zt(e,a){var t,r,s,n;for(t=e.length-1;t>=0;--t)for(s=e[t].$layout,r=t-1;r>=0&&s._visible;--r)n=e[r].$layout,n._visible&&s._box.intersects(n._box)&&a(s,n);return e}function ta(e){var a,t,r,s,n,i,o;for(a=0,t=e.length;a<t;++a)r=e[a],s=r.$layout,s._visible&&(o=new Proxy(r._el,{get:(d,l)=>d.getProps([l],!0)[l]}),n=r.geometry(),i=et(o,r.model(),n),s._box.update(i,n,r.rotation()));return Zt(e,function(d,l){var u=d._hidable,c=l._hidable;u&&c||c?l._visible=!1:u&&(d._visible=!1)})}var I={prepare:function(e){var a=[],t,r,s,n,i;for(t=0,s=e.length;t<s;++t)for(r=0,n=e[t].length;r<n;++r)i=e[t][r],a.push(i),i.$layout={_box:new at,_hidable:!1,_visible:!0,_set:t,_idx:i._index};return a.sort(function(o,d){var l=o.$layout,u=d.$layout;return l._idx===u._idx?u._set-l._set:u._idx-l._idx}),this.update(a),a},update:function(e){var a=!1,t,r,s,n,i;for(t=0,r=e.length;t<r;++t)s=e[t],n=s.model(),i=s.$layout,i._hidable=n&&n.display==="auto",i._visible=s.visible(),a|=i._hidable;a&&ta(e)},lookup:function(e,a){var t,r;for(t=e.length-1;t>=0;--t)if(r=e[t].$layout,r&&r._visible&&r._box.contains(a))return e[t];return null},draw:function(e,a){var t,r,s,n,i,o;for(t=0,r=a.length;t<r;++t)s=a[t],n=s.$layout,n._visible&&(i=s.geometry(),o=et(s._el,s.model(),i),n._box.update(o,i,s.rotation()),s.draw(e,o))}},aa=function(e){if(C(e))return null;var a=e,t,r,s;if(ht(e))if(!C(e.label))a=e.label;else if(!C(e.r))a=e.r;else for(a="",t=Object.keys(e),s=0,r=t.length;s<r;++s)a+=(s!==0?", ":"")+t[s]+": "+e[t[s]];return""+a},ea={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:aa,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},h="$datalabels",rt="$default";function ra(e,a){var t=e.datalabels,r={},s=[],n,i;return t===!1?null:(t===!0&&(t={}),a=R({},[a,t]),n=a.labels||{},i=Object.keys(n),delete a.labels,i.length?i.forEach(function(o){n[o]&&s.push(R({},[a,n[o],{_key:o}]))}):s.push(a),r=s.reduce(function(o,d){return ft(d.listeners||{},function(l,u){o[u]=o[u]||{},o[u][d._key||rt]=l}),delete d.listeners,o},{}),{labels:s,listeners:r})}function j(e,a,t,r){if(a){var s=t.$context,n=t.$groups,i;a[n._set]&&(i=a[n._set][n._key],i&&X(i,[s,r])===!0&&(e[h]._dirty=!0,t.update(s)))}}function sa(e,a,t,r,s){var n,i;!t&&!r||(t?r?t!==r&&(i=n=!0):i=!0:n=!0,i&&j(e,a.leave,t,s),n&&j(e,a.enter,r,s))}function na(e,a){var t=e[h],r=t._listeners,s,n;if(!(!r.enter&&!r.leave)){if(a.type==="mousemove")n=I.lookup(t._labels,a);else if(a.type!=="mouseout")return;s=t._hovered,t._hovered=n,sa(e,r,s,n,a)}}function ia(e,a){var t=e[h],r=t._listeners.click,s=r&&I.lookup(t._labels,a);s&&j(e,r,s,a)}var oa={id:"datalabels",defaults:ea,beforeInit:function(e){e[h]={_actives:[]}},beforeUpdate:function(e){var a=e[h];a._listened=!1,a._listeners={},a._datasets=[],a._labels=[]},afterDatasetUpdate:function(e,a,t){var r=a.index,s=e[h],n=s._datasets[r]=[],i=e.isDatasetVisible(r),o=e.data.datasets[r],d=ra(o,t),l=a.meta.data||[],u=e.ctx,c,$,W,V,U,G,M,S;for(u.save(),c=0,W=l.length;c<W;++c)if(M=l[c],M[h]=[],i&&M&&e.getDataVisibility(c)&&!M.skip)for($=0,V=d.labels.length;$<V;++$)U=d.labels[$],G=U._key,S=new tt(U,u,M,c),S.$groups={_set:r,_key:G||rt},S.$context={active:!1,chart:e,dataIndex:c,dataset:o,datasetIndex:r},S.update(S.$context),M[h].push(S),n.push(S);u.restore(),R(s._listeners,d.listeners,{merger:function(T,z,st){z[T]=z[T]||{},z[T][a.index]=st[T],s._listened=!0}})},afterUpdate:function(e){e[h]._labels=I.prepare(e[h]._datasets)},afterDatasetsDraw:function(e){I.draw(e,e[h]._labels)},beforeEvent:function(e,a){if(e[h]._listened){var t=a.event;switch(t.type){case"mousemove":case"mouseout":na(e,t);break;case"click":ia(e,t);break}}},afterEvent:function(e){var a=e[h],t=a._actives,r=a._actives=e.getActiveElements(),s=E.arrayDiff(t,r),n,i,o,d,l,u,c;for(n=0,i=s.length;n<i;++n)if(l=s[n],l[1])for(c=l[0].element[h]||[],o=0,d=c.length;o<d;++o)u=c[o],u.$context.active=l[1]===1,u.update(u.$context);(a._dirty||s.length)&&(I.update(a._labels),e.render()),delete a._dirty}};const la=v("canvas",{id:"ordersChart"},null,-1),da=[la],ua=y({__name:"OrdersChart",props:{data:{}},setup(e){const a=e;let t=null;const r=x(()=>({type:"bar",data:{labels:a.data.testsOrders.map(s=>s.label),datasets:[{label:"Tests Orders",data:a.data.testsOrders.map(s=>s.count)},{label:"Packages Orders",data:a.data.packagesOrders.map(s=>s.count)},{label:"Services Orders",data:a.data.servicesOrders.map(s=>s.count)},{label:"Total Orders",data:a.data.totalOrders.map(s=>s.count),type:"line"}]},plugins:[oa],options:{responsive:!0,interaction:{mode:"index"},scales:{x:{stacked:!0},y:{stacked:!0}},plugins:{title:{display:!0,text:"Orders Chart"}}}}));return m(()=>{t=new b(document.getElementById("ordersChart"),r.value)}),w(a,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),g("div",null,da))}}),ca=v("canvas",{id:"topRegistrationUsers"},null,-1),pa=[ca],va=y({__name:"TopRegistrationUsers",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:a.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:a.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Top Registration Users"}}}}));return m(()=>{t=new b(document.getElementById("topRegistrationUsers"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,pa))}}),fa=v("canvas",{id:"profitStatistics"},null,-1),ha=[fa],_a=y({__name:"ProfitStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=x(()=>({type:"pie",data:{labels:["Income","Expenses"],datasets:[{data:[a.data.income,a.data.expenses]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Profit: ${a.data.profit?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("profitStatistics"),r.value)}),w(a,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),g("div",null,ha))}}),ya=v("canvas",{id:"expensesStatistics"},null,-1),ma=[ya],ga=y({__name:"ExpensesStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=n=>{const i=n/a.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(a.data.general)}% General`,`${r(a.data.rates)}% Rates`],datasets:[{data:[a.data.general,a.data.rates]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Expenses: ${a.data.total?.toLocaleString()??0}`}}}}));return m(()=>{t=new b(document.getElementById("expensesStatistics"),s.value)}),w(a,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),g("div",null,ma))}}),xa=v("canvas",{id:"transactionsStatistics"},null,-1),ba=[xa],wa=y({__name:"TransactionsStatistics",props:{data:{}},setup(e){const a=e;let t=null;const r=x(()=>({type:"pie",data:{labels:["Payment","Discount","Refund","Top-up","Expense"],datasets:[{data:[a.data.totalPayment,a.data.totalDiscount,a.data.totalRefund,a.data.totalTopUp,a.data.totalExpense]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Cash: ${a.data.cash?.toLocaleString()}`}}}}));return m(()=>{t=new b(document.getElementById("transactionsStatistics"),r.value)}),w(a,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),g("div",null,ba))}}),$a=v("canvas",{id:"transactionsChart"},null,-1),ka=[$a],Sa=y({__name:"TransactionsChart",props:{data:{}},setup(e){const a=e;let t=null;const r=x(()=>({type:"line",data:{labels:a.data.payment.map(s=>s.label),datasets:[{label:"Payment",data:a.data.payment.map(s=>s.count)},{label:"Discount",data:a.data.discount.map(s=>s.count)},{label:"Refund",data:a.data.refund.map(s=>s.count)},{label:"Top-up",data:a.data.topUp.map(s=>s.count)},{label:"Expense",data:a.data.expense.map(s=>s.count)},{label:"Profit",data:a.data.profit.map(s=>s.count)},{label:"Cash",data:a.data.cash.map(s=>s.count)}]},options:{responsive:!0,interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,text:"Transactions Chart"}}}}));return m(()=>{t=new b(document.getElementById("transactionsChart"),r.value)}),w(a,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),g("div",null,ka))}}),Ma={class:"flex items-center justify-between"},Pa=v("h1",null,"Dashboard",-1),Ca={class:"pr-1 h-[calc(100vh-9rem)] overflow-y-auto"},Ea={class:"grid grid-cols-12 gap-5"},La=y({__name:"Dashboard",setup(e){const{updateUrlQuery:a}=wt(),t=L(!0),r=L([]);m(async()=>s(location.search));const s=async n=>{const i=await a(n),{data:o}=await _t.get(`/api/dashboard?${i}`);r.value=o,t.value=!1};return(n,i)=>(_(),yt(nt,null,mt({header:A(()=>[v("div",Ma,[Pa,f(kt,{onChange:s})])]),_:2},[t.value?{name:"body",fn:A(()=>[v("div",{class:"h-[calc(100vh-8.6rem)] flex flex-col items-center justify-center gap-5"},[(_(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"w-24 animate-spin"},[v("path",{d:"M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"})])),v("span",{class:"text-4xl"},"Generating Dashboard...")])]),key:"1"}:{name:"body",fn:A(()=>[v("section",Ca,[v("div",Ea,[f(Pt,{data:r.value.visitsStatistics,class:"col-span-3 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(It,{data:r.value.visitsChart,class:"col-span-6 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(va,{data:r.value.topRegistrationUsers,class:"col-span-3 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(Bt,{data:r.value.testsStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(Dt,{data:r.value.packagesStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(Ut,{data:r.value.ordersStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(ua,{data:r.value.ordersChart,class:"col-span-12 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(wa,{data:r.value.transactionsStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(_a,{data:r.value.profitStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(ga,{data:r.value.expensesStatistics,class:"col-span-4 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"]),f(Sa,{data:r.value.transactionsChart,class:"col-span-12 flex items-center rounded-lg border border-gray-200 bg-gray-50 p-5 shadow-md"},null,8,["data"])])])]),key:"0"}]),1024))}});export{La as default};
