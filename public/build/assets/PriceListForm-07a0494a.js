import{d as D,f as E,e as F,u as M,g as m,x as O,Q as f,o as l,R as w,w as b,m as x,t as v,i as o,b as s,c as h,a as _,n as V,k as p,j as U,v as $,h as A,_ as R,a5 as T,a0 as j}from"./main-cee2eb24.js";import{b as k}from"./toggle-afba85dd.js";import{F as n}from"./formMode-f60a729f.js";import{s as z}from"./multiselect-97a39018.js";const Q=["onSubmit"],W={key:0,class:"mb-3 flex flex-wrap items-center"},q=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Branch",-1),G={key:0,class:"ml-24 w-full text-sm text-red-500"},H={class:"mb-3 flex flex-wrap items-center"},J=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Name",-1),K={key:0,class:"ml-24 w-full text-sm text-red-500"},X={class:"flex flex-wrap items-center"},Y=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Default",-1),Z=["disabled"],oe=D({__name:"PriceListForm",emits:["close"],setup(ee,{emit:C}){const y=E(),I=F(),d=M().user.branches,e=m({}),i=m(n.Create),u=m(!1),r=m({});O(()=>{d.length===1&&(e.value.branchId=d[0].id),y.path.endsWith("/edit")&&(i.value=n.Edit,P(y.params.id))});const P=async c=>{const{data:a}=await f.get(`/api/price-lists/${c}`);e.value=a.data},L=async()=>{u.value=!0;try{i.value===n.Create?await N():await S(),j.fire()}catch(c){r.value=c.response.data.errors??{}}u.value=!1},N=async()=>{await f.post("/api/price-lists",e.value),B()},S=async()=>{await f.patch(`/api/price-lists/${e.value.id}`,e.value),g()},B=()=>{e.value={branchId:e.value.branchId},r.value=[]},g=()=>{C("close"),I.back()};return(c,a)=>(l(),w(T,null,{header:b(()=>[x(v(i.value===o(n).Create?"Create New Price List":"Edit Price List"),1)]),body:b(()=>[s("form",{id:"form",onSubmit:A(L,["prevent","stop"])},[o(d).length>1?(l(),h("div",W,[q,_(o(z),{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.branchId=t),options:o(d),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:V(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(l(),h("p",G,v(r.value.branchId[0]),1)):p("",!0)])):p("",!0),s("div",H,[J,U(s("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.name=t),class:V(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[$,e.value.name]]),r.value.hasOwnProperty("name")?(l(),h("p",K,v(r.value.name[0]),1)):p("",!0)]),s("div",X,[Y,_(o(k),{modelValue:e.value.isDefault,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.isDefault=t),class:"flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500"},null,8,["modelValue"])])],40,Q)]),footer:b(()=>[s("button",{class:"mr-2 btn-blue",disabled:u.value,form:"form"},[_(R,{"is-loading":u.value},{default:b(()=>[x("Save")]),_:1},8,["is-loading"])],8,Z),s("button",{onClick:g,class:"btn-gray"},"Cancel"),i.value===o(n).Edit?(l(),w(o(k),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.isActive=t),class:"toggle:off:red ml-auto"},null,8,["modelValue"])):p("",!0)]),_:1}))}});export{oe as default};
