import{d as E,e as v,x as F,y as q,o as l,c as r,a as V,b as t,h as $,v as L,a0 as U,t as a,g as e,V as Y,F as D,a1 as O,w as S,ad as X,p as o,af as M,a2 as A,ag as H,s as G,R as T,k as R,n as Q,i as p,f as J,_ as Z,a4 as ee,Q as j,$ as z,X as te,r as se,U as ae,ae as oe,a3 as ne,T as ie,Y as le}from"./main-DNdNUUJ7.js";import{M as re}from"./Master-b_S4sXaO.js";import{_ as ce}from"./Paginator.vue_vue_type_script_setup_true_lang-ByzTMpQ9.js";import{u as de}from"./urlQueryManager-rKHuCRUp.js";import{u as ue,a as pe}from"./printService-Bcj_RmEK.js";import{i as me}from"./index.es-CdvJf4Rl.js";import{d as he}from"./datepickerPresets-BpsxgrFD.js";import{_ as ve}from"./BranchFilter.vue_vue_type_script_setup_true_lang-CgUfq7jM.js";import{A as _e}from"./ActivityLogSidebar-DQgEnTl4.js";import{P as x}from"./printTemplateType-BiK7zB0k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-K4eUN8Nz.js";const be={class:"relative flex-1 min-w-[11rem]"},fe={class:"label"},ge={class:"relative flex-1 min-w-[11rem]"},we={class:"label"},ye={class:"relative flex-1 min-w-[11rem]"},xe={class:"label"},Ce={class:"relative flex-1 min-w-[11rem]"},$e={class:"label"},ke={class:"relative"},Se={value:""},Pe=["value"],Ie={class:"label"},Ve={class:"relative flex-1 min-w-[14rem]"},Be={class:"label"},Me=E({__name:"PremaritalVisitsFilter",emits:["change"],setup(K,{emit:_}){const N=_,i=new URLSearchParams(location.search),g=v(""),d=v(""),w=v(""),b=v(""),c=v(""),C=v(""),u=v([null,null]);F(()=>P());const B=q(()=>u.value[0]===null||u.value[1]===null?"":`${u.value[0]}~${u.value[1]}`),P=()=>{d.value=i.get("visitNumber")??"",g.value=i.get("branchId")??"",w.value=i.get("status")??"",b.value=i.get("husbandName")??"",c.value=i.get("wifeName")??"",C.value=i.get("phoneNumber")??"",i.get("dateRange")&&(u.value=i.get("dateRange").split("~"))},k=()=>{let W=`branchId=${g.value}&visitNumber=${d.value}&husbandName=${b.value}&wifeName=${c.value}&phoneNumber=${C.value}&status=${w.value}&dateRange=${B.value}&page=1`;N("change",W)};return(W,m)=>(l(),r("div",X({class:"flex flex-wrap items-center justify-end gap-2 ms-auto"},W.$attrs),[V(ve,{modelValue:g.value,"onUpdate:modelValue":m[0]||(m[0]=s=>g.value=s),onChange:k},null,8,["modelValue"]),t("div",be,[$(t("input",{"onUpdate:modelValue":m[1]||(m[1]=s=>d.value=s),onKeyup:U(k,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,d.value]]),t("label",fe,a(e(o)("Registration Number")),1)]),t("div",ge,[$(t("input",{"onUpdate:modelValue":m[2]||(m[2]=s=>b.value=s),onKeyup:U(k,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,b.value]]),t("label",we,a(e(o)("Husband Name")),1)]),t("div",ye,[$(t("input",{"onUpdate:modelValue":m[3]||(m[3]=s=>c.value=s),onKeyup:U(k,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,c.value]]),t("label",xe,a(e(o)("Wife Name")),1)]),t("div",Ce,[$(t("input",{"onUpdate:modelValue":m[4]||(m[4]=s=>C.value=s),onKeyup:U(k,["enter"]),type:"text",class:"input-sm peer"},null,544),[[L,C.value]]),t("label",$e,a(e(o)("Phone Number")),1)]),t("div",ke,[$(t("select",{"onUpdate:modelValue":m[5]||(m[5]=s=>w.value=s),onChange:k,class:"input-sm peer"},[t("option",Se,a(e(o)("All")),1),(l(!0),r(D,null,O(e(M),s=>(l(),r("option",{value:s},a(e(o)(s.startCase())),9,Pe))),256))],544),[[Y,w.value]]),t("label",Ie,a(e(o)("Status")),1)]),t("div",Ve,[V(e(me),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:e(he),value:u.value,"onUpdate:value":m[6]||(m[6]=s=>u.value=s),onChange:k,class:"w-full peer","input-class":"input-sm pt-0.5"},{"icon-calendar":S(()=>[]),_:1},8,["shortcuts","value"]),t("label",Be,a(e(o)("Date")),1)])],16))}}),Ne={class:"grid grid-cols-1 gap-4"},We={class:"relative"},De={value:""},Le=["value"],Ue=["value"],ze=["value"],Ae={key:0,class:"text-sm text-red-500"},He=["disabled"],Te=E({__name:"PremaritalStatusModal",emits:["close"],setup(K,{emit:_}){const N=_,i=v(!1),g=v(!1),d=v([]),w=v(""),b=v({});F(()=>{A.on(H.Show,u=>{g.value=!0,d.value=u})}),G(()=>A.off(H.Show));const c=async()=>{i.value=!0;try{await j.patch(`/api/premarital/visits/${d.value}/status`,{status:w.value}),b.value={},z.fire(),C()}catch(u){b.value=u.response.data.errors??{}}i.value=!1},C=()=>{g.value=!1,w.value="",b.value={},N("close")};return(u,B)=>g.value?(l(),T(ee,{key:0},{header:S(()=>[R(a(e(o)("Change Visit Status")),1)]),body:S(()=>[t("form",{id:"form",onSubmit:J(c,["prevent","stop"])},[t("div",Ne,[t("div",We,[$(t("select",{"onUpdate:modelValue":B[0]||(B[0]=P=>w.value=P),class:Q(["input peer",{"border-red-500":b.value.hasOwnProperty("status")}])},[t("option",De,a(e(o)("Select status")),1),t("option",{value:e(M).Registered},a(e(o)("Registered")),9,Le),t("option",{value:e(M).Consulted},a(e(o)("Consulted")),9,Ue),t("option",{value:e(M).Tested},a(e(o)("Tested")),9,ze)],2),[[Y,w.value]]),t("label",{class:Q(["label",{"text-red-500":b.value.hasOwnProperty("status")}])},a(e(o)("Status")),3),b.value.hasOwnProperty("status")?(l(),r("p",Ae,a(b.value.status[0]),1)):p("",!0)])])],32)]),footer:S(()=>[t("button",{class:"me-2 btn-blue",disabled:i.value,form:"form"},[V(Z,{"is-loading":i.value},{default:S(()=>[R(a(e(o)("Save")),1)]),_:1},8,["is-loading"])],8,He),t("button",{onClick:C,class:"btn-gray"},a(e(o)("Cancel")),1)]),_:1})):p("",!0)}}),Re={class:"mb-5 flex items-start gap-1"},je=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"h-4 w-4"},[t("path",{d:"M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"})],-1),Ee={class:"whitespace-nowrap font-semibold"},Fe={class:"w-full"},Ke={class:"sticky top-0 z-10 ltr:text-left rtl:text-right"},Qe={class:"bg-gray-600 p-2 font-semibold text-white rounded-ss"},Ye={class:"bg-gray-600 p-2 font-semibold text-white"},Oe={class:"bg-gray-600 p-2 font-semibold text-white"},qe={class:"bg-gray-600 p-2 font-semibold text-white"},Xe={class:"bg-gray-600 p-2 text-center font-semibold text-white"},Ge={class:"bg-gray-600 p-2 text-center font-semibold text-white"},Je={class:"bg-gray-600 p-2 font-semibold text-white"},Ze={class:"bg-gray-600 p-2 font-semibold text-white"},et={key:1,class:"bg-gray-600 p-2 font-semibold text-white rounded-se"},tt={class:"transition even:bg-gray-100"},st={class:"border border-gray-200 p-1"},at={class:"border border-gray-200 p-1"},ot={class:"border border-gray-200 p-1"},nt={class:"border border-gray-200 p-1"},it={class:"border border-gray-200 p-1"},lt={class:"flex flex-wrap items-center justify-center gap-1"},rt=["disabled","onClick"],ct=["disabled","onClick"],dt=["disabled","onClick"],ut=["disabled","onClick"],pt={class:"border border-gray-200 p-1"},mt={class:"flex flex-wrap items-center justify-center gap-1"},ht=["disabled","onClick"],vt=["disabled","onClick"],_t=["disabled","onClick"],bt={class:"border border-gray-200 p-1"},ft={class:"border border-gray-200 p-1"},gt={key:1,class:"border border-gray-200 px-2 py-1 text-center"},wt={class:"flex justify-center gap-2"},yt=t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),xt=["onClick"],Ct=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 w-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})],-1),$t=[Ct],kt=["onClick"],St=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5 cursor-pointer text-red-500"},[t("path",{d:"M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM99.5 144.8C77.15 176.1 64 214.5 64 256C64 362 149.1 448 256 448C297.5 448 335.9 434.9 367.2 412.5L99.5 144.8zM448 256C448 149.1 362 64 256 64C214.5 64 176.1 77.15 144.8 99.5L412.5 367.2C434.9 335.9 448 297.5 448 256V256z"})],-1),Pt=[St],It=["onClick"],Vt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[t("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),Bt=[Vt],Et=E({__name:"PremaritalVisits",setup(K){const{getDefaultTemplate:_}=ue(),{updateUrlQuery:N}=de(),{hasPermissionTo:i,hasAnyPermission:g}=ie();te();const d=pe(),w=v([]),b=v({}),c=v([]),C=v(0);F(()=>{C.value=document.getElementById("filter").offsetHeight,u(location.search)});const u=async s=>{const f=await N(s),{data:y}=await j.get(`/api/premarital/visits?${f}`);w.value=y.data,b.value=y.meta},B=async(s,f)=>{c.value[s.id]=!0;const y=_(x.VisitBarcode,s.branchId).printer;await d.visitBarcode(s.id,{printMode:f,printer:y,fileName:`${s.patient.name}-visit-barcode`}),z.fire(),c.value[s.id]=!1},P=async(s,f,y)=>{c.value[`${s.id}-${f}`]=!0;let I;f==="sampleWise"?I=_(x.SampleBarcode,s.branchId).printer:I=_(x.SampleBarcodeDepWise,s.branchId).printer,await d.sampleBarcodes(s.id,f,{printMode:y,printer:I,fileName:`${s.patient.name}-sample-barcodes`}),z.fire(),c.value[`${s.id}-${f}`]=!1},k=async(s,f)=>{c.value[s.invoice.id]=!0;const y=_(x.Invoice,s.branchId).printer;await d.invoice(s.invoice.id,{printMode:f,printer:y,fileName:`${s.patient.name}-invoice`}),z.fire(),c.value[s.invoice.id]=!1},W=s=>i("PremaritalVisit.cancel")?![M.Authorized,M.Printed,M.Canceled].includes(s.status):!1,m=async s=>{const{isConfirmed:f}=await le.fire();f&&(await j.post(`/api/premarital/visits/${s.id}/cancel`),u(location.search))};return(s,f)=>{const y=se("router-link"),I=ae("tip");return l(),r(D,null,[V(re,null,{header:S(()=>[R(a(e(o)("Premarital Visits")),1)]),body:S(()=>[t("div",Re,[e(i)("PremaritalVisit.create")?(l(),T(y,{key:0,to:"/premarital/visits/create",class:"inline-flex items-center gap-1 btn-blue"},{default:S(()=>[je,t("span",Ee,a(e(o)("Create New Visit")),1)]),_:1})):p("",!0),V(Me,{id:"filter",onChange:u})]),t("section",{class:"overflow-y-auto pe-1",style:oe(`height: calc(100vh - 13.3rem - ${C.value}px)`)},[t("table",Fe,[t("thead",null,[t("tr",Ke,[t("th",Qe,a(e(o)("No.")),1),t("th",Ye,a(e(o)("Husband Name")),1),t("th",Oe,a(e(o)("Wife Name")),1),t("th",qe,a(e(o)("Status")),1),e(g)("Invoice.print","Sample.print","Visit.printBarcode")?(l(),r(D,{key:0},[t("th",Xe,a(e(o)("Husband Print")),1),t("th",Ge,a(e(o)("Wife Print")),1)],64)):p("",!0),t("th",Je,a(e(o)("Date")),1),t("th",Ze,a(e(o)("Branch")),1),e(g)("PremaritalVisit.update","PremaritalVisit.updateStatus","PremaritalVisit.cancel","ActivityLog.list")?(l(),r("th",et)):p("",!0)])]),t("tbody",null,[(l(!0),r(D,null,O(w.value,n=>(l(),r("tr",tt,[t("td",st,a(n.number),1),t("td",at,a(n.husbandInformation.name),1),t("td",ot,a(n.wifeInformation.name),1),t("td",nt,a(e(o)(n.status.startCase())),1),e(g)("Invoice.print","Sample.print")?(l(),r(D,{key:0},[t("td",it,[t("div",lt,[e(i)("Visit.printBarcode")&&e(_)(e(x).VisitBarcode,n.branchId)?(l(),r("button",{key:0,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[n.husbandVisitId],onClick:h=>B(n.husbandVisit,e(d).detectPrintMode(h))},a(e(o)("Visit barcode")),9,rt)):p("",!0),e(i)("Sample.print")&&e(_)(e(x).SampleBarcodeDepWise,n.branchId)?(l(),r("button",{key:1,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[`${n.husbandVisitId}-departmentWise`],onClick:h=>P(n.husbandVisit,"departmentWise",e(d).detectPrintMode(h))},a(e(o)("Dep. wise")),9,ct)):p("",!0),e(i)("Sample.print")&&e(_)(e(x).SampleBarcode,n.branchId)?(l(),r("button",{key:2,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[`${n.husbandVisitId}-sampleWise`],onClick:h=>P(n.husbandVisit,"sampleWise",e(d).detectPrintMode(h))},a(e(o)("Sample wise")),9,dt)):p("",!0),e(i)("Invoice.print")&&e(_)(e(x).Invoice,n.branchId)?(l(),r("button",{key:3,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[n.husbandVisit.invoice.id],onClick:h=>k(n.husbandVisit,e(d).detectPrintMode(h))},a(e(o)("Invoice")),9,ut)):p("",!0)])]),t("td",pt,[t("div",mt,[e(i)("Visit.printBarcode")&&e(_)(e(x).VisitBarcode,n.branchId)?(l(),r("button",{key:0,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[n.wifeVisitId],onClick:h=>B(n.wifeVisit,e(d).detectPrintMode(h))},a(e(o)("Visit barcode")),9,ht)):p("",!0),e(i)("Sample.print")&&e(_)(e(x).SampleBarcodeDepWise,n.branchId)?(l(),r("button",{key:1,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[`${n.wifeVisitId}-departmentWise`],onClick:h=>P(n.wifeVisit,"departmentWise",e(d).detectPrintMode(h))},a(e(o)("Dep. wise")),9,vt)):p("",!0),e(i)("Sample.print")&&e(_)(e(x).SampleBarcode,n.branchId)?(l(),r("button",{key:2,class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:c.value[`${n.wifeVisitId}-sampleWise`],onClick:h=>P(n.wifeVisit,"sampleWise",e(d).detectPrintMode(h))},a(e(o)("Sample wise")),9,_t)):p("",!0)])])],64)):p("",!0),t("td",bt,a(n.date),1),t("td",ft,a(n.branch.name),1),e(g)("PremaritalVisit.update","PremaritalVisit.updateStatus","PremaritalVisit.cancel","ActivityLog.list")?(l(),r("td",gt,[t("div",wt,[e(i)("PremaritalVisit.update")?$((l(),T(y,{key:0,to:`/premarital/visits/${n.id}/edit`,class:"cursor-pointer text-orange-500"},{default:S(()=>[yt]),_:2},1032,["to"])),[[I,e(o)("Edit")]]):p("",!0),e(i)("PremaritalVisit.updateStatus")?$((l(),r("button",{key:1,onClick:h=>e(A).emit(e(H).Show,n.id),class:"cursor-pointer text-blue-500"},$t,8,xt)),[[I,e(o)("Change Status")]]):p("",!0),W(n)?$((l(),r("button",{key:2,onClick:h=>m(n),class:"cursor-pointer text-gray-600"},Pt,8,kt)),[[I,e(o)("Cancel")]]):p("",!0),e(i)("ActivityLog.list")?$((l(),r("button",{key:3,onClick:h=>e(A).emit(e(ne).Show,n.id),class:"cursor-pointer text-gray-600"},Bt,8,It)),[[I,e(o)("View Activities")]]):p("",!0)])])):p("",!0)]))),256))])])],4)]),_:1}),V(ce,{data:b.value,onChange:f[0]||(f[0]=n=>u(`page=${n}`)),class:"mt-3"},null,8,["data"]),V(Te,{onClose:u}),V(_e)],64)}}});export{Et as default};
