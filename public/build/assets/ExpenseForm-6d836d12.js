import{d as S,u as B,e as u,x as N,Q as h,o,R as $,w as c,k as g,t as i,g as p,b as s,c as m,a as _,n as x,i as b,h as M,v as D,f as F,_ as R,a9 as T,m as U,l as A,Z as z}from"./main-56f58ed8.js";import{s as L}from"./multiselect-167e14f5.js";import{F as f}from"./formMode-f60a729f.js";import{_ as Q}from"./CurrencyInput.vue_vue_type_script_setup_true_lang-5457422b.js";const W=["onSubmit"],Z={key:0,class:"flex flex-wrap items-center mb-3"},j=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),q={key:0,class:"ml-24 w-full text-red-500 text-sm"},G={class:"flex flex-wrap items-center mb-3"},H=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Amount",-1),J={key:0,class:"w-full ml-24 text-red-500 text-sm"},K={class:"col-span-2 flex flex-wrap items-start"},X=s("span",{class:"w-full p-1 font-semibold"},"Details",-1),Y={key:0,class:"w-full text-red-500 text-sm"},ee=["disabled"],le=S({__name:"ExpenseForm",emits:["close"],setup(ae,{emit:k}){const y=U(),V=A(),l=B().user.branches,e=u({}),v=u(f.Create),n=u(!1),a=u({});N(()=>{l.length===1&&(e.value.branchId=l[0].id),y.path.endsWith("/edit")&&(v.value=f.Edit,C(y.params.id))});const C=async d=>{const{data:t}=await h.get(`/api/expenses/${d}`);e.value=t.data},I=async()=>{n.value=!0;try{v.value===f.Create?await E():await O(),z.fire()}catch(d){a.value=d.response.data.errors??{}}n.value=!1},E=async()=>{await h.post("/api/expenses",e.value),P()},O=async()=>{await h.patch(`/api/expenses/${e.value.id}`,e.value),w()},P=()=>{e.value={branchId:e.value.branchId},a.value=[]},w=()=>{k("close"),V.back()};return(d,t)=>(o(),$(T,null,{header:c(()=>[g(i(v.value===p(f).Create?"Create New Expense":"Edit Expense"),1)]),body:c(()=>[s("form",{id:"form",onSubmit:F(I,["prevent","stop"])},[p(l).length>1?(o(),m("div",Z,[j,_(p(L),{modelValue:e.value.branchId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.value.branchId=r),options:p(l),searchable:!0,"value-prop":"id","track-by":"name",label:"name","can-deselect":!1,"can-clear":!1,class:x(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":a.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),a.value.hasOwnProperty("branchId")?(o(),m("p",q,i(a.value.branchId[0]),1)):b("",!0)])):b("",!0),s("div",G,[H,_(Q,{modelValue:e.value.amount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.value.amount=r),class:x(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":a.value.hasOwnProperty("amount")}])},null,8,["modelValue","class"]),a.value.hasOwnProperty("amount")?(o(),m("p",J,i(a.value.amount[0]),1)):b("",!0)]),s("div",K,[X,M(s("textarea",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.value.details=r),class:x(["flex-1 p-2 border border-gray-300 rounded focus:border-blue-500",{"!border-red-500":a.value.hasOwnProperty("details")}])},null,2),[[D,e.value.details]]),a.value.hasOwnProperty("details")?(o(),m("p",Y,i(a.value.details[0]),1)):b("",!0)])],40,W)]),footer:c(()=>[s("button",{class:"btn-blue mr-2",disabled:n.value,form:"form"},[_(R,{"is-loading":n.value},{default:c(()=>[g("Save")]),_:1},8,["is-loading"])],8,ee),s("button",{onClick:w,class:"btn-gray"},"Cancel")]),_:1}))}});export{le as default};
