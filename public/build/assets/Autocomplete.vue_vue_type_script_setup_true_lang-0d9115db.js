import{d as k,e as u,x as B,s as I,y as $,o as r,c as i,b as E,ah as K,T as c,n as d,ai as S,g as q,F as H,V as M,i as z,f as A,t as L,Q as _}from"./main-56f58ed8.js";const F=["value","onKeyup","onKeydown"],N=["onMouseover"],D={inheritAttrs:!1},T=k({...D,__name:"Autocomplete",props:{modelValue:null,endpoint:null,query:null,limit:null,label:null,maxHeight:null,parentClasses:null,listClasses:null},emits:["update:modelValue","select"],setup(a,{emit:h}){const n=a,l=u([]),e=u(-1),m=u(0),v=u(null);B(()=>{const t=document.querySelector(".autocomplete input");m.value=t.offsetHeight,document.addEventListener("mousedown",p)}),I(()=>document.removeEventListener("mousedown",p));const p=t=>v.value=t.target,w=$(()=>({"max-height":(n.maxHeight??200)+"px",top:m.value+"px"})),x=async()=>{if(e.value=-1,n.modelValue===""){s();return}const{data:t}=await _.get(`${n.endpoint}&${n.query}=${n.modelValue}`);l.value=n.limit?t.data.splice(0,n.limit):t.data},C=()=>{v.value!==document.querySelector("li.selected")&&s()},V=()=>{e.value<l.value.length-1&&e.value++},b=()=>{e.value>0&&e.value--},y=()=>{if(l.value.length!==0){if(e.value===-1){s();return}h("select",l.value[e.value]),s()}},s=()=>{l.value=[]};return(t,f)=>(r(),i("div",{class:d(["autocomplete relative",a.parentClasses])},[E("input",K({type:"text",value:a.modelValue},t.$attrs,{class:{"!rounded-b-none":l.value.length!==0},onInput:f[0]||(f[0]=o=>t.$emit("update:modelValue",o.target.value)),onKeyup:[c(x,["space"]),c(V,["down"]),c(b,["up"])],onKeydown:c(A(y,["prevent"]),["enter"]),onBlur:C}),null,16,F),l.value.length!==0?(r(),i("ul",{key:0,class:d(["absolute inset-x-0 bg-white shadow rounded-b overflow-y-auto z-50",a.listClasses]),style:S(q(w))},[(r(!0),i(H,null,M(l.value,(o,g)=>(r(),i("li",{key:o.id,onMouseover:P=>e.value=g,onClick:y,class:d(["py-1 px-2 cursor-pointer",{"selected bg-gray-100":g===e.value}])},L(o[a.label]),43,N))),128))],6)):z("",!0)],2))}});export{T as _};
