import{d as R,e as r,u as U,x as A,Q as m,o as g,R as y,w as p,k as I,t as B,g as o,b as s,c as E,a as v,i as C,f as L,_ as M,a4 as T,m as W,l as j,aI as H,$ as Q}from"./main-BgbWFIXK.js";import{b as w}from"./toggle-CP_W0i88.js";import{s as q}from"./multiselect-DeMhawmc.js";import{F as n}from"./formMode-Bz--3d4P.js";import{_ as z}from"./BranchSelect.vue_vue_type_script_setup_true_lang-ChkyAztq.js";const G={key:0,class:"relative"},J={class:"relative"},K=s("label",{class:"label"},"Logo",-1),O={class:"relative"},X=s("label",{class:"label"},"Header",-1),Y={class:"relative"},Z=s("label",{class:"label"},"Footer",-1),ee={class:"relative"},ae=s("label",{class:"label"},"Watermark",-1),te={class:"relative"},se=s("label",{class:"label"},"Departments",-1),le={class:"relative"},oe=s("label",{class:"label"},"Default",-1),re=["disabled"],pe=R({__name:"PrintImagesForm",emits:["close"],setup(ne,{emit:k}){const $=k,h=W(),x=j(),t=r({}),f=U().user.branches,_=r([]),i=r(n.Create),d=r(!1),u=r({});A(()=>{f.length===1&&(t.value.branchId=f[0].id,b()),h.path.endsWith("/edit")&&(i.value=n.Edit,D(h.params.id))});const D=async l=>{const{data:e}=await m.get(`/api/print-images/${l}`);t.value=e.data,b()},b=async()=>{const{data:l}=await m.get(`/api/departments/list?branchId=${t.value.branchId}`);_.value=l.data},c=(l,e)=>{if(!l.target.files[0])t.value[e]="";else{const a=new FileReader;a.readAsDataURL(l.target.files[0]),a.onload=()=>t.value[e]=a.result}},F=async()=>{d.value=!0;try{i.value===n.Create?await S():await N(),H().fetch(),u.value={},Q.fire()}catch(l){u.value=l.response.data.errors??{}}d.value=!1},S=async()=>{await m.post("/api/print-images",t.value),P()},N=async()=>{await m.patch(`/api/print-images/${t.value.id}`,t.value),V()},P=()=>{t.value={branchId:t.value.branchId},u.value=[]},V=()=>{$("close"),x.back()};return(l,e)=>(g(),y(T,null,{header:p(()=>[I(B(i.value===o(n).Create?"Create New Print Images":"Edit Print Images"),1)]),body:p(()=>[s("form",{id:"form",onSubmit:L(F,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[o(f).length>1?(g(),E("div",G,[v(z,{modelValue:t.value.branchId,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.branchId=a),error:u.value.branchId,onSelect:e[1]||(e[1]=a=>{b(),t.value.departments=[]})},null,8,["modelValue","error"])])):C("",!0),s("div",J,[s("input",{type:"file",accept:"image/*",onChange:e[2]||(e[2]=a=>c(a,"logo")),class:"file peer"},null,32),K]),s("div",O,[s("input",{type:"file",accept:"image/*",onChange:e[3]||(e[3]=a=>c(a,"header")),class:"file peer"},null,32),X]),s("div",Y,[s("input",{type:"file",accept:"image/*",onChange:e[4]||(e[4]=a=>c(a,"footer")),class:"file peer"},null,32),Z]),s("div",ee,[s("input",{type:"file",accept:"image/*",onChange:e[5]||(e[5]=a=>c(a,"watermark")),class:"file peer"},null,32),ae]),s("div",te,[v(o(q),{modelValue:t.value.departments,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.departments=a),mode:"tags",options:_.value,searchable:!0,object:!0,"value-prop":"id",label:"name","track-by":"searchableForm",class:"px-0 input peer"},null,8,["modelValue","options"]),se]),s("div",le,[oe,v(o(w),{modelValue:t.value.isDefault,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.isDefault=a),class:"input peer pt-2.5"},null,8,["modelValue"])])],32)]),footer:p(()=>[s("button",{class:"me-2 btn-blue",disabled:d.value,form:"form"},[v(M,{"is-loading":d.value},{default:p(()=>[I("Save")]),_:1},8,["is-loading"])],8,re),s("button",{onClick:V,class:"btn-gray"},"Cancel"),i.value===o(n).Edit?(g(),y(o(w),{key:0,modelValue:t.value.isActive,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.isActive=a),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):C("",!0)]),_:1}))}});export{pe as default};
