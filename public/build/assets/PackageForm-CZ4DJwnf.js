import{d as M,e as d,u as A,x as R,Q as p,o as r,R as C,w as b,k as I,t as h,g as n,b as s,c as f,a as _,i,h as w,v as k,n as u,f as D,_ as j,a4 as z,m as L,l as Q,$ as W}from"./main-DmoZ1fz4.js";import{s as q}from"./multiselect-DAhRltj6.js";import{b as O}from"./toggle-DyRQkDOQ.js";import{F as c}from"./formMode-Bz--3d4P.js";import{_ as G}from"./BranchSelect.vue_vue_type_script_setup_true_lang-D_pdW9WT.js";const H={key:0,class:"relative"},J={class:"relative"},K={key:0,class:"text-sm text-red-500"},X={class:"relative"},Y={key:0,class:"text-sm text-red-500"},Z={class:"relative"},ee={key:0,class:"text-sm text-red-500"},ae={class:"relative"},te=s("label",{class:"label"},"Premarital",-1),se={class:"relative"},le=s("label",{class:"label"},"Notes",-1),oe=["disabled"],ve=M({__name:"PackageForm",emits:["close"],setup(re,{emit:$}){const N=$,V=L(),U=Q(),e=d({}),g=A().user.branches,x=d([]),v=d(c.Create),m=d(!1),t=d({});R(()=>{g.length===1&&(e.value.branchId=g[0].id,y()),V.path.endsWith("/edit")&&(v.value=c.Edit,S(V.params.id))});const S=async o=>{const{data:a}=await p.get(`/api/packages/${o}`);e.value=a.data,y()},y=async()=>{const{data:o}=await p.get(`/api/tests/list?branchId=${e.value.branchId}`);x.value=o.data},F=async()=>{m.value=!0;try{v.value===c.Create?await T():await B(),t.value={},W.fire()}catch(o){t.value=o.response.data.errors??{}}m.value=!1},T=async()=>{await p.post("/api/packages",e.value),E()},B=async()=>{await p.patch(`/api/packages/${e.value.id}`,e.value),P()},E=()=>{e.value={branchId:e.value.branchId},t.value=[]},P=()=>{N("close"),U.back()};return(o,a)=>(r(),C(z,null,{header:b(()=>[I(h(v.value===n(c).Create?"Create New Package":"Edit Package"),1)]),body:b(()=>[s("form",{id:"form",onSubmit:D(F,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[n(g).length>1?(r(),f("div",H,[_(G,{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.branchId=l),error:t.value.branchId,onSelect:y,onChange:a[1]||(a[1]=l=>e.value.tests=[])},null,8,["modelValue","error"])])):i("",!0),s("div",J,[w(s("input",{"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.name=l),class:u(["input peer",{"border-red-500":t.value.hasOwnProperty("name")}])},null,2),[[k,e.value.name]]),s("label",{class:u(["label",{"text-red-500":t.value.hasOwnProperty("name")}])},"Name",2),t.value.hasOwnProperty("name")?(r(),f("p",K,h(t.value.name[0]),1)):i("",!0)]),s("div",X,[w(s("input",{"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.code=l),class:u(["input peer",{"border-red-500":t.value.hasOwnProperty("code")}])},null,2),[[k,e.value.code]]),s("label",{class:u(["label",{"text-red-500":t.value.hasOwnProperty("code")}])},"Code",2),t.value.hasOwnProperty("code")?(r(),f("p",Y,h(t.value.code[0]),1)):i("",!0)]),s("div",Z,[_(n(q),{modelValue:e.value.tests,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.tests=l),mode:"tags",options:x.value,searchable:!0,object:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:u(["px-0 input peer",{"border-red-500":t.value.hasOwnProperty("tests")}])},null,8,["modelValue","options","class"]),s("label",{class:u(["label",{"text-red-500":t.value.hasOwnProperty("tests")}])},"Tests",2),t.value.hasOwnProperty("tests")?(r(),f("p",ee,h(t.value.tests[0]),1)):i("",!0)]),s("div",ae,[_(n(O),{modelValue:e.value.isPremarital,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.isPremarital=l),class:"input peer pt-2.5"},null,8,["modelValue"]),te]),s("div",se,[w(s("textarea",{"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.notes=l),rows:"4",class:"py-2 input peer"},null,512),[[k,e.value.notes]]),le])],32)]),footer:b(()=>[s("button",{class:"me-2 btn-blue",disabled:m.value,form:"form"},[_(j,{"is-loading":m.value},{default:b(()=>[I("Save")]),_:1},8,["is-loading"])],8,oe),s("button",{onClick:P,class:"btn-gray"},"Cancel"),v.value===n(c).Edit?(r(),C(n(O),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.isActive=l),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):i("",!0)]),_:1}))}});export{ve as default};
