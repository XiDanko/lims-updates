import{d as M,e as u,u as A,x as R,Q as f,o as l,R as C,w as g,k as I,t as c,g as o,b as s,c as i,a as h,n as y,i as n,h as _,v as x,f as D,_ as j,a9 as z,m as L,l as Q,Z as W}from"./main-56f58ed8.js";import{s as S}from"./multiselect-167e14f5.js";import{b as O}from"./toggle-876d3de4.js";import{F as b}from"./formMode-f60a729f.js";const Z=["onSubmit"],q={key:0,class:"flex flex-wrap items-center mb-3"},G=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),H={key:0,class:"ml-24 w-full text-red-500 text-sm"},J={class:"flex flex-wrap items-center mb-3"},K=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Code",-1),X={key:0,class:"w-full ml-24 text-red-500 text-sm"},Y={class:"flex flex-wrap items-center mb-3"},ee=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),ae={key:0,class:"w-full ml-24 text-red-500 text-sm"},se={class:"flex flex-wrap items-center mb-3"},re=s("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Tests",-1),te={key:0,class:"ml-24 w-full text-red-500 text-sm"},oe={class:"flex flex-wrap items-center mb-3"},le=s("span",{class:"p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Premarital Screening Package",-1),de={class:"flex flex-wrap items-center"},ne=s("span",{class:"w-full"},"Notes",-1),ue=["disabled"],ve=M({__name:"PackageForm",emits:["close"],setup(ce,{emit:N}){const k=L(),U=Q(),e=u({}),m=A().user.branches,P=u([]),p=u(b.Create),v=u(!1),r=u({});R(()=>{m.length===1&&(e.value.branchId=m[0].id,w()),k.path.endsWith("/edit")&&(p.value=b.Edit,F(k.params.id))});const F=async d=>{const{data:a}=await f.get(`/api/packages/${d}`);e.value=a.data,w()},w=async()=>{const{data:d}=await f.get(`/api/tests/list?branchId=${e.value.branchId}`);P.value=d.data},$=async()=>{v.value=!0;try{p.value===b.Create?await B():await T(),W.fire()}catch(d){r.value=d.response.data.errors??{}}v.value=!1},B=async()=>{await f.post("/api/packages",e.value),E()},T=async()=>{await f.patch(`/api/packages/${e.value.id}`,e.value),V()},E=()=>{e.value={branchId:e.value.branchId},r.value=[]},V=()=>{N("close"),U.back()};return(d,a)=>(l(),C(z,null,{header:g(()=>[I(c(p.value===o(b).Create?"Create New Package":"Edit Package"),1)]),body:g(()=>[s("form",{id:"form",onSubmit:D($,["prevent","stop"])},[o(m).length>1?(l(),i("div",q,[G,h(o(S),{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.branchId=t),options:o(m),onSelect:w,onChange:a[1]||(a[1]=t=>e.value.tests=[]),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(l(),i("p",H,c(r.value.branchId[0]),1)):n("",!0)])):n("",!0),s("div",J,[K,_(s("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.code=t),class:y(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[x,e.value.code]]),r.value.hasOwnProperty("code")?(l(),i("p",X,c(r.value.code[0]),1)):n("",!0)]),s("div",Y,[ee,_(s("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.name=t),class:y(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[x,e.value.name]]),r.value.hasOwnProperty("name")?(l(),i("p",ae,c(r.value.name[0]),1)):n("",!0)]),s("div",se,[re,h(o(S),{modelValue:e.value.tests,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.tests=t),mode:"tags",options:P.value,searchable:!0,object:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("tests")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("tests")?(l(),i("p",te,c(r.value.tests[0]),1)):n("",!0)]),s("div",oe,[le,h(o(O),{modelValue:e.value.isPremaritalScreeningPackage,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.isPremaritalScreeningPackage=t),class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,8,["modelValue"])]),s("div",de,[ne,_(s("textarea",{"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.notes=t),rows:"4",class:"flex-1 p-2 border border-gray-300 rounded focus:border-blue-500"},null,512),[[x,e.value.notes]])])],40,Z)]),footer:g(()=>[s("button",{class:"btn-blue mr-2",disabled:v.value,form:"form"},[h(j,{"is-loading":v.value},{default:g(()=>[I("Save")]),_:1},8,["is-loading"])],8,ue),s("button",{onClick:V,class:"btn-gray"},"Cancel"),p.value===o(b).Edit?(l(),C(o(O),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.isActive=t),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):n("",!0)]),_:1}))}});export{ve as default};
