import{d as V,e as f,x as B,Q as $,o as s,c as a,a as p,g as l,i,b as t,h as C,v as A,a0 as L,T as S,u as F,y as D,r as T,U as N,w as v,k as P,R as M,t as m,F as q,a2 as U,a3 as Q}from"./main-BgbWFIXK.js";import{M as E}from"./Master-Bb3753-s.js";import{s as R}from"./multiselect-DeMhawmc.js";import{_ as j}from"./BranchFilter.vue_vue_type_script_setup_true_lang-Cg0zFa3A.js";import{u as K}from"./urlQueryManager-CZwFgJ7t.js";import{_ as G}from"./Paginator.vue_vue_type_script_setup_true_lang-CkZcUYNX.js";import{A as J}from"./ActivityLogSidebar-DZ3mPV78.js";import{d as O}from"./vuedraggable.umd-DoPE7h08.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue.runtime.esm-bundler-DOsm6OJ3.js";const W={class:"flex flex-wrap items-center gap-2 ms-auto"},X={key:0,class:"relative flex-1 min-w-[10rem]"},Y=t("label",{class:"label"},"Department",-1),Z={class:"relative flex-1 min-w-[11rem]"},tt=t("label",{class:"label"},"Name / Code / Short Form",-1),et=V({__name:"TestsFilter",emits:["change"],setup(I,{emit:h}){const k=h,g=new URLSearchParams(location.search),{hasPermissionTo:u}=S(),w=f(""),r=f(""),_=f(""),x=f([]);B(()=>{y(),b()});const y=()=>{w.value=g.get("q")??"",_.value=g.get("departmentId")??"",r.value=g.get("branchId")??""},b=async()=>{if(!u("Department.list"))return;const{data:o}=await $.get(`/api/departments/list?branchId=${r.value}`);x.value=o.data},z=o=>{_.value=o??"",d()},d=()=>{const o=`?branchId=${r.value}&departmentId=${_.value}&q=${w.value}&page=1`;k("change",o)};return(o,n)=>(s(),a("div",W,[p(j,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=c=>r.value=c),onChange:n[1]||(n[1]=c=>{d(),b()})},null,8,["modelValue"]),l(u)("Department.list")?(s(),a("div",X,[p(l(R),{"model-value":_.value,options:x.value,"value-prop":"id","track-by":"searchableForm",label:"name",searchable:!0,onChange:z,class:"input-sm peer"},null,8,["model-value","options"]),Y])):i("",!0),t("div",Z,[C(t("input",{"onUpdate:modelValue":n[2]||(n[2]=c=>w.value=c),onKeyup:L(d,["enter"]),type:"text",class:"input-sm peer"},null,544),[[A,w.value]]),tt])]))}}),st={class:"mb-5 flex items-start gap-1"},ot=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"h-4 w-4"},[t("path",{d:"M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"})],-1),at=t("span",{class:"whitespace-nowrap font-semibold"},"Create New Test",-1),rt={class:"pe-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},nt={class:"w-full"},lt={class:"sticky top-0 z-10 text-left"},it={key:0,class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},dt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-4 w-4 rotate-90"},[t("path",{d:"M32 160h319.9l.0791 72c0 9.547 5.652 18.19 14.41 22c8.754 3.812 18.93 2.078 25.93-4.406l112-104c10.24-9.5 10.24-25.69 0-35.19l-112-104c-6.992-6.484-17.17-8.217-25.93-4.408c-8.758 3.816-14.41 12.46-14.41 22L351.9 96H32C14.31 96 0 110.3 0 127.1S14.31 160 32 160zM480 352H160.1L160 279.1c0-9.547-5.652-18.19-14.41-22C136.9 254.2 126.7 255.9 119.7 262.4l-112 104c-10.24 9.5-10.24 25.69 0 35.19l112 104c6.992 6.484 17.17 8.219 25.93 4.406C154.4 506.2 160 497.5 160 488L160.1 416H480c17.69 0 32-14.31 32-32S497.7 352 480 352z"})],-1),ct=[dt],pt=t("th",{class:"whitespace-nowrap bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Seq. No.",-1),ht=t("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Name",-1),ut=t("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Code",-1),_t=t("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Short Form",-1),mt=t("th",{class:"whitespace-nowrap bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Sample Type",-1),gt=t("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Department",-1),wt=t("th",{class:"bg-gray-600 p-2 text-center font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Single",-1),yt=t("th",{class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Branch",-1),vt=t("th",{class:"bg-gray-600 p-2 text-center font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},"Active",-1),ft={key:1,class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss last-of-type:rounded-se"},bt={class:"transition even:bg-gray-100"},xt={key:0,class:"border border-gray-200 p-2"},Ct=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"mx-auto h-5 w-5 draggable-handle hover:cursor-move"},[t("path",{d:"M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"})],-1),kt=[Ct],zt={class:"border border-gray-200 px-2 py-1"},Ht={class:"border border-gray-200 px-2 py-1"},Mt={class:"border border-gray-200 px-2 py-1"},$t={class:"border border-gray-200 px-2 py-1"},Tt={class:"border border-gray-200 px-2 py-1"},Vt={class:"border border-gray-200 px-2 py-1"},Bt={class:"border border-gray-200 px-2 py-1 text-center"},St={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 text-emerald-500",viewBox:"0 0 16 16"},It=t("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),At=[It],Lt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 rotate-180 text-gray-300",viewBox:"0 0 16 16"},Ft=t("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),Dt=[Ft],Nt={class:"border border-gray-200 px-2 py-1"},Pt={class:"border border-gray-200 px-2 py-1 text-center"},qt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 text-emerald-500",viewBox:"0 0 16 16"},Ut=t("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),Qt=[Ut],Et={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"mx-auto h-7 w-7 rotate-180 text-red-500",viewBox:"0 0 16 16"},Rt=t("path",{d:"M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},null,-1),jt=[Rt],Kt={key:1,class:"border border-gray-200 px-2 py-1 text-center"},Gt={class:"flex items-center justify-center gap-3"},Jt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"mx-auto h-5 w-5"},[t("path",{d:"M16 96C16 69.49 37.49 48 64 48C90.51 48 112 69.49 112 96C112 122.5 90.51 144 64 144C37.49 144 16 122.5 16 96zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 416C16 389.5 37.49 368 64 368C90.51 368 112 389.5 112 416C112 442.5 90.51 464 64 464C37.49 464 16 442.5 16 416zM112 256C112 282.5 90.51 304 64 304C37.49 304 16 282.5 16 256C16 229.5 37.49 208 64 208C90.51 208 112 229.5 112 256z"})],-1),Ot=t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Wt=["onClick"],Xt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[t("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),Yt=[Xt],ce=V({__name:"Tests",setup(I){const h=f([]),k=F().user.branches,g=f({}),{urlQuery:u,updateUrlQuery:w}=K(),{hasPermissionTo:r,hasAnyPermission:_}=S();B(()=>y(location.search));const x=D(()=>u.get("departmentId")?`/tests/create?departmentId=${u.get("departmentId")}`:"/tests/create"),y=async d=>{const o=await w(d),{data:n}=await $.get(`/api/tests?${o}`);h.value=n.data,g.value=n.meta},b=()=>!r("Test.update")||!u.get("departmentId")?!1:k.length===1||u.get("branchId"),z=async()=>{const{data:d}=await $.post("/api/tests/rearrange",h.value);h.value=d.data};return(d,o)=>{const n=T("router-view"),c=T("router-link"),H=N("tip");return s(),a(q,null,[p(n,{onClose:y}),p(E,null,{header:v(()=>[P("Tests")]),body:v(()=>[t("div",st,[l(r)("Test.create")?(s(),M(c,{key:0,to:x.value,class:"inline-flex items-center gap-1 btn-blue"},{default:v(()=>[ot,at]),_:1},8,["to"])):i("",!0),p(et,{onChange:y})]),t("section",rt,[t("table",nt,[t("thead",null,[t("tr",lt,[b()?(s(),a("th",it,ct)):i("",!0),pt,ht,ut,_t,mt,gt,wt,yt,vt,l(_)("Parameter.view","Test.update","ActivityLog.list")?(s(),a("th",ft)):i("",!0)])]),p(l(O),{tag:"tbody",modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=e=>h.value=e),"item-key":"id",handle:".draggable-handle","ghost-class":"!bg-gray-300",onChange:z},{item:v(({element:e})=>[t("tr",bt,[b()?(s(),a("td",xt,kt)):i("",!0),t("td",zt,m(e.sequenceNumber),1),t("td",Ht,m(e.name),1),t("td",Mt,m(e.code),1),t("td",$t,m(e.shortForm),1),t("td",Tt,m(e.sampleType.name),1),t("td",Vt,m(e.department.name),1),t("td",Bt,[e.isSingle?(s(),a("svg",St,At)):(s(),a("svg",Lt,Dt))]),t("td",Nt,m(e.branch.name),1),t("td",Pt,[e.isActive?(s(),a("svg",qt,Qt)):(s(),a("svg",Et,jt))]),l(_)("Parameter.view","Test.update","ActivityLog.list")?(s(),a("td",Kt,[t("div",Gt,[l(r)("Parameter.view")?C((s(),M(c,{key:0,to:`/parameters?testId=${e.id}`,class:"cursor-pointer text-blue-500"},{default:v(()=>[Jt]),_:2},1032,["to"])),[[H,"View Parameters"]]):i("",!0),l(r)("Test.update")?C((s(),M(c,{key:1,to:`/tests/${e.id}/edit`,class:"cursor-pointer text-orange-500"},{default:v(()=>[Ot]),_:2},1032,["to"])),[[H,"Edit"]]):i("",!0),l(r)("ActivityLog.list")?C((s(),a("button",{key:2,onClick:Zt=>l(U).emit(l(Q).Show,e.id),class:"cursor-pointer text-gray-600"},Yt,8,Wt)),[[H,"View Activities"]]):i("",!0)])])):i("",!0)])]),_:1},8,["modelValue"])])])]),_:1}),p(G,{data:g.value,onChange:o[1]||(o[1]=e=>y(`page=${e}`)),class:"mt-3"},null,8,["data"]),p(J)],64)}}});export{ce as default};
