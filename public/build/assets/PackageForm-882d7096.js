import{d as M,f as A,e as R,g as u,u as j,x as D,Q as f,o as l,R as C,w as g,m as I,t as c,i as o,b as s,c as i,a as h,n as y,k as n,j as _,v as x,h as z,_ as L,a5 as Q,a0 as W}from"./main-cee2eb24.js";import{s as S}from"./multiselect-97a39018.js";import{b as O}from"./toggle-afba85dd.js";import{F as b}from"./formMode-f60a729f.js";const q=["onSubmit"],G={key:0,class:"mb-3 flex flex-wrap items-center"},H=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Branch",-1),J={key:0,class:"ml-24 w-full text-sm text-red-500"},K={class:"mb-3 flex flex-wrap items-center"},X=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Code",-1),Y={key:0,class:"ml-24 w-full text-sm text-red-500"},Z={class:"mb-3 flex flex-wrap items-center"},ee=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Name",-1),ae={key:0,class:"ml-24 w-full text-sm text-red-500"},se={class:"mb-3 flex flex-wrap items-center"},re=s("span",{class:"w-24 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Tests",-1),te={key:0,class:"ml-24 w-full text-sm text-red-500"},oe={class:"mb-3 flex flex-wrap items-center"},le=s("span",{class:"rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Premarital Screening Package",-1),de={class:"flex flex-wrap items-center"},ne=s("span",{class:"w-full"},"Notes",-1),ue=["disabled"],ve=M({__name:"PackageForm",emits:["close"],setup(ce,{emit:N}){const k=A(),U=R(),e=u({}),m=j().user.branches,P=u([]),p=u(b.Create),v=u(!1),r=u({});D(()=>{m.length===1&&(e.value.branchId=m[0].id,w()),k.path.endsWith("/edit")&&(p.value=b.Edit,F(k.params.id))});const F=async d=>{const{data:a}=await f.get(`/api/packages/${d}`);e.value=a.data,w()},w=async()=>{const{data:d}=await f.get(`/api/tests/list?branchId=${e.value.branchId}`);P.value=d.data},$=async()=>{v.value=!0;try{p.value===b.Create?await B():await T(),W.fire()}catch(d){r.value=d.response.data.errors??{}}v.value=!1},B=async()=>{await f.post("/api/packages",e.value),E()},T=async()=>{await f.patch(`/api/packages/${e.value.id}`,e.value),V()},E=()=>{e.value={branchId:e.value.branchId},r.value=[]},V=()=>{N("close"),U.back()};return(d,a)=>(l(),C(Q,null,{header:g(()=>[I(c(p.value===o(b).Create?"Create New Package":"Edit Package"),1)]),body:g(()=>[s("form",{id:"form",onSubmit:z($,["prevent","stop"])},[o(m).length>1?(l(),i("div",G,[H,h(o(S),{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.branchId=t),options:o(m),onSelect:w,onChange:a[1]||(a[1]=t=>e.value.tests=[]),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(l(),i("p",J,c(r.value.branchId[0]),1)):n("",!0)])):n("",!0),s("div",K,[X,_(s("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.code=t),class:y(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[x,e.value.code]]),r.value.hasOwnProperty("code")?(l(),i("p",Y,c(r.value.code[0]),1)):n("",!0)]),s("div",Z,[ee,_(s("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.name=t),class:y(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[x,e.value.name]]),r.value.hasOwnProperty("name")?(l(),i("p",ae,c(r.value.name[0]),1)):n("",!0)]),s("div",se,[re,h(o(S),{modelValue:e.value.tests,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.tests=t),mode:"tags",options:P.value,searchable:!0,object:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:y(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("tests")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("tests")?(l(),i("p",te,c(r.value.tests[0]),1)):n("",!0)]),s("div",oe,[le,h(o(O),{modelValue:e.value.isPremaritalScreeningPackage,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.isPremaritalScreeningPackage=t),class:"flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500"},null,8,["modelValue"])]),s("div",de,[ne,_(s("textarea",{"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.notes=t),rows:"4",class:"flex-1 rounded border border-gray-300 p-2 focus:border-blue-500"},null,512),[[x,e.value.notes]])])],40,q)]),footer:g(()=>[s("button",{class:"mr-2 btn-blue",disabled:v.value,form:"form"},[h(L,{"is-loading":v.value},{default:g(()=>[I("Save")]),_:1},8,["is-loading"])],8,ue),s("button",{onClick:V,class:"btn-gray"},"Cancel"),p.value===o(b).Edit?(l(),C(o(O),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.isActive=t),class:"toggle:off:red ml-auto"},null,8,["modelValue"])):n("",!0)]),_:1}))}});export{ve as default};
