import{d as M,e as p,u as E,x as A,Q as _,o as n,R as T,w as b,k,t as f,g as l,b as e,c,a as y,i as d,h as V,v as R,n as i,V as W,f as j,_ as z,a4 as L,m as Q,l as q,aI as G,$ as H}from"./main-BgbWFIXK.js";import{b as I}from"./toggle-CP_W0i88.js";import{s as J}from"./multiselect-DeMhawmc.js";import{F as v}from"./formMode-Bz--3d4P.js";import{P as r}from"./printTemplateType-BiK7zB0k.js";import{_ as K}from"./BranchSelect.vue_vue_type_script_setup_true_lang-ChkyAztq.js";const X={key:0,class:"relative"},Y={class:"relative"},Z={key:0,class:"text-sm text-red-500"},ee={class:"relative"},te=e("option",{value:void 0,disabled:""},"Select...",-1),ae=["value"],se=["value"],le=["value"],oe=["value"],re=["value"],ne=["value"],ie=["value"],ue=["value"],de=["value"],pe={key:0,class:"text-sm text-red-500"},ce={key:1,class:"relative"},ve={class:"relative"},me={key:0,class:"text-sm text-red-500"},he={class:"relative"},_e=e("label",{class:"label"},"Default",-1),be=["disabled"],Oe=M({__name:"PrintTemplateForm",emits:["close"],setup(fe,{emit:S}){const B=S,w=Q(),C=q(),t=p({}),P=E().user.branches,g=p([]),m=p(v.Create),h=p(!1),a=p({});A(()=>{P.length===1&&(t.value.branchId=P[0].id,x()),w.path.endsWith("/edit")&&(m.value=v.Edit,D(w.params.id))});const D=async u=>{const{data:s}=await _.get(`/api/print-templates/${u}`);t.value=s.data,x()},x=async()=>{const{data:u}=await _.get(`/api/tests/list?branchId=${t.value.branchId}`);g.value=u.data},U=async()=>{h.value=!0;try{m.value===v.Create?await $():await N(),G().fetch(),a.value={},H.fire()}catch(u){a.value=u.response.data.errors??{}}h.value=!1},$=async()=>{await _.post("/api/print-templates",t.value),F()},N=async()=>{await _.patch(`/api/print-templates/${t.value.id}`,t.value),O()},F=()=>{t.value={branchId:t.value.branchId},a.value=[]},O=()=>{B("close"),C.back()};return(u,s)=>(n(),T(L,null,{header:b(()=>[k(f(m.value===l(v).Create?"Create New Print Template":"Edit Print Template"),1)]),body:b(()=>[e("form",{id:"form",onSubmit:j(U,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[l(P).length>1?(n(),c("div",X,[y(K,{modelValue:t.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.branchId=o),error:a.value.branchId},null,8,["modelValue","error"])])):d("",!0),e("div",Y,[V(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.name=o),class:i(["input peer",{"border-red-500":a.value.hasOwnProperty("name")}])},null,2),[[R,t.value.name]]),e("label",{class:i(["label",{"text-red-500":a.value.hasOwnProperty("name")}])},"Name",2),a.value.hasOwnProperty("name")?(n(),c("p",Z,f(a.value.name[0]),1)):d("",!0)]),e("div",ee,[V(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.type=o),class:i(["input h-[2.75rem] peer",{"border-red-500":a.value.hasOwnProperty("type")}])},[te,e("option",{value:l(r).VisitBarcode},"Visit Barcode",8,ae),e("option",{value:l(r).SampleBarcode},"Sample Barcode",8,se),e("option",{value:l(r).SampleBarcodeDepWise},"Sample Barcode (Dep. Wise)",8,le),e("option",{value:l(r).Invoice},"Invoice",8,oe),e("option",{value:l(r).Results},"Results",8,re),e("option",{value:l(r).PremaritalResult},"Premarital Result",8,ne),e("option",{value:l(r).PremaritalReferral},"Premarital Referral",8,ie),e("option",{value:l(r).PurchaseOrder},"Purchase Order",8,ue),e("option",{value:l(r).ReceivingOrder},"Receiving Order",8,de)],2),[[W,t.value.type]]),e("label",{class:i(["label",{"text-red-500":a.value.hasOwnProperty("type")}])},"Type",2),a.value.hasOwnProperty("type")?(n(),c("p",pe,f(a.value.type[0]),1)):d("",!0)]),t.value.type===l(r).Results?(n(),c("div",ce,[y(l(J),{modelValue:t.value.tests,"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.tests=o),mode:"tags",options:g.value,searchable:!0,object:!0,"value-prop":"id",label:"shortForm","track-by":"searchableForm",class:"px-0 input peer"},null,8,["modelValue","options"]),e("label",{class:i(["label",{"text-red-500":a.value.hasOwnProperty("tests")}])},"Tests",2)])):d("",!0),e("div",ve,[V(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.reportPath=o),class:i(["input peer",{"border-red-500":a.value.hasOwnProperty("reportPath")}])},null,2),[[R,t.value.reportPath]]),e("label",{class:i(["label",{"text-red-500":a.value.hasOwnProperty("reportPath")}])},"Report Path",2),a.value.hasOwnProperty("reportPath")?(n(),c("p",me,f(a.value.reportPath[0]),1)):d("",!0)]),e("div",he,[y(l(I),{modelValue:t.value.isDefault,"onUpdate:modelValue":s[5]||(s[5]=o=>t.value.isDefault=o),class:"input peer pt-2.5"},null,8,["modelValue"]),_e])],32)]),footer:b(()=>[e("button",{class:"me-2 btn-blue",disabled:h.value,form:"form"},[y(z,{"is-loading":h.value},{default:b(()=>[k("Save")]),_:1},8,["is-loading"])],8,be),e("button",{onClick:O,class:"btn-gray"},"Cancel"),m.value===l(v).Edit?(n(),T(l(I),{key:0,modelValue:t.value.isActive,"onUpdate:modelValue":s[6]||(s[6]=o=>t.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):d("",!0)]),_:1}))}});export{Oe as default};
