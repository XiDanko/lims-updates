import{d as E,e as p,u as M,x as A,Q as v,U as F,o,R as N,w as b,k as V,t as h,g as f,b as t,c as _,a as C,i,h as y,v as w,n,f as R,_ as T,a4 as z,m as L,l as Q,$ as W}from"./main-DNdNUUJ7.js";import{b as j}from"./toggle-B4ffD-ge.js";import{F as u}from"./formMode-Bz--3d4P.js";import{_ as G}from"./BranchSelect.vue_vue_type_script_setup_true_lang-BebEpNal.js";import"./multiselect-K4eUN8Nz.js";const H={key:0,class:"relative"},J={class:"relative"},K={key:0,class:"text-sm text-red-500"},X={class:"relative"},Y={key:0,class:"text-sm text-red-500"},Z={class:"relative"},ee={key:0,class:"text-sm text-red-500"},ae={class:"relative"},te=t("label",{class:"label"},"Description",-1),se=["disabled"],ie=E({__name:"DepartmentForm",emits:["close"],setup(le,{emit:q}){const I=q,x=L(),O=Q(),e=p({}),d=p(u.Create),c=p(!1),a=p({}),m=M().user.branches;A(()=>{m.length===1&&(e.value.branchId=m[0].id),x.path.endsWith("/edit")&&(d.value=u.Edit,P(x.params.id)),d.value===u.Create&&m.length===1&&g()});const g=async()=>{const{data:r}=await v.post("/api/departments/generate-sequence",{branchId:e.value.branchId});e.value.sequenceNumber=r},P=async r=>{const{data:s}=await v.get(`/api/departments/${r}`);e.value=s.data},D=async()=>{c.value=!0;try{d.value===u.Create?await S():await U(),a.value={},W.fire()}catch(r){a.value=r.response.data.errors??{}}c.value=!1},S=async()=>{await v.post("/api/departments",e.value),$()},U=async()=>{await v.patch(`/api/departments/${e.value.id}`,e.value),k()},$=async()=>{e.value={branchId:e.value.branchId},a.value={},await g()},k=()=>{I("close"),O.back()};return(r,s)=>{const B=F("maska");return o(),N(z,null,{header:b(()=>[V(h(d.value===f(u).Create?"Create New Department":"Edit Department"),1)]),body:b(()=>[t("form",{id:"form",onSubmit:R(D,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[f(m).length>1?(o(),_("div",H,[C(G,{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=l=>e.value.branchId=l),error:a.value.branchId,onSelect:g},null,8,["modelValue","error"])])):i("",!0),t("div",J,[y(t("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>e.value.sequenceNumber=l),"data-maska":"###",class:n(["input peer",{"border-red-500":a.value.hasOwnProperty("sequenceNumber")}])},null,2),[[w,e.value.sequenceNumber],[B]]),t("label",{class:n(["label",{"text-red-500":a.value.hasOwnProperty("sequenceNumber")}])},"Seq. No.",2),a.value.hasOwnProperty("sequenceNumber")?(o(),_("p",K,h(a.value.sequenceNumber[0]),1)):i("",!0)]),t("div",X,[y(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>e.value.name=l),class:n(["input peer",{"border-red-500":a.value.hasOwnProperty("name")}])},null,2),[[w,e.value.name]]),t("label",{class:n(["label",{"text-red-500":a.value.hasOwnProperty("name")}])},"Name",2),a.value.hasOwnProperty("name")?(o(),_("p",Y,h(a.value.name[0]),1)):i("",!0)]),t("div",Z,[y(t("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>e.value.code=l),class:n(["input peer",{"border-red-500":a.value.hasOwnProperty("code")}])},null,2),[[w,e.value.code]]),t("label",{class:n(["label",{"text-red-500":a.value.hasOwnProperty("code")}])},"Code",2),a.value.hasOwnProperty("code")?(o(),_("p",ee,h(a.value.code[0]),1)):i("",!0)]),t("div",ae,[y(t("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>e.value.description=l),class:"input peer"},null,512),[[w,e.value.description]]),te])],32)]),footer:b(()=>[t("button",{class:"me-2 btn-blue",disabled:c.value,form:"form"},[C(T,{"is-loading":c.value},{default:b(()=>[V("Save")]),_:1},8,["is-loading"])],8,se),t("button",{onClick:k,class:"btn-gray"},"Cancel"),d.value===f(u).Edit?(o(),N(f(j),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[5]||(s[5]=l=>e.value.isActive=l),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):i("",!0)]),_:1})}}});export{ie as default};
