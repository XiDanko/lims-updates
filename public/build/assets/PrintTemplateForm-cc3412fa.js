import{d as $,e as c,u as A,x as E,A as h,o as l,C as k,w as y,k as T,t as p,g as r,b as a,c as i,a as _,n as g,i as d,h as x,v as I,J as W,f as j,_ as z,V as J,m as L,l as q,a6 as G,S as H}from"./main-c1f62c61.js";import{b as B}from"./toggle-b89396fa.js";import{s as C}from"./multiselect-ffe70d49.js";import{F as m}from"./formMode-f60a729f.js";import{P as n}from"./printTemplateType-09163c2a.js";const K=["onSubmit"],Q={key:0,class:"flex flex-wrap items-center mb-3"},X=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),Y={key:0,class:"ml-28 w-full text-red-500 text-sm"},Z={class:"flex flex-wrap items-center mb-3"},ee=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),ae={key:0,class:"w-full ml-28 text-red-500 text-sm"},te={class:"flex flex-wrap items-center mb-3"},re=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Type",-1),se=a("option",{value:void 0,disabled:""},"Select...",-1),oe=["value"],le=["value"],de=["value"],ne=["value"],ue=["value"],ie=["value"],ce={key:0,class:"ml-28 w-full text-red-500 text-sm"},pe={key:1,class:"flex flex-wrap items-start mb-3"},me=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Tests",-1),be={class:"flex flex-wrap items-center mb-3"},ve=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Report Path",-1),fe={key:0,class:"w-full ml-28 text-red-500 text-sm"},he={class:"flex flex-wrap items-center"},ye=a("span",{class:"w-28 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Default",-1),_e=["disabled"],ke=$({__name:"PrintTemplateForm",emits:["close"],setup(ge,{emit:O}){const P=L(),R=q(),e=c({}),b=A().user.branches,V=c([]),v=c(m.Create),f=c(!1),s=c([]);E(()=>{b.length===1&&(e.value.branchId=b[0].id,w()),P.path.endsWith("/edit")&&(v.value=m.Edit,D(P.params.id))});const D=async u=>{const{data:t}=await h.get(`/api/print-templates/${u}`);e.value=t.data,w()},w=async()=>{const{data:u}=await h.get(`/api/tests/list?branchId=${e.value.branchId}`);V.value=u.data},U=async()=>{f.value=!0;try{v.value===m.Create?await F():await N(),G().fetch(),H.fire()}catch(u){s.value=u.response.data.errors??{}}f.value=!1},F=async()=>{await h.post("/api/print-templates",e.value),M()},N=async()=>{await h.patch(`/api/print-templates/${e.value.id}`,e.value),S()},M=()=>{e.value={branchId:e.value.branchId},s.value=[]},S=()=>{O("close"),R.back()};return(u,t)=>(l(),k(J,null,{header:y(()=>[T(p(v.value===r(m).Create?"Create New Print Template":"Edit Print Template"),1)]),body:y(()=>[a("form",{id:"form",onSubmit:j(U,["prevent","stop"])},[r(b).length>1?(l(),i("div",Q,[X,_(r(C),{modelValue:e.value.branchId,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.branchId=o),onSelect:w,options:r(b),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:g(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":s.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),s.value.hasOwnProperty("branchId")?(l(),i("p",Y,p(s.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",Z,[ee,x(a("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.name=o),class:g(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":s.value.hasOwnProperty("name")}])},null,2),[[I,e.value.name]]),s.value.hasOwnProperty("name")?(l(),i("p",ae,p(s.value.name[0]),1)):d("",!0)]),a("div",te,[re,x(a("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.type=o),class:g(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":s.value.hasOwnProperty("type")}])},[se,a("option",{value:r(n).VisitBarcode},"Visit Barcode",8,oe),a("option",{value:r(n).SampleBarcode},"Sample Barcode",8,le),a("option",{value:r(n).SampleBarcodeDepWise},"Sample Barcode (Dep. Wise)",8,de),a("option",{value:r(n).Invoice},"Invoice",8,ne),a("option",{value:r(n).Results},"Results",8,ue),a("option",{value:r(n).PremaritalScreeningResult},"Premarital Screening Result",8,ie)],2),[[W,e.value.type]]),s.value.hasOwnProperty("type")?(l(),i("p",ce,p(s.value.type[0]),1)):d("",!0)]),e.value.type===r(n).Results?(l(),i("div",pe,[me,_(r(C),{modelValue:e.value.tests,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.tests=o),mode:"tags",options:V.value,searchable:!0,object:!0,"value-prop":"id",label:"shortForm","track-by":"searchableForm",class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])])):d("",!0),a("div",be,[ve,x(a("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.reportPath=o),class:g(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":s.value.hasOwnProperty("reportPath")}])},null,2),[[I,e.value.reportPath]]),s.value.hasOwnProperty("reportPath")?(l(),i("p",fe,p(s.value.reportPath[0]),1)):d("",!0)]),a("div",he,[ye,_(r(B),{modelValue:e.value.isDefault,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.isDefault=o),class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,8,["modelValue"])])],40,K)]),footer:y(()=>[a("button",{class:"btn-blue mr-2",disabled:f.value,form:"form"},[_(z,{"is-loading":f.value},{default:y(()=>[T("Save")]),_:1},8,["is-loading"])],8,_e),a("button",{onClick:S,class:"btn-gray"},"Cancel"),v.value===r(m).Edit?(l(),k(r(B),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.isActive=o),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):d("",!0)]),_:1}))}});export{ke as default};
