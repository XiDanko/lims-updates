import{d as Y,e as D,x as F,o as f,c as v,h as I,a5 as T,b as t,g as e,i as x,f as z,F as W,p as s,y as L,U as B,t as d,n as V,v as N,a as w,Q as U,Y as Q,a2 as X,u as ee,$ as te,R as ae,w as A,k as O,_ as re,m as se,l as le,a3 as oe,Z as j}from"./main-56f58ed8.js";import{M as ne}from"./Master-fc459851.js";import{F as E}from"./formMode-f60a729f.js";import{s as P}from"./multiselect-167e14f5.js";import{b as k}from"./toggle-876d3de4.js";import{_ as de}from"./VisitPrintToggles.vue_vue_type_script_setup_true_lang-cd1aee23.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./printTemplateManager-19d5b864.js";import"./websocketPrint-54028e1f.js";class ie{constructor(n,i="user",l=null,a=null){this._webcamElement=n,this._webcamElement.width=this._webcamElement.width||640,this._webcamElement.height=this._webcamElement.height||this._webcamElement.width*(3/4),this._facingMode=i,this._webcamList=[],this._streamList=[],this._selectedDeviceId="",this._canvasElement=l,this._snapSoundElement=a}get facingMode(){return this._facingMode}set facingMode(n){this._facingMode=n}get webcamList(){return this._webcamList}get webcamCount(){return this._webcamList.length}get selectedDeviceId(){return this._selectedDeviceId}getVideoInputs(n){return this._webcamList=[],n.forEach(i=>{i.kind==="videoinput"&&this._webcamList.push(i)}),this._webcamList.length==1&&(this._facingMode="user"),this._webcamList}getMediaConstraints(){var n={};this._selectedDeviceId==""?n.facingMode=this._facingMode:n.deviceId={exact:this._selectedDeviceId};var i={video:n,audio:!1};return i}selectCamera(){for(let n of this._webcamList)if(this._facingMode=="user"&&n.label.toLowerCase().includes("front")||this._facingMode=="enviroment"&&n.label.toLowerCase().includes("back")){this._selectedDeviceId=n.deviceId;break}}flip(){this._facingMode=this._facingMode=="user"?"enviroment":"user",this._webcamElement.style.transform="",this.selectCamera()}async start(n=!0){return new Promise((i,l)=>{this.stop(),navigator.mediaDevices.getUserMedia(this.getMediaConstraints()).then(a=>{this._streamList.push(a),this.info().then(y=>{this.selectCamera(),n?this.stream().then(o=>{i(this._facingMode)}).catch(o=>{l(o)}):i(this._selectedDeviceId)}).catch(y=>{l(y)})}).catch(a=>{l(a)})})}async info(){return new Promise((n,i)=>{navigator.mediaDevices.enumerateDevices().then(l=>{this.getVideoInputs(l),n(this._webcamList)}).catch(l=>{i(l)})})}async stream(){return new Promise((n,i)=>{navigator.mediaDevices.getUserMedia(this.getMediaConstraints()).then(l=>{this._streamList.push(l),this._webcamElement.srcObject=l,this._facingMode=="user"&&(this._webcamElement.style.transform="scale(-1,1)"),this._webcamElement.play(),n(this._facingMode)}).catch(l=>{console.log(l),i(l)})})}stop(){this._streamList.forEach(n=>{n.getTracks().forEach(i=>{i.stop()})})}snap(){if(this._canvasElement!=null){this._snapSoundElement!=null&&this._snapSoundElement.play(),this._canvasElement.height=this._webcamElement.scrollHeight,this._canvasElement.width=this._webcamElement.scrollWidth;let n=this._canvasElement.getContext("2d");return this._facingMode=="user"&&(n.translate(this._canvasElement.width,0),n.scale(-1,1)),n.clearRect(0,0,this._canvasElement.width,this._canvasElement.height),n.drawImage(this._webcamElement,0,0,this._canvasElement.width,this._canvasElement.height),this._canvasElement.toDataURL("image/png")}else throw"canvas element is missing"}}const ce={class:"fixed inset-0 z-[100] flex flex-col items-center justify-center bg-black/80"},ue=["id"],be=["src"],he={class:"flex items-center justify-center gap-5 mt-12"},me=["onClick","title"],ge=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-10 h-10 text-gray-900"},[t("path",{d:"M12 9a3.75 3.75 0 100 7.5A3.75 3.75 0 0012 9z"}),t("path",{"fill-rule":"evenodd",d:"M9.344 3.071a49.52 49.52 0 015.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 01-3 3h-15a3 3 0 01-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 001.11-.71l.822-1.315a2.942 2.942 0 012.332-1.39zM6.75 12.75a5.25 5.25 0 1110.5 0 5.25 5.25 0 01-10.5 0zm12-1.5a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})],-1),pe=[ge],fe=["onClick","title"],ve=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-10 h-10 text-gray-900"},[t("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0112.548-3.364l1.903 1.903h-3.183a.75.75 0 100 1.5h4.992a.75.75 0 00.75-.75V4.356a.75.75 0 00-1.5 0v3.18l-1.9-1.9A9 9 0 003.306 9.67a.75.75 0 101.45.388zm15.408 3.352a.75.75 0 00-.919.53 7.5 7.5 0 01-12.548 3.364l-1.902-1.903h3.183a.75.75 0 000-1.5H2.984a.75.75 0 00-.75.75v4.992a.75.75 0 001.5 0v-3.18l1.9 1.9a9 9 0 0015.059-4.035.75.75 0 00-.53-.918z","clip-rule":"evenodd"})],-1),_e=[ve],we=["onClick","title"],ye=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-10 h-10 text-gray-900"},[t("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z","clip-rule":"evenodd"})],-1),xe=[ye],Ve=["id"],Me=Y({__name:"WebcamModal",emits:["capture"],setup(H,{expose:n,emit:i}){let l=null;const a=D(null),y=D(!1),o=(Math.random()*1e3).toFixed();F(()=>{const _=document.getElementById("webcam-"+o),h=document.getElementById("canvas-"+o);l=new ie(_,"user",h)});const c=()=>{l.start(),y.value=!0},r=()=>{a.value=l.snap(),i("capture",a.value),l.stop()},b=()=>{a.value=null,l.start()},M=()=>{l.stop(),a.value=null,y.value=!1};return n({open:c}),(_,h)=>(f(),v(W,null,[I(t("div",ce,[I(t("video",{id:"webcam-"+e(o),width:"640",height:"480",class:"rounded-lg"},null,8,ue),[[T,a.value===null]]),a.value?(f(),v("img",{key:0,src:a.value,alt:"",width:"640",height:"480",class:"rounded-lg"},null,8,be)):x("",!0),t("div",he,[a.value===null?(f(),v("button",{key:0,class:"bg-gray-100 rounded-full w-14 h-14 flex items-center justify-center shadow",onClick:z(r,["prevent"]),title:e(s)("Capture")},pe,8,me)):(f(),v("button",{key:1,class:"bg-gray-100 rounded-full w-14 h-14 flex items-center justify-center shadow",onClick:z(b,["prevent"]),title:e(s)("Retry")},_e,8,fe)),t("button",{class:"bg-gray-100 rounded-full w-14 h-14 flex items-center justify-center shadow",onClick:z(M,["prevent"]),title:e(s)("Close")},xe,8,we)])],512),[[T,y.value]]),t("canvas",{id:"canvas-"+e(o),class:"hidden"},null,8,Ve)],64))}}),$e={class:"grid grid-cols-1 gap-2"},ke=["src"],Ie={class:"flex flex-wrap items-start"},De={class:"w-14 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Ce=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"},[t("path",{d:"M12 9a3.75 3.75 0 100 7.5A3.75 3.75 0 0012 9z"}),t("path",{"fill-rule":"evenodd",d:"M9.344 3.071a49.52 49.52 0 015.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 01-3 3h-15a3 3 0 01-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 001.11-.71l.822-1.315a2.942 2.942 0 012.332-1.39zM6.75 12.75a5.25 5.25 0 1110.5 0 5.25 5.25 0 01-10.5 0zm12-1.5a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})],-1),Ee=[Ce],Ue={key:0,class:"p-1 border border-gray-300 ltr:border-l-0 rtl:border-r-0 ltr:rounded-r rtl:rounded-l bg-green-500"},Ne=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-white"},[t("path",{"fill-rule":"evenodd",d:"M19.916 4.626a.75.75 0 01.208 1.04l-9 13.5a.75.75 0 01-1.154.114l-6-6a.75.75 0 011.06-1.06l5.353 5.353 8.493-12.739a.75.75 0 011.04-.208z","clip-rule":"evenodd"})],-1),He=[Ne],Se={key:1,class:"w-full ltr:ml-14 rtl:mr-14 text-red-500 text-sm"},ze={class:"flex flex-wrap items-start"},Le={class:"w-14 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Pe={key:0,class:"w-full ltr:ml-14 rtl:mr-14 text-red-500 text-sm"},Ye={class:"flex items-start"},Ae={class:"flex-1 flex flex-wrap items-center"},Be={class:"w-14 p-1 bg-gray-100 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r"},Te={key:0,class:"w-full ltr:ml-14 rtl:mr-14 text-red-500 text-sm"},Oe={class:"flex-1 flex flex-wrap items-center"},je={class:"p-1 border-y border-gray-300 bg-gray-100"},Re={key:0,class:"w-full ltr:ml-14 rtl:mr-14 text-red-500 text-sm"},Fe={class:"flex-1 flex flex-wrap items-center"},We={class:"p-1 border-y border-gray-300 bg-gray-100"},Qe={key:0,class:"w-full ltr:ml-14 rtl:mr-14 text-red-500 text-sm"},Ze={class:"flex flex-wrap items-start"},qe={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Ge={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},Je={class:"flex flex-wrap items-start"},Ke={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Xe={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},et={class:"flex flex-wrap items-start"},tt={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},at={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},R=Y({__name:"PersonalInformation",props:{modelValue:null,suggestions:null,branchId:null,errors:null,for:null},emits:["update:modelValue","update:suggestions"],setup(H,{emit:n}){const i=H,{hasPermissionTo:l}=Q(),a=L({get:()=>i.modelValue,set:_=>n("update:modelValue",_)}),y=L({get:()=>i.suggestions,set:_=>n("update:suggestions",_)}),o=D(null),c=async(_,h)=>{if(!l("Suggestion.create"))return;const{data:$}=await U.post("/api/suggestions",{branchId:i.branchId,type:_,content:h});return y.value.unshift($.data),$.data},r=_=>i.errors.hasOwnProperty(`${i.for}Information.${_}`),b=_=>i.errors[`${i.for}Information.${_}`][0],M=_=>{const h=_.target.files[0],$=new FileReader;$.readAsDataURL(h),$.onload=()=>a.value.photo=$.result};return(_,h)=>{const $=B("tip"),S=B("maska");return f(),v(W,null,[t("div",$e,[e(a).photoPath?(f(),v("img",{key:0,class:"h-24 rounded",src:`/storage/${e(a).photoPath}`,alt:""},null,8,ke)):x("",!0),t("div",Ie,[t("span",De,d(e(s)("Photo")),1),t("input",{type:"file",onChange:M,accept:"image/*",size:"1",class:V(["flex-1 p-1 text-[12px] border border-gray-300 focus:border-blue-500",{"!border-red-500":r("photo")}])},null,34),I((f(),v("button",{class:V(["p-1 border border-gray-300 ltr:border-l-0 rtl:border-r-0 ltr:rounded-r rtl:rounded-l bg-gray-100",{"!rounded-none":e(a).photo}]),onClick:h[0]||(h[0]=z(m=>o.value.open(),["prevent"]))},Ee,2)),[[$,e(s)("Open Camera")]]),e(a).photo?(f(),v("span",Ue,He)):x("",!0),r("photo")?(f(),v("p",Se,d(b("photo")),1)):x("",!0)]),t("div",ze,[t("span",Le,d(e(s)("Name")),1),I(t("input",{"onUpdate:modelValue":h[1]||(h[1]=m=>e(a).name=m),size:"1",class:V(["flex-1 p-1 ltr:rounded-r rtl:rounded-l border border-gray-300 focus:border-blue-500",{"!border-red-500":r("name")}])},null,2),[[N,e(a).name]]),r("name")?(f(),v("p",Pe,d(b("name")),1)):x("",!0)]),t("div",Ye,[t("div",Ae,[t("span",Be,d(e(s)("Year")),1),I(t("input",{"onUpdate:modelValue":h[2]||(h[2]=m=>e(a).birthdateYear=m),"data-maska":"####",size:"1",class:V(["flex-1 p-1 border border-gray-300 focus:border-blue-500",{"!border-red-500":r("birthdateYear")}])},null,2),[[N,e(a).birthdateYear],[S]]),r("birthdateYear")?(f(),v("p",Te,d(b("birthdateYear")),1)):x("",!0)]),t("div",Oe,[t("span",je,d(e(s)("Month")),1),I(t("input",{"onUpdate:modelValue":h[3]||(h[3]=m=>e(a).birthdateMonth=m),"data-maska":"##",size:"1",class:V(["flex-1 p-1 border border-gray-300 focus:border-blue-500",{"!border-red-500":r("birthdateMonth")}])},null,2),[[N,e(a).birthdateMonth],[S]]),r("birthdateMonth")?(f(),v("p",Re,d(b("birthdateMonth")),1)):x("",!0)]),t("div",Fe,[t("span",We,d(e(s)("Day")),1),I(t("input",{"onUpdate:modelValue":h[4]||(h[4]=m=>e(a).birthdateDay=m),"data-maska":"##",size:"1",class:V(["flex-1 p-1 border border-gray-300 ltr:rounded-r rtl:rounded-l focus:border-blue-500",{"!border-red-500":r("birthdateDay")}])},null,2),[[N,e(a).birthdateDay],[S]]),r("birthdateDay")?(f(),v("p",Qe,d(b("birthdateDay")),1)):x("",!0)])]),t("div",Ze,[t("span",qe,d(e(s)("Education Degree")),1),w(e(P),{modelValue:e(a).educationDegree,"onUpdate:modelValue":h[5]||(h[5]=m=>e(a).educationDegree=m),options:e(y).filter(m=>m.type==="educationDegree"),"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":e(l)("Suggestion.create"),"on-create":m=>c("educationDegree",m.content),class:V(["min-h-[34px] flex-1 border border-gray-300 ltr:!rounded-r rtl:!rounded-l",{"!border-red-500":r("educationDegree")}])},null,8,["modelValue","options","create-option","on-create","class"]),r("educationDegree")?(f(),v("p",Ge,d(b("educationDegree")),1)):x("",!0)]),t("div",Je,[t("span",Ke,d(e(s)("Occupation")),1),w(e(P),{modelValue:e(a).occupation,"onUpdate:modelValue":h[6]||(h[6]=m=>e(a).occupation=m),options:e(y).filter(m=>m.type==="occupation"),"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":e(l)("Suggestion.create"),"on-create":m=>c("occupation",m.content),class:V(["min-h-[34px] flex-1 border border-gray-300 ltr:!rounded-r rtl:!rounded-l",{"!border-red-500":r("occupation")}])},null,8,["modelValue","options","create-option","on-create","class"]),r("occupation")?(f(),v("p",Xe,d(b("occupation")),1)):x("",!0)]),t("div",et,[t("span",tt,d(e(s)("Address")),1),I(t("input",{"onUpdate:modelValue":h[7]||(h[7]=m=>e(a).address=m),size:"1",class:V(["flex-1 p-1 ltr:rounded-r rtl:rounded-l border border-gray-300 focus:border-blue-500",{"!border-red-500":r("address")}])},null,2),[[N,e(a).address]]),r("address")?(f(),v("p",at,d(b("address")),1)):x("",!0)])]),w(Me,{ref_key:"webcam",ref:o,onCapture:h[8]||(h[8]=m=>e(a).photo=m)},null,512)],64)}}}),rt={class:"border border-gray-300 rounded overflow-hidden select-none"},st={class:"flex items-center justify-between border-b border-gray-300 py-2 px-5 odd:bg-gray-100 hover:bg-gray-200 hover:text-gray-800"},lt={class:"text-lg font-bold"},ot={class:"flex items-center justify-between border-b border-gray-300 py-2 px-5 odd:bg-gray-100 hover:bg-gray-200 hover:text-gray-800"},nt={class:"text-lg font-bold"},dt={class:"flex items-center justify-between border-b border-gray-300 py-2 px-5 odd:bg-gray-100 hover:bg-gray-200 hover:text-gray-800"},it={class:"text-lg font-bold"},ct={class:"flex items-center justify-between border-b border-gray-300 py-2 px-5 odd:bg-gray-100 hover:bg-gray-200 hover:text-gray-800"},ut={class:"text-lg font-bold"},bt={class:"flex items-center justify-between py-2 px-5 odd:bg-gray-100 hover:bg-gray-200 hover:text-gray-800"},ht={class:"text-lg font-bold"},mt=Y({__name:"MedicalHistory",props:{husband:null,wife:null},emits:["update:husbandMedicalHistory","update:wifeMedicalHistory"],setup(H,{emit:n}){const i=H,l=L({get:()=>i.husband,set:y=>n("update:husbandMedicalHistory",y)}),a=L({get:()=>i.wife,set:y=>n("update:wifeMedicalHistory",y)});return(y,o)=>(f(),v("div",rt,[t("div",st,[w(e(k),{modelValue:e(l).hasThalassemia,"onUpdate:modelValue":o[0]||(o[0]=c=>e(l).hasThalassemia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"]),t("span",lt,d(e(s)("Has Thalassemia")),1),w(e(k),{modelValue:e(a).hasThalassemia,"onUpdate:modelValue":o[1]||(o[1]=c=>e(a).hasThalassemia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"])]),t("div",ot,[w(e(k),{modelValue:e(l).hasSickleCellAnemia,"onUpdate:modelValue":o[2]||(o[2]=c=>e(l).hasSickleCellAnemia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"]),t("span",nt,d(e(s)("Has Sickle Cell Anemia")),1),w(e(k),{modelValue:e(a).hasSickleCellAnemia,"onUpdate:modelValue":o[3]||(o[3]=c=>e(a).hasSickleCellAnemia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"])]),t("div",dt,[w(e(k),{modelValue:e(l).hasHaemophilia,"onUpdate:modelValue":o[4]||(o[4]=c=>e(l).hasHaemophilia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"]),t("span",it,d(e(s)("Has Haemophilia")),1),w(e(k),{modelValue:e(a).hasHaemophilia,"onUpdate:modelValue":o[5]||(o[5]=c=>e(a).hasHaemophilia=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"])]),t("div",ct,[w(e(k),{modelValue:e(l).hasMentalDisability,"onUpdate:modelValue":o[6]||(o[6]=c=>e(l).hasMentalDisability=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"]),t("span",ut,d(e(s)("Has Mental Disability")),1),w(e(k),{modelValue:e(a).hasMentalDisability,"onUpdate:modelValue":o[7]||(o[7]=c=>e(a).hasMentalDisability=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"])]),t("div",bt,[w(e(k),{modelValue:e(l).hasDiabetes,"onUpdate:modelValue":o[8]||(o[8]=c=>e(l).hasDiabetes=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"]),t("span",ht,d(e(s)("Has Diabetes")),1),w(e(k),{modelValue:e(a).hasDiabetes,"onUpdate:modelValue":o[9]||(o[9]=c=>e(a).hasDiabetes=c),"on-label":e(s)("Yes"),"off-label":e(s)("No"),class:"toggle:on:red toggle:off:green"},null,8,["modelValue","on-label","off-label"])])]))}}),gt={class:"h-[calc(100vh-8.6rem)] overflow-y-auto flex flex-col justify-between"},pt={class:"grid grid-cols-2 gap-2"},ft={key:0,class:"col-span-2 flex flex-wrap items-center mb-2"},vt={class:"w-20 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},_t={key:0,class:"ltr:ml-20 ltr:mr-20 w-full text-red-500 text-sm"},wt={class:"font-bold underline text-lg"},yt={class:"ltr:border-l-2 rtl:border-r-2 border-gray-200 ltr:pl-2 rtl:pr-2"},xt={class:"font-bold underline text-lg"},Vt={class:"col-span-2 grid grid-cols-3 gap-2"},Mt={class:"flex flex-wrap items-start"},$t={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},kt={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},It={class:"flex flex-wrap items-start"},Dt={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Ct={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},Et={class:"flex flex-wrap items-start"},Ut={class:"w-36 p-1 border border-gray-300 ltr:border-r-0 rtl:border-l-0 ltr:rounded-l rtl:rounded-r bg-gray-100"},Nt={key:0,class:"w-full ltr:ml-36 rtl:mr-36 text-red-500 text-sm"},Ht=t("hr",{class:"border border-gray-200 mt-5 mb-3"},null,-1),St={class:"col-span-3 font-bold underline text-xl text-center mb-3"},zt={class:"mt-3 border-t-2 border-gray-200"},Lt={class:"flex items-center mt-3"},Pt=["disabled"],Qt=Y({__name:"PremaritalScreeningForm",setup(H){const n=X(),i=se(),l=le(),{hasPermissionTo:a}=Q(),y=D(null),o=D(E.Create),c=ee().user.branches,r=D({husbandInformation:{},wifeInformation:{},husbandMedicalHistory:{},wifeMedicalHistory:{},phoneNumber:"+964"}),b=D({}),M=D([]),_=D(!1);F(()=>{c.length===1&&(r.value.branchId=c[0].id),i.path.endsWith("/edit")&&(o.value=E.Edit,h(i.params.id))});const h=async g=>{const{data:u}=await U.get(`/api/premarital-screening/${g}`);r.value=u.data},$=async()=>{const{data:g}=await U.get(`/api/suggestions/list?branchId=${r.value.branchId}&type=educationDegree,occupation,relationDegree`);M.value=g.data},S=async(g,u)=>{if(!a("Suggestion.create"))return;const{data:C}=await U.post("/api/suggestions",{branchId:r.value.branchId,type:g,content:u});return M.value.unshift(C.data),C.data},m=async()=>{if(o.value==="edit"){const{isConfirmed:g}=await oe.fire();if(!g)return}_.value=!0;try{const g=o.value===E.Create?await G():await J();y.value.print(g.husbandVisit),y.value.print(g.wifeVisit),Z(g.husbandVisit)&&q(g.husbandVisit),o.value===E.Edit&&await l.back()}catch(g){b.value=g.response.data.errors??{}}_.value=!1},Z=g=>{const u=n.data.whatsapp?.find(C=>C.branchId===g.branchId);return a("Invoice.send")&&o.value===E.Create&&u?.enabled&&(u?.sendInvoice||u?.sendWelcomeMessage)&&g.patient.contactMethod==="whatsapp"},q=async g=>{await U.post(`/api/visits/${g.id}/send-welcome-message`)},G=async()=>{const{data:g}=await U.post("/api/premarital-screening",r.value);return j.fire(),K(),g.data},J=async()=>{const{data:g}=await U.patch(`/api/premarital-screening/${r.value.id}`,r.value);return j.fire(),g.data},K=()=>{r.value={branchId:r.value.branchId,husbandInformation:{},wifeInformation:{},husbandMedicalHistory:{},wifeMedicalHistory:{},phoneNumber:"+964"},b.value={}};return te(()=>{r.value.branchId&&$()}),(g,u)=>{const C=B("maska");return f(),ae(ne,null,{header:A(()=>[O(d(o.value===e(E).Create?e(s)("New Premarital Screening Visit"):e(s)("Edit Premarital Screening Visit")),1)]),body:A(()=>[t("div",gt,[t("div",null,[t("div",pt,[o.value===e(E).Create&&e(c).length>1?(f(),v("div",ft,[t("span",vt,d(e(s)("Branch")),1),w(e(P),{modelValue:r.value.branchId,"onUpdate:modelValue":u[0]||(u[0]=p=>r.value.branchId=p),options:e(c),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:V(["min-h-[34px] flex-1 border border-gray-300 ltr:!rounded-r rtl:!rounded-l",{"!border-red-500":b.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),b.value.hasOwnProperty("branchId")?(f(),v("p",_t,d(b.value.branchId[0]),1)):x("",!0)])):x("",!0),t("div",null,[t("h1",wt,d(e(s)("Husband Information")),1),w(R,{for:"husband",modelValue:r.value.husbandInformation,"onUpdate:modelValue":u[1]||(u[1]=p=>r.value.husbandInformation=p),suggestions:M.value,"onUpdate:suggestions":u[2]||(u[2]=p=>M.value=p),branchId:r.value.branchId,errors:b.value},null,8,["modelValue","suggestions","branchId","errors"])]),t("div",yt,[t("h1",xt,d(e(s)("Wife Information")),1),w(R,{for:"wife",modelValue:r.value.wifeInformation,"onUpdate:modelValue":u[3]||(u[3]=p=>r.value.wifeInformation=p),suggestions:M.value,"onUpdate:suggestions":u[4]||(u[4]=p=>M.value=p),branchId:r.value.branchId,errors:b.value},null,8,["modelValue","suggestions","branchId","errors"])]),t("div",Vt,[t("div",Mt,[t("span",$t,d(e(s)("Phone Number")),1),I(t("input",{"onUpdate:modelValue":u[5]||(u[5]=p=>r.value.phoneNumber=p),"data-maska":"+0","data-maska-tokens":"0:[0-9]:multiple",size:"1",dir:"ltr",class:V(["flex-1 p-1 border border-gray-300 ltr:rounded-r rtl:rounded-l focus:border-blue-500",{"!border-red-500":b.value.hasOwnProperty("phoneNumber")}])},null,2),[[N,r.value.phoneNumber],[C]]),b.value.hasOwnProperty("phoneNumber")?(f(),v("p",kt,d(b.value.phoneNumber[0]),1)):x("",!0)]),t("div",It,[t("span",Dt,d(e(s)("Relation Degree")),1),w(e(P),{modelValue:r.value.relationDegree,"onUpdate:modelValue":u[6]||(u[6]=p=>r.value.relationDegree=p),options:M.value.filter(p=>p.type==="relationDegree"),"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":e(a)("Suggestion.create"),"on-create":p=>S("relationDegree",p.content),class:V(["min-h-[34px] flex-1 border border-gray-300 ltr:!rounded-r rtl:!rounded-l",{"!border-red-500":b.value.hasOwnProperty("relationDegree")}])},null,8,["modelValue","options","create-option","on-create","class"]),b.value.hasOwnProperty("relationDegree")?(f(),v("p",Ct,d(b.value.relationDegree[0]),1)):x("",!0)]),t("div",Et,[t("span",Ut,d(e(s)("Receipt No.")),1),I(t("input",{"onUpdate:modelValue":u[7]||(u[7]=p=>r.value.receiptNumber=p),"data-maska":"0","data-maska-tokens":"0:[0-9]:multiple",size:"1",class:V(["flex-1 p-1 border border-gray-300 ltr:rounded-r rtl:rounded-l focus:border-blue-500",{"!border-red-500":b.value.hasOwnProperty("receiptNumber")}])},null,2),[[N,r.value.receiptNumber],[C]]),b.value.hasOwnProperty("receiptNumber")?(f(),v("p",Nt,d(b.value.receiptNumber[0]),1)):x("",!0)])])]),Ht,t("div",null,[t("h1",St,d(e(s)("Medical History and Blood Diseases")),1),w(mt,{husband:r.value.husbandMedicalHistory,"onUpdate:husband":u[8]||(u[8]=p=>r.value.husbandMedicalHistory=p),wife:r.value.wifeMedicalHistory,"onUpdate:wife":u[9]||(u[9]=p=>r.value.wifeMedicalHistory=p)},null,8,["husband","wife"])])]),t("footer",zt,[t("div",Lt,[t("button",{class:"btn-blue ltr:mr-auto rtl:ml-auto",disabled:_.value,onClick:m},[w(re,{"is-loading":_.value},{default:A(()=>[O(d(e(s)("Save")),1)]),_:1},8,["is-loading"])],8,Pt),w(de,{"branch-id":r.value.branchId,ref_key:"printToggles",ref:y},null,8,["branch-id"])])])])]),_:1})}}});export{Qt as default};
