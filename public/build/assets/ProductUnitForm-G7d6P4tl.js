import{d as M,e as n,x as S,Q as v,U as D,o as u,R as k,w as m,k as C,t as d,g as f,b as t,h as _,v as h,n as l,c as w,i as y,f as F,a as R,_ as T,a4 as A,m as Q,l as z,$ as L}from"./main-DNdNUUJ7.js";import{b as W}from"./toggle-B4ffD-ge.js";import{F as i}from"./formMode-Bz--3d4P.js";const j={class:"relative"},G={key:0,class:"text-sm text-red-500"},H={class:"relative"},J={key:0,class:"text-sm text-red-500"},K={class:"relative"},X={class:"flex"},Y={class:"border-2 border-gray-300 bg-gray-100 p-2 rounded-e border-s-0"},Z={key:0,class:"text-sm text-red-500"},ee=["disabled"],re=M({__name:"ProductUnitForm",emits:["close"],setup(ae,{emit:P}){const I=P,b=Q(),U=z(),e=n({}),x=n({}),c=n(i.Create),p=n(!1),a=n({});S(()=>{e.value.productId=b.params.productId,V(e.value.productId),b.path.endsWith("/edit")&&(c.value=i.Edit,O(b.params.unitId))});const V=async r=>{const{data:s}=await v.get(`/api/products/${r}`);x.value=s.data},O=async r=>{const{data:s}=await v.get(`/api/products/${e.value.productId}/units/${r}`);e.value=s.data},$=async()=>{p.value=!0;try{c.value===i.Create?await q():await N(),a.value={},L.fire()}catch(r){a.value=r.response.data.errors??{}}p.value=!1},q=async()=>{await v.post(`/api/products/${e.value.productId}/units`,e.value),B()},N=async()=>{await v.patch(`/api/products/${e.value.productId}/units/${e.value.id}`,e.value),g()},B=()=>{e.value={productId:e.value.productId},a.value=[]},g=()=>{I("close"),U.back()};return(r,s)=>{const E=D("maska");return u(),k(A,null,{header:m(()=>[C(d(c.value===f(i).Create?"Create New Unit":"Edit Unit"),1)]),body:m(()=>[t("form",{id:"form",onSubmit:F($,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[t("div",j,[_(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>e.value.name=o),class:l(["input peer",{"border-red-500":a.value.hasOwnProperty("name")}])},null,2),[[h,e.value.name]]),t("label",{class:l(["label",{"text-red-500":a.value.hasOwnProperty("name")}])},"Name",2),a.value.hasOwnProperty("name")?(u(),w("p",G,d(a.value.name[0]),1)):y("",!0)]),t("div",H,[_(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.code=o),class:l(["input peer",{"border-red-500":a.value.hasOwnProperty("code")}])},null,2),[[h,e.value.code]]),t("label",{class:l(["label",{"text-red-500":a.value.hasOwnProperty("code")}])},"Code",2),a.value.hasOwnProperty("code")?(u(),w("p",J,d(a.value.code[0]),1)):y("",!0)]),t("div",K,[t("div",X,[_(t("input",{"data-maska":"0.0","data-maska-tokens":"0:[0-9]:multiple","onUpdate:modelValue":s[2]||(s[2]=o=>e.value.quantity=o),class:l(["input peer !rounded-e-none",{"border-red-500":a.value.hasOwnProperty("quantity")}])},null,2),[[E],[h,e.value.quantity]]),t("label",{class:l(["label",{"text-red-500":a.value.hasOwnProperty("quantity")}])},"Quantity",2),t("span",Y,d(x.value.baseUnit??"Â "),1)]),a.value.hasOwnProperty("quantity")?(u(),w("p",Z,d(a.value.quantity[0]),1)):y("",!0)])],32)]),footer:m(()=>[t("button",{class:"me-2 btn-blue",disabled:p.value,form:"form"},[R(T,{"is-loading":p.value},{default:m(()=>[C("Save")]),_:1},8,["is-loading"])],8,ee),t("button",{onClick:g,class:"btn-gray"},"Cancel"),c.value===f(i).Edit?(u(),k(f(W),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[3]||(s[3]=o=>e.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):y("",!0)]),_:1})}}});export{re as default};
