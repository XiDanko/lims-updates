import{d as M,u as D,e as p,x as R,Q as v,o as n,R as k,w,k as O,t as d,g as u,b as s,c,a as P,n as o,i,h as f,v as g,f as T,_ as j,a4 as z,m as L,l as W,$ as q}from"./main-DNdNUUJ7.js";import{b as G}from"./toggle-B4ffD-ge.js";import{s as C}from"./multiselect-K4eUN8Nz.js";import{F as m}from"./formMode-Bz--3d4P.js";const H={key:0,class:"relative col-span-2"},J={key:0,class:"text-sm text-red-500"},K={class:"relative"},X={key:0,class:"text-sm text-red-500"},Y={class:"relative"},Z={key:0,class:"text-sm text-red-500"},ee={class:"relative"},ae={key:0,class:"text-sm text-red-500"},te={class:"relative"},se={key:0,class:"text-sm text-red-500"},le={class:"relative col-span-2"},oe=s("label",{class:"label"},"Description",-1),re=["disabled"],pe=M({__name:"ProductForm",emits:["close"],setup(ne,{emit:S}){const B=S,U=L(),Q=W(),b=D().user.branches,e=p({}),_=p([]),h=p(m.Create),y=p(!1),a=p({});R(()=>{b.length===1&&(e.value.branches=[b[0]],x()),U.path.endsWith("/edit")&&(h.value=m.Edit,$(U.params.id))});const $=async r=>{const{data:t}=await v.get(`/api/products/${r}`);e.value=t.data,x()},x=async()=>{const r=e.value.branches.map(l=>l.id).join(","),{data:t}=await v.get(`/api/suggestions/list?branchId=${r}&type=productBaseUnit`);_.value=t.data},N=async({content:r})=>{const{data:t}=await v.post("/api/suggestions",{branches:e.value.branches,type:"productBaseUnit",content:r});return _.value.push(t.data),t.data},I=async()=>{y.value=!0;try{h.value===m.Create?await A():await E(),a.value={},q.fire()}catch(r){a.value=r.response.data.errors??{}}y.value=!1},A=async()=>{await v.post("/api/products",e.value),F()},E=async()=>{await v.patch(`/api/products/${e.value.id}`,e.value),V()},F=()=>{e.value={branchId:e.value.branchId},a.value=[]},V=()=>{B("close"),Q.back()};return(r,t)=>(n(),k(z,{"modal-class":"!w-[50rem]"},{header:w(()=>[O(d(h.value===u(m).Create?"Create New Product":"Edit Product"),1)]),body:w(()=>[s("form",{id:"form",onSubmit:T(I,["prevent","stop"]),class:"grid grid-cols-2 gap-4"},[u(b).length>1?(n(),c("div",H,[P(u(C),{modelValue:e.value.branches,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.branches=l),mode:"tags",options:u(b),searchable:!0,object:!0,"value-prop":"id","track-by":"searchableForm",label:"name",onSelect:t[1]||(t[1]=l=>x()),class:o(["px-0 input peer",{"border-red-500":a.value.hasOwnProperty("branches")}])},null,8,["modelValue","options","class"]),s("label",{class:o(["label",{"text-red-500":a.value.hasOwnProperty("branches")}])},"Branches",2),a.value.hasOwnProperty("branches")?(n(),c("p",J,d(a.value.branches[0]),1)):i("",!0)])):i("",!0),s("div",K,[f(s("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.name=l),class:o(["input peer",{"border-red-500":a.value.hasOwnProperty("name")}])},null,2),[[g,e.value.name]]),s("label",{class:o(["label",{"text-red-500":a.value.hasOwnProperty("name")}])},"Name",2),a.value.hasOwnProperty("name")?(n(),c("p",X,d(a.value.name[0]),1)):i("",!0)]),s("div",Y,[f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.code=l),class:o(["input peer",{"border-red-500":a.value.hasOwnProperty("code")}])},null,2),[[g,e.value.code]]),s("label",{class:o(["label",{"text-red-500":a.value.hasOwnProperty("code")}])},"Code",2),a.value.hasOwnProperty("code")?(n(),c("p",Z,d(a.value.code[0]),1)):i("",!0)]),s("div",ee,[P(u(C),{modelValue:e.value.baseUnit,"onUpdate:modelValue":t[4]||(t[4]=l=>e.value.baseUnit=l),options:_.value,"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":!0,"on-create":N,class:o(["input peer",{"border-red-500":a.value.hasOwnProperty("baseUnit")}])},null,8,["modelValue","options","class"]),s("label",{class:o(["label",{"text-red-500":a.value.hasOwnProperty("baseUnit")}])},"Base Unit",2),a.value.hasOwnProperty("baseUnit")?(n(),c("p",ae,d(a.value.baseUnit[0]),1)):i("",!0)]),s("div",te,[f(s("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=l=>e.value.alertQuantity=l),class:o(["input peer",{"border-red-500":a.value.hasOwnProperty("alertQuantity")}])},null,2),[[g,e.value.alertQuantity]]),s("label",{class:o(["label",{"text-red-500":a.value.hasOwnProperty("alertQuantity")}])},"Alert Quantity",2),a.value.hasOwnProperty("alertQuantity")?(n(),c("p",se,d(a.value.alertQuantity[0]),1)):i("",!0)]),s("div",le,[f(s("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>e.value.description=l),rows:"4",class:"py-2 input peer"},null,512),[[g,e.value.description]]),oe])],32)]),footer:w(()=>[s("button",{class:"me-2 btn-blue",disabled:y.value,form:"form"},[P(j,{"is-loading":y.value},{default:w(()=>[O("Save")]),_:1},8,["is-loading"])],8,re),s("button",{onClick:V,class:"btn-gray"},"Cancel"),h.value===u(m).Edit?(n(),k(u(G),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":t[7]||(t[7]=l=>e.value.isActive=l),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):i("",!0)]),_:1}))}});export{pe as default};
