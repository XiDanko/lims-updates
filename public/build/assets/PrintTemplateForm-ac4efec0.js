import{d as $,f as E,e as W,g as c,u as A,x as j,Q as h,o as l,R as k,w as y,m as T,t as p,i as s,b as a,c as i,a as _,n as g,k as d,j as x,v as I,W as z,h as L,_ as Q,a5 as q,al as G,a0 as H}from"./main-5548143a.js";import{b as B}from"./toggle-af3738b3.js";import{s as C}from"./multiselect-30de6652.js";import{F as m}from"./formMode-f60a729f.js";import{P as n}from"./printTemplateType-09163c2a.js";const J=["onSubmit"],K={key:0,class:"mb-3 flex flex-wrap items-center"},X=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Branch",-1),Y={key:0,class:"ml-28 w-full text-sm text-red-500"},Z={class:"mb-3 flex flex-wrap items-center"},ee=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Name",-1),ae={key:0,class:"ml-28 w-full text-sm text-red-500"},te={class:"mb-3 flex flex-wrap items-center"},re=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Type",-1),se=a("option",{value:void 0,disabled:""},"Select...",-1),oe=["value"],le=["value"],de=["value"],ne=["value"],ue=["value"],ie=["value"],ce={key:0,class:"ml-28 w-full text-sm text-red-500"},pe={key:1,class:"mb-3 flex flex-wrap items-start"},me=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Tests",-1),be={class:"mb-3 flex flex-wrap items-center"},ve=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Report Path",-1),fe={key:0,class:"ml-28 w-full text-sm text-red-500"},he={class:"flex flex-wrap items-center"},ye=a("span",{class:"w-28 rounded-l border border-r-0 border-gray-300 bg-gray-100 p-2"},"Default",-1),_e=["disabled"],ke=$({__name:"PrintTemplateForm",emits:["close"],setup(ge,{emit:R}){const P=E(),O=W(),e=c({}),b=A().user.branches,V=c([]),v=c(m.Create),f=c(!1),r=c({});j(()=>{b.length===1&&(e.value.branchId=b[0].id,w()),P.path.endsWith("/edit")&&(v.value=m.Edit,D(P.params.id))});const D=async u=>{const{data:t}=await h.get(`/api/print-templates/${u}`);e.value=t.data,w()},w=async()=>{const{data:u}=await h.get(`/api/tests/list?branchId=${e.value.branchId}`);V.value=u.data},U=async()=>{f.value=!0;try{v.value===m.Create?await F():await N(),G().fetch(),r.value={},H.fire()}catch(u){r.value=u.response.data.errors??{}}f.value=!1},F=async()=>{await h.post("/api/print-templates",e.value),M()},N=async()=>{await h.patch(`/api/print-templates/${e.value.id}`,e.value),S()},M=()=>{e.value={branchId:e.value.branchId},r.value=[]},S=()=>{R("close"),O.back()};return(u,t)=>(l(),k(q,null,{header:y(()=>[T(p(v.value===s(m).Create?"Create New Print Template":"Edit Print Template"),1)]),body:y(()=>[a("form",{id:"form",onSubmit:L(U,["prevent","stop"])},[s(b).length>1?(l(),i("div",K,[X,_(s(C),{modelValue:e.value.branchId,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.branchId=o),onSelect:w,options:s(b),searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:g(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(l(),i("p",Y,p(r.value.branchId[0]),1)):d("",!0)])):d("",!0),a("div",Z,[ee,x(a("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.name=o),class:g(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[I,e.value.name]]),r.value.hasOwnProperty("name")?(l(),i("p",ae,p(r.value.name[0]),1)):d("",!0)]),a("div",te,[re,x(a("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.type=o),class:g(["flex-1 rounded-r border border-gray-300 px-2 py-1 h-[42px] focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("type")}])},[se,a("option",{value:s(n).VisitBarcode},"Visit Barcode",8,oe),a("option",{value:s(n).SampleBarcode},"Sample Barcode",8,le),a("option",{value:s(n).SampleBarcodeDepWise},"Sample Barcode (Dep. Wise)",8,de),a("option",{value:s(n).Invoice},"Invoice",8,ne),a("option",{value:s(n).Results},"Results",8,ue),a("option",{value:s(n).PremaritalScreeningResult},"Premarital Screening Result",8,ie)],2),[[z,e.value.type]]),r.value.hasOwnProperty("type")?(l(),i("p",ce,p(r.value.type[0]),1)):d("",!0)]),e.value.type===s(n).Results?(l(),i("div",pe,[me,_(s(C),{modelValue:e.value.tests,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.tests=o),mode:"tags",options:V.value,searchable:!0,object:!0,"value-prop":"id",label:"shortForm","track-by":"searchableForm",class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])])):d("",!0),a("div",be,[ve,x(a("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.reportPath=o),class:g(["flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("reportPath")}])},null,2),[[I,e.value.reportPath]]),r.value.hasOwnProperty("reportPath")?(l(),i("p",fe,p(r.value.reportPath[0]),1)):d("",!0)]),a("div",he,[ye,_(s(B),{modelValue:e.value.isDefault,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.isDefault=o),class:"flex-1 rounded-r border border-gray-300 p-2 focus:border-blue-500"},null,8,["modelValue"])])],40,J)]),footer:y(()=>[a("button",{class:"mr-2 btn-blue",disabled:f.value,form:"form"},[_(Q,{"is-loading":f.value},{default:y(()=>[T("Save")]),_:1},8,["is-loading"])],8,_e),a("button",{onClick:S,class:"btn-gray"},"Cancel"),v.value===s(m).Edit?(l(),k(s(B),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.isActive=o),class:"toggle:off:red ml-auto"},null,8,["modelValue"])):d("",!0)]),_:1}))}});export{ke as default};
