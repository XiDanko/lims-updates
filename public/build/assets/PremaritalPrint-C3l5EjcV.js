import{d as Y,e as c,x as j,y as D,o as f,c as y,a as _,b as e,h as k,v as S,a0 as M,t as s,g as t,V as W,w as C,p as a,af as R,Q as z,r as q,k as A,F as V,_ as K,i as B,a1 as E,ae as O,l as G,Y as L,$ as Q,n as T,f as J,T as X}from"./main-DmoZ1fz4.js";import{M as Z}from"./Master-ql31p3jM.js";import{_ as ee}from"./Paginator.vue_vue_type_script_setup_true_lang-B5QeFegy.js";import{u as te}from"./urlQueryManager-DRfC3SWK.js";import{i as se}from"./index.es-CV7LqIVy.js";import{d as ae}from"./datepickerPresets-DxjH1h4T.js";import{_ as oe}from"./BranchFilter.vue_vue_type_script_setup_true_lang-DPeXwSCL.js";import{u as le}from"./bulkSelection-Du3MNG3s.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-DAhRltj6.js";const ne={class:"flex flex-wrap items-center justify-end gap-2"},re={class:"relative flex-1 min-w-[11rem]"},ie={class:"label"},ue={class:"relative flex-1 min-w-[11rem]"},de={class:"label"},ce={class:"relative flex-1 min-w-[11rem]"},me={class:"label"},pe={class:"relative flex-1 min-w-[11rem]"},he={class:"label"},ve={class:"relative"},be={value:""},_e=["value"],ge=["value"],fe={class:"label"},ye={class:"relative flex-1 min-w-[14rem]"},we={class:"label"},xe=Y({__name:"PremaritalPrintFilter",emits:["change"],setup(H,{emit:U}){const $=U,i=new URLSearchParams(location.search),g=c(""),w=c(""),d=c(""),m=c(""),p=c(""),h=c(""),v=c([null,null]);j(()=>I());const x=D(()=>v.value[0]===null||v.value[1]===null?"":`${v.value[0]}~${v.value[1]}`),I=()=>{g.value=i.get("branchId")??"",w.value=i.get("visitNumber")??"",d.value=i.get("status")??"",m.value=i.get("husbandName")??"",p.value=i.get("wifeName")??"",h.value=i.get("phoneNumber")??"",i.get("dateRange")&&(v.value=i.get("dateRange").split("~"))},b=()=>{let N=`branchId=${g.value}&visitNumber=${w.value}&husbandName=${m.value}&wifeName=${p.value}&phoneNumber=${h.value}&status=${d.value}&dateRange=${x.value}&page=1`;$("change",N)};return(N,l)=>(f(),y("div",ne,[_(oe,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=r=>g.value=r),onChange:b},null,8,["modelValue"]),e("div",re,[k(e("input",{"onUpdate:modelValue":l[1]||(l[1]=r=>w.value=r),onKeyup:M(b,["enter"]),type:"text",class:"input-sm peer"},null,544),[[S,w.value]]),e("label",ie,s(t(a)("Registration Number")),1)]),e("div",ue,[k(e("input",{"onUpdate:modelValue":l[2]||(l[2]=r=>m.value=r),onKeyup:M(b,["enter"]),type:"text",class:"input-sm peer"},null,544),[[S,m.value]]),e("label",de,s(t(a)("Husband Name")),1)]),e("div",ce,[k(e("input",{"onUpdate:modelValue":l[3]||(l[3]=r=>p.value=r),onKeyup:M(b,["enter"]),type:"text",class:"input-sm peer"},null,544),[[S,p.value]]),e("label",me,s(t(a)("Wife Name")),1)]),e("div",pe,[k(e("input",{"onUpdate:modelValue":l[4]||(l[4]=r=>h.value=r),onKeyup:M(b,["enter"]),type:"text",class:"input-sm peer"},null,544),[[S,h.value]]),e("label",he,s(t(a)("Phone Number")),1)]),e("div",ve,[k(e("select",{"onUpdate:modelValue":l[5]||(l[5]=r=>d.value=r),onChange:b,class:"input-sm peer"},[e("option",be,s(t(a)("All")),1),e("option",{value:t(R).Authorized},s(t(a)("Authorized")),9,_e),e("option",{value:t(R).Printed},s(t(a)("Printed")),9,ge)],544),[[W,d.value]]),e("label",fe,s(t(a)("Status")),1)]),e("div",ye,[_(t(se),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:t(ae),value:v.value,"onUpdate:value":l[6]||(l[6]=r=>v.value=r),onChange:b,class:"w-full peer","input-class":"input-sm pt-0.5"},{"icon-calendar":C(()=>[]),_:1},8,["shortcuts","value"]),e("label",we,s(t(a)("Date")),1)])]))}}),$e={class:"mb-5 flex flex-wrap items-start gap-2"},ke=["disabled"],Ce=["disabled"],Ne={class:"w-full"},Pe={class:"sticky top-0 z-10 ltr:text-left rtl:text-right"},Se={class:"bg-gray-600 p-2 font-semibold text-white first-of-type:rounded-ss"},Me={class:"flex items-center justify-center"},Re=["checked"],Ue={class:"bg-gray-600 p-2 font-semibold text-white"},Ie={class:"bg-gray-600 p-2 font-semibold text-white"},ze={class:"bg-gray-600 p-2 font-semibold text-white"},Ae={class:"bg-gray-600 p-2 font-semibold text-white"},Ve={class:"bg-gray-600 p-2 font-semibold text-white"},Be={class:"bg-gray-600 p-2 font-semibold text-white"},De={class:"bg-gray-600 p-2 font-semibold text-white rounded-se"},Fe=["onClick"],Ke={class:"flex items-center justify-center"},Le=["checked","onChange"],Qe={class:"border border-gray-200 p-1"},Te={class:"border border-gray-200 p-1"},Ye={class:"border border-gray-200 p-1"},je={class:"border border-gray-200 p-1"},He={class:"border border-gray-200 p-1"},We={class:"border border-gray-200 p-1"},qe={class:"border border-gray-200 p-1"},ot=Y({__name:"PremaritalPrint",setup(H){const{updateUrlQuery:U}=te(),{hasPermissionTo:$}=X(),i=c([]),g=c({}),w=G(),d=le(),m=D(()=>i.value.filter(u=>d.selectedRecordsIds.value.has(u.id))),p=c(!1),h=c(!1);j(()=>x(location.search));const v=D(()=>m.value.length===0?"height: calc(100vh - 15.7rem)":"height: calc(100vh - 18.4rem)"),x=async u=>{const n=await U(u),{data:P}=await z.get(`/api/premarital/print?${n}`);i.value=P.data,g.value=P.meta},I=u=>u===R.Authorized?"border-s-gray-300":"border-s-emerald-500",b=u=>u===R.Authorized?"hover:bg-gray-300 hover:text-black":"hover:bg-emerald-500 hover:text-white",N=u=>{$("PremaritalResult.print")&&w.push(`/premarital/print/${u}`)},l=async()=>{const{isConfirmed:u}=await L.fire();if(u){p.value=!0;try{await z.post("/api/premarital/results/send",{premaritalVisitsIds:m.value.flatMap(n=>n.id)}),Q.fire(),d.clear()}catch{}p.value=!1}},r=async()=>{const{isConfirmed:u}=await L.fire();if(u){h.value=!0;try{await z.post("/api/premarital/results/upload",{premaritalVisitsIds:m.value.flatMap(n=>n.id)}),Q.fire(),d.clear()}catch{}h.value=!1}};return(u,n)=>{const P=q("router-view");return f(),y(V,null,[_(P,{onClose:x}),_(Z,null,{header:C(()=>[A(s(t(a)("Premarital Print")),1)]),body:C(()=>[e("div",$e,[_(xe,{onChange:x}),m.value.length>0?(f(),y(V,{key:0},[t($)("PremaritalResult.send")?(f(),y("button",{key:0,onClick:l,class:"btn-teal",disabled:p.value},[_(K,{"is-loading":p.value},{default:C(()=>[A(s(t(a)("Send")),1)]),_:1},8,["is-loading"])],8,ke)):B("",!0),t($)("PremaritalResult.upload")?(f(),y("button",{key:1,onClick:r,class:"btn-blue",disabled:h.value},[_(K,{"is-loading":h.value},{default:C(()=>[A(s(t(a)("Upload")),1)]),_:1},8,["is-loading"])],8,Ce)):B("",!0),e("button",{onClick:n[0]||(n[0]=o=>t(d).clear()),class:"btn-gray"},s(t(a)("Clear")),1)],64)):B("",!0)]),e("section",{class:"overflow-y-auto pe-1",style:O(v.value)},[e("table",Ne,[e("thead",null,[e("tr",Pe,[e("th",Se,[e("label",Me,[e("input",{type:"checkbox",checked:t(d).isAllSelected(i.value),onChange:n[1]||(n[1]=o=>t(d).toggleAll(i.value,o.target.checked)),class:"h-4 w-4 rounded checked:accent-blue-500"},null,40,Re)])]),e("th",Ue,s(t(a)("No.")),1),e("th",Ie,s(t(a)("Husband Name")),1),e("th",ze,s(t(a)("Wife Name")),1),e("th",Ae,s(t(a)("Message Status")),1),e("th",Ve,s(t(a)("Upload Status")),1),e("th",Be,s(t(a)("Date")),1),e("th",De,s(t(a)("Branch")),1)])]),e("tbody",null,[(f(!0),y(V,null,E(i.value,o=>(f(),y("tr",{class:T(["cursor-pointer transition group even:bg-gray-100",b(o.status)]),onClick:F=>N(o.id)},[e("td",{class:T(["border border-gray-200 p-1 border-s-[5px]",I(o.status)]),onClick:n[2]||(n[2]=J(()=>{},["stop"]))},[e("label",Ke,[e("input",{type:"checkbox",checked:t(d).isSelected(o),onChange:F=>t(d).toggle(o,F.target.checked),class:"h-4 w-4 rounded checked:accent-blue-500"},null,40,Le)])],2),e("td",Qe,s(o.number),1),e("td",Te,s(o.husbandInformation.name),1),e("td",Ye,s(o.wifeInformation.name),1),e("td",je,s(t(a)(o.messageStatus?.startCase())),1),e("td",He,s(t(a)(o.uploadStatus?.startCase())),1),e("td",We,s(o.date),1),e("td",qe,s(o.branch.name),1)],10,Fe))),256))])])],4)]),_:1}),_(ee,{data:g.value,onChange:n[3]||(n[3]=o=>x(`page=${o}`)),class:"mt-3"},null,8,["data"])],64)}}});export{ot as default};
