import{d as X,e as w,x as Z,E as G,bW as Y,s as ve,o as l,C as me,w as V,b as e,a as y,V as ee,i as d,u as be,y as A,A as F,B as he,c as n,k as J,t as c,g as o,n as v,h as m,J as C,v as P,F as j,D as fe,f as _e,_ as ge,m as ye,l as we,S as xe}from"./main-c1f62c61.js";import{b as K}from"./toggle-b89396fa.js";import{s as M}from"./multiselect-ffe70d49.js";import{F as h}from"./formMode-f60a729f.js";import{G as z}from"./gender-fe0bd233.js";import{R as E}from"./rangeType-b75ca402.js";import{_ as Ve}from"./Tinymce.vue_vue_type_script_setup_true_lang-a7834caa.js";var f=(p=>(p.Days="days",p.Months="months",p.Yeas="years",p))(f||{}),R=(p=>(p.Before="before",p.After="after",p.During="during",p))(R||{}),$=(p=>(p.GT=">",p.LT="<",p.EQ="=",p.Range="<>",p))($||{});const ke=e("h1",null,"Range Notes",-1),Ie={id:"form"},Fe=X({__name:"ReferenceRangeNotesModal",setup(p){const O=w(!1),k=w({});Z(()=>{G.on(Y.Show,async({range:s})=>{k.value=s,O.value=!0})}),ve(()=>G.off(Y.Show));const B=()=>{O.value=!1};return(s,I)=>O.value?(l(),me(ee,{key:0,"modal-class":"!w-[56rem]"},{header:V(()=>[ke]),body:V(()=>[e("form",Ie,[y(Ve,{modelValue:k.value.notes,"onUpdate:modelValue":I[0]||(I[0]=D=>k.value.notes=D),class:"h-[400px]"},null,8,["modelValue"])])]),footer:V(()=>[e("button",{onClick:B,class:"btn-gray"},"Close")]),_:1})):d("",!0)}}),Pe=["onSubmit"],Ce={class:"grid grid-cols-4 gap-3 mb-3"},Oe={key:0,class:"flex flex-wrap items-start"},Te=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),$e={key:0,class:"ml-24 w-full text-red-500 text-sm"},De={class:"flex flex-wrap items-start"},Ue=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Test",-1),Me={class:"truncate"},Re={key:0,class:"ml-24 w-full text-red-500 text-sm"},Be={class:"flex flex-wrap items-start"},Ne=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Parameter",-1),Se={class:"truncate"},Ae={key:0,class:"ml-24 w-full text-red-500 text-sm"},ze={class:"flex flex-wrap items-start"},Ee=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Machine",-1),Ge={key:0,class:"ml-24 w-full text-red-500 text-sm"},Ye={class:"flex flex-wrap items-start"},Le=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Gender",-1),He=["value"],We=["value"],Qe={key:0,value:"both"},qe={key:0,class:"ml-24 w-full text-red-500 text-sm"},Je={class:"flex flex-wrap items-start"},je=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Age From",-1),Ke=["value"],Xe=["value"],Ze=["value"],es={key:0,class:"ml-24 w-full text-red-500 text-sm"},ss={class:"flex flex-wrap items-start"},as=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Age To",-1),rs=["value"],ts=["value"],os=["value"],ls={key:0,class:"ml-24 w-full text-red-500 text-sm"},ns={key:1,class:"flex flex-wrap items-start"},ds=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Fasting",-1),us={class:"flex flex-wrap items-start"},is=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Unit",-1),cs={key:0,class:"ml-24 w-full text-red-500 text-sm"},ps={key:0,class:"grid grid-cols-3 gap-3 mb-3"},vs={class:"flex flex-wrap items-start"},ms=e("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Menses Duration",-1),bs=["value"],hs=["value"],fs=["value"],_s={key:0,class:"ml-36 w-full text-red-500 text-sm"},gs={class:"flex flex-wrap items-start"},ys=e("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Menses From",-1),ws=e("span",{class:"p-2 border border-gray-300 border-l-0 rounded-r bg-gray-100"},"Days",-1),xs={key:0,class:"ml-36 w-full text-red-500 text-sm"},Vs={class:"flex flex-wrap items-start"},ks=e("span",{class:"w-36 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Menses To",-1),Is=e("span",{class:"p-2 border border-gray-300 border-l-0 rounded-r bg-gray-100"},"Days",-1),Fs={key:0,class:"ml-36 w-full text-red-500 text-sm"},Ps=e("hr",null,null,-1),Cs=e("h2",{class:"text-center text-2xl font-bold mt-2 mb-3"},"Ranges",-1),Os={class:"grid grid-cols-12 gap-3 mb-3"},Ts={class:"col-span-2 flex flex-wrap items-start"},$s=e("span",{class:"w-20 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Operator",-1),Ds=["onUpdate:modelValue"],Us=["value"],Ms=["value"],Rs=["value"],Bs=["value"],Ns={key:0,class:"ml-20 w-full text-red-500 text-sm"},Ss={class:"col-span-2 flex flex-wrap items-start"},As=e("span",{class:"w-24 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Value",-1),zs=["onUpdate:modelValue"],Es={key:0,class:"ml-24 w-full text-red-500 text-sm"},Gs={class:"col-span-2 flex flex-wrap items-start"},Ys=e("span",{class:"w-20 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Type",-1),Ls=["onUpdate:modelValue"],Hs=["value"],Ws=["value"],Qs=["value"],qs={key:0,class:"ml-20 w-full text-red-500 text-sm"},Js={class:"col-span-2 flex flex-wrap items-start"},js=e("span",{class:"w-20 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"INTPN",-1),Ks=["onUpdate:modelValue"],Xs={key:0,class:"ml-20 w-full text-red-500 text-sm"},Zs={class:"col-span-3 flex flex-wrap items-start"},ea=e("span",{class:"w-20 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Notes",-1),sa={class:"flex items-center flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},aa=["onClick"],ra={class:"mt-2"},ta={class:"flex items-center"},oa=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"w-5 h-5"},[e("path",{d:"M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"})],-1),la=[oa],na=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"w-5 h-5"},[e("path",{d:"M400 288h-352c-17.69 0-32-14.32-32-32.01s14.31-31.99 32-31.99h352c17.69 0 32 14.3 32 31.99S417.7 288 400 288z"})],-1),da=[na],ua=["disabled"],fa=X({__name:"ReferenceRangeForm",emits:["close"],setup(p,{emit:O}){const k=ye(),B=we(),s=w({ranges:[{isNotesVisible:!0}]}),I=be().user.branches,D=w([]),T=w([]),L=w([]),u=w({from:{unit:f.Days},to:{unit:f.Days}}),_=w(h.Create),U=w(!1),r=w({});Z(()=>{I.length===1&&(s.value.branchId=I[0].id,N()),k.path.endsWith("/edit")&&(_.value=h.Edit),k.path.endsWith("/clone")&&(_.value=h.Clone),_.value!==h.Create&&ae(k.params.id)});const se=A(()=>{if(_.value===h.Create)return"Create Reference Range";if(_.value===h.Clone)return"Clone Reference Range";if(_.value===h.Edit)return"Update Reference Range"}),ae=async i=>{const{data:t}=await F.get(`/api/reference-ranges/${i}`);s.value=t.data,N(),W(t.data.testId),H(t.data.test.departmentId);const x=s.value.ageFrom.split(" "),a=s.value.ageTo.split(" ");u.value.from.value=x[0],u.value.from.unit=x[1],u.value.to.value=a[0],u.value.to.unit=a[1]},H=async i=>{const{data:t}=await F.get(`/api/machines/list?departmentId=${i}`);L.value=t.data},N=async()=>{const{data:i}=await F.get(`/api/tests/list?branchId=${s.value.branchId}`);T.value=i.data},W=async i=>{const{data:t}=await F.get(`/api/parameters/list?testId=${i}`);D.value=t.data},re=i=>{const t=T.value.find(x=>x.id===i).departmentId;W(i),H(t)},Q=()=>{s.value.parameterId=null,s.value.machineId=null},te=()=>{s.value.testId=null,Q()},oe=A(()=>{const i=T.value.find(t=>t.id===s.value.testId);return i?i.affectedByMenses&&s.value.gender===z.Female:!1}),le=A(()=>{const i=T.value.find(t=>t.id===s.value.testId);return i?i.affectedByFasting:!1}),ne=()=>{u.value.from.value&&(s.value.ageFrom=`${u.value.from.value} ${u.value.from.unit}`),u.value.to.value&&(s.value.ageTo=`${u.value.to.value} ${u.value.to.unit}`)},de=async()=>{U.value=!0,ne();try{_.value===h.Create?await ue():_.value===h.Clone?await ie():_.value===h.Edit&&await ce(),xe.fire()}catch(i){r.value=i.response.data.errors??{}}U.value=!1},ue=async()=>{await F.post("/api/reference-ranges",s.value),pe()},ie=async()=>{await F.post("/api/reference-ranges",s.value),S()},ce=async()=>{await F.patch(`/api/reference-ranges/${s.value.id}`,s.value),S()},q=()=>{s.value.mensesDuration=null,s.value.mensesFrom=null,s.value.mensesTo=null},pe=()=>{s.value={branchId:s.value.branchId,testId:s.value.testId,parameterId:s.value.parameterId,machineId:s.value.machineId,unit:s.value.unit,ranges:s.value.ranges},u.value={from:{unit:f.Days},to:{unit:f.Days}},r.value=[]},S=()=>{O("close"),B.back()};return(i,t)=>{const x=he("maska");return l(),n(j,null,[y(ee,{"modal-class":"!w-[90rem]"},{header:V(()=>[J(c(o(se)),1)]),body:V(()=>[e("form",{id:"form",onSubmit:_e(de,["prevent","stop"])},[e("div",Ce,[o(I).length>1?(l(),n("div",Oe,[Te,y(o(M),{modelValue:s.value.branchId,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.branchId=a),options:o(I),onSelect:N,onChange:te,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:v(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(l(),n("p",$e,c(r.value.branchId[0]),1)):d("",!0)])):d("",!0),e("div",De,[Ue,y(o(M),{modelValue:s.value.testId,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.testId=a),onSelect:re,onChange:Q,options:T.value,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:v(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("testId")}])},{option:V(({option:a})=>[e("span",Me,c(a.shortForm),1)]),_:1},8,["modelValue","options","class"]),r.value.hasOwnProperty("testId")?(l(),n("p",Re,c(r.value.testId[0]),1)):d("",!0)]),e("div",Be,[Ne,y(o(M),{modelValue:s.value.parameterId,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.parameterId=a),options:D.value,onChange:q,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:v(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("parameterId")}])},{option:V(({option:a})=>[e("span",Se,c(a.shortForm),1)]),_:1},8,["modelValue","options","class"]),r.value.hasOwnProperty("parameterId")?(l(),n("p",Ae,c(r.value.parameterId[0]),1)):d("",!0)]),e("div",ze,[Ee,y(o(M),{modelValue:s.value.machineId,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.machineId=a),options:L.value,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name",class:v(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("machineId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("machineId")?(l(),n("p",Ge,c(r.value.machineId[0]),1)):d("",!0)]),e("div",Ye,[Le,m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.gender=a),onChange:q,class:v(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("gender")}])},[e("option",{value:o(z).Male},"Male",8,He),e("option",{value:o(z).Female},"Female",8,We),_.value===o(h).Create?(l(),n("option",Qe,"Both")):d("",!0)],34),[[C,s.value.gender]]),r.value.hasOwnProperty("gender")?(l(),n("p",qe,c(r.value.gender[0]),1)):d("",!0)]),e("div",Je,[je,m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.from.value=a),size:"1","data-maska":"0","data-maska-tokens":"0:[0-9]:multiple",class:v(["flex-1 p-2 border border-gray-300 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("ageFrom")}])},null,2),[[P,u.value.from.value],[x]]),m(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.from.unit=a),class:"px-2 py-1 h-[42px] border border-gray-300 border-l-0 rounded-r"},[e("option",{value:o(f).Days},"Days",8,Ke),e("option",{value:o(f).Months},"Months",8,Xe),e("option",{value:o(f).Yeas},"Years",8,Ze)],512),[[C,u.value.from.unit]]),r.value.hasOwnProperty("ageFrom")?(l(),n("p",es,c(r.value.ageFrom[0]),1)):d("",!0)]),e("div",ss,[as,m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>u.value.to.value=a),size:"1","data-maska":"0","data-maska-tokens":"0:[0-9]:multiple",class:v(["flex-1 p-2 border border-gray-300 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("ageTo")}])},null,2),[[P,u.value.to.value],[x]]),m(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>u.value.to.unit=a),class:"px-2 py-1 h-[42px] border border-gray-300 border-l-0 rounded-r"},[e("option",{value:o(f).Days},"Days",8,rs),e("option",{value:o(f).Months},"Months",8,ts),e("option",{value:o(f).Yeas},"Years",8,os)],512),[[C,u.value.to.unit]]),r.value.hasOwnProperty("ageFrom")?(l(),n("p",ls,c(r.value.ageTo[0]),1)):d("",!0)]),o(le)?(l(),n("div",ns,[ds,y(o(K),{modelValue:s.value.isFasting,"onUpdate:modelValue":t[9]||(t[9]=a=>s.value.isFasting=a),"on-label":"Yes","off-label":"No",class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,8,["modelValue"])])):d("",!0),e("div",us,[is,m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>s.value.unit=a),size:"1",class:v(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("unit")}])},null,2),[[P,s.value.unit]]),r.value.hasOwnProperty("unit")?(l(),n("p",cs,c(r.value.unit[0]),1)):d("",!0)])]),o(oe)?(l(),n("div",ps,[e("div",vs,[ms,m(e("select",{"onUpdate:modelValue":t[11]||(t[11]=a=>s.value.mensesDuration=a),class:v(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("mensesDuration")}])},[e("option",{value:o(R).Before},"Before",8,bs),e("option",{value:o(R).During},"During",8,hs),e("option",{value:o(R).After},"After",8,fs)],2),[[C,s.value.mensesDuration]]),r.value.hasOwnProperty("mensesDuration")?(l(),n("p",_s,c(r.value.mensesDuration[0]),1)):d("",!0)]),e("div",gs,[ys,m(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>s.value.mensesFrom=a),size:"1","data-maska":"##",class:v(["flex-1 p-2 border border-gray-300 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("mensesFrom")}])},null,2),[[P,s.value.mensesFrom],[x]]),ws,r.value.hasOwnProperty("mensesFrom")?(l(),n("p",xs,c(r.value.mensesFrom[0]),1)):d("",!0)]),e("div",Vs,[ks,m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>s.value.mensesTo=a),size:"1","data-maska":"##",class:v(["flex-1 p-2 border border-gray-300 focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("mensesTo")}])},null,2),[[P,s.value.mensesTo],[x]]),Is,r.value.hasOwnProperty("mensesTo")?(l(),n("p",Fs,c(r.value.mensesTo[0]),1)):d("",!0)])])):d("",!0),Ps,Cs,(l(!0),n(j,null,fe(s.value.ranges,(a,b)=>(l(),n("div",Os,[e("div",Ts,[$s,m(e("select",{"onUpdate:modelValue":g=>a.operator=g,class:v(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty(`ranges.${b}.operator`)}])},[e("option",{value:o($).GT},"Greater Than",8,Us),e("option",{value:o($).LT},"Less Than",8,Ms),e("option",{value:o($).EQ},"Equal",8,Rs),e("option",{value:o($).Range},"Between",8,Bs)],10,Ds),[[C,a.operator]]),r.value.hasOwnProperty(`ranges.${b}.operator`)?(l(),n("p",Ns,c(r.value[`ranges.${b}.operator`][0]),1)):d("",!0)]),e("div",Ss,[As,m(e("input",{"onUpdate:modelValue":g=>a.value=g,size:"1",class:v(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty(`ranges.${b}.value`)}])},null,10,zs),[[P,a.value]]),r.value.hasOwnProperty(`ranges.${b}.value`)?(l(),n("p",Es,c(r.value[`ranges.${b}.value`][0]),1)):d("",!0)]),e("div",Gs,[Ys,m(e("select",{"onUpdate:modelValue":g=>a.type=g,class:v(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty(`ranges.${b}.type`)}])},[e("option",{value:o(E).Normal},"Normal",8,Hs),e("option",{value:o(E).Abnormal},"Abnormal",8,Ws),e("option",{value:o(E).Critical},"Critical",8,Qs)],10,Ls),[[C,a.type]]),r.value.hasOwnProperty(`ranges.${b}.type`)?(l(),n("p",qs,c(r.value[`ranges.${b}.type`][0]),1)):d("",!0)]),e("div",Js,[js,m(e("input",{"onUpdate:modelValue":g=>a.interpretation=g,size:"1",class:v(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty(`ranges.${b}.interpretation`)}])},null,10,Ks),[[P,a.interpretation]]),r.value.hasOwnProperty(`ranges.${b}.interpretation`)?(l(),n("p",Xs,c(r.value[`ranges.${b}.interpretation`][0]),1)):d("",!0)]),e("div",Zs,[ea,e("div",sa,[e("span",{onClick:g=>o(G).emit(o(Y).Show,{range:a}),class:"cursor-pointer transition p-1 text-xs rounded text-white bg-teal-500 hover:bg-teal-600"},"Open Editor",8,aa)])]),e("div",ra,[y(o(K),{modelValue:a.isNotesVisible,"onUpdate:modelValue":g=>a.isNotesVisible=g,class:"toggle:w-4","on-label":"Visible","off-label":"Hidden"},null,8,["modelValue","onUpdate:modelValue"])])]))),256)),e("div",ta,[e("span",{class:"transition bg-emerald-500 rounded p-1 text-white mr-2 hover:bg-emerald-600 hover:shadow",onClick:t[14]||(t[14]=a=>s.value.ranges.push({isNotesVisible:!0}))},la),e("span",{class:"transition bg-red-500 rounded p-1 text-white hover:bg-red-600 hover:shadow",onClick:t[15]||(t[15]=a=>s.value.ranges.pop())},da)])],40,Pe)]),footer:V(()=>[e("button",{class:"btn-blue mr-2",disabled:U.value,form:"form"},[y(ge,{"is-loading":U.value},{default:V(()=>[J("Save")]),_:1},8,["is-loading"])],8,ua),e("button",{onClick:S,class:"btn-gray"},"Cancel")]),_:1}),y(Fe)],64)}}});export{fa as default};
