import{M as nt}from"./Master-c2e1e299.js";import{d as y,e as L,x as g,y as x,o as _,c as m,a as f,w as A,g as H,C as b,z as it,A as w,b as v,B as R,D as ot,E as p,G as lt,H as dt,I as ut,J as X,K as C,L as ct,P as pt,M as vt,N as ft,O as ht,Q as _t,R as yt,S as gt}from"./main-6e47ceb6.js";import{i as mt}from"./index.es-2384e375.js";import{d as xt}from"./datepickerPresets-82697600.js";import{_ as bt}from"./BranchFilter.vue_vue_type_script_setup_true_lang-d104a2b1.js";import{u as wt}from"./urlQueryManager-757a21bf.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-27b4da8b.js";const $t={class:"flex gap-2 items-center justify-center text-base text-gray-600 font-normal"},kt=y({__name:"DashboardFilter",emits:["change"],setup(a,{emit:e}){const t=new URLSearchParams(location.search),r=L(""),s=L([null,null]);g(()=>i());const n=x(()=>s.value[0]===null||s.value[1]===null?"":`${s.value[0]}~${s.value[1]}`),i=()=>{r.value=t.get("branchId")??"",t.get("dateRange")&&(s.value=t.get("dateRange").split("~"))},o=()=>{let d=`branchId=${r.value}&dateRange=${n.value}`;e("change",d)};return(d,l)=>(_(),m("div",$t,[f(bt,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=u=>r.value=u),onChange:o},null,8,["modelValue"]),f(H(mt),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:H(xt),placeholder:"Select date range",value:s.value,"onUpdate:value":l[1]||(l[1]=u=>s.value=u),onChange:o,clearable:!1,class:"!w-56","input-class":"w-full p-1.5 border border-gray-300 rounded focus:border-blue-500"},{"icon-calendar":A(()=>[]),_:1},8,["shortcuts","value"])]))}});b.register(...it);const St=v("canvas",{id:"visitsStatistics"},null,-1),Mt=[St],Pt=y({__name:"VisitsStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(e.data.newPatients)}% New Patients`,`${r(e.data.recurringPatients)}%  Recurring Patients`],datasets:[{data:[e.data.newPatients,e.data.recurringPatients]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Total Visits: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("visitsStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,Mt))}}),Ct=v("canvas",{id:"visitsChart"},null,-1),Et=[Ct],It=y({__name:"VisitsChart",props:{data:null},setup(a){const e=a;let t=null;const r=x(()=>({type:"line",data:{labels:e.data.totalVisits.map(s=>s.label),datasets:[{label:"New Patients",data:e.data.newPatients.map(s=>s.count)},{label:"Recurring Patients",data:e.data.recurringPatients.map(s=>s.count)},{label:"Total Visits",data:e.data.totalVisits.map(s=>s.count)}]},options:{responsive:!0,interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,text:"Visits Chart"}}}}));return g(()=>{t=new b(document.getElementById("visitsChart"),r.value)}),w(e,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),m("div",null,Et))}}),Rt=v("canvas",{id:"testsStatistics"},null,-1),Tt=[Rt],Bt=y({__name:"TestsStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:e.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:e.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Ordered Tests: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("testsStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,Tt))}}),Nt=v("canvas",{id:"packagesStatistics"},null,-1),Ot=[Nt],Dt=y({__name:"PackagesStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:e.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:e.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Ordered Packages: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("packagesStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,Ot))}}),At=v("canvas",{id:"ordersStatistics"},null,-1),Lt=[At],Ft=y({__name:"OrdersStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(e.data.tests)}% Tests`,`${r(e.data.packages)}%  Packages`,`${r(e.data.services)}%  Services`],datasets:[{data:[e.data.tests,e.data.packages,e.data.services]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Total Orders: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("ordersStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,Lt))}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Y=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var a=window.screen;if(a)return(a.deviceXDPI||1)/(a.logicalXDPI||1)}return 1}(),E={toTextLines:function(a){var e=[],t;for(a=[].concat(a);a.length;)t=a.pop(),typeof t=="string"?e.unshift.apply(e,t.split(`
`)):Array.isArray(t)?a.push.apply(a,t):C(a)||e.unshift(""+t);return e},textSize:function(a,e,t){var r=[].concat(e),s=r.length,n=a.font,i=0,o;for(a.font=t.string,o=0;o<s;++o)i=Math.max(a.measureText(r[o]).width,i);return a.font=n,{height:s*t.lineHeight,width:i}},bound:function(a,e,t){return Math.max(a,Math.min(e,t))},arrayDiff:function(a,e){var t=a.slice(),r=[],s,n,i,o;for(s=0,i=e.length;s<i;++s)o=e[s],n=t.indexOf(o),n===-1?r.push([o,1]):t.splice(n,1);for(s=0,i=t.length;s<i;++s)r.push([t[s],-1]);return r},rasterize:function(a){return Math.round(a*Y)/Y}};function j(a,e){var t=e.x,r=e.y;if(t===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var s=a.x-t,n=a.y-r,i=Math.sqrt(s*s+n*n);return{x:i?s/i:0,y:i?n/i:-1}}function zt(a,e,t,r,s){switch(s){case"center":t=r=0;break;case"bottom":t=0,r=1;break;case"right":t=1,r=0;break;case"left":t=-1,r=0;break;case"top":t=0,r=-1;break;case"start":t=-t,r=-r;break;case"end":break;default:s*=Math.PI/180,t=Math.cos(s),r=Math.sin(s);break}return{x:a,y:e,vx:t,vy:r}}var jt=0,q=1,J=2,K=4,Z=8;function B(a,e,t){var r=jt;return a<t.left?r|=q:a>t.right&&(r|=J),e<t.top?r|=Z:e>t.bottom&&(r|=K),r}function Ut(a,e){for(var t=a.x0,r=a.y0,s=a.x1,n=a.y1,i=B(t,r,e),o=B(s,n,e),d,l,u;!(!(i|o)||i&o);)d=i||o,d&Z?(l=t+(s-t)*(e.top-r)/(n-r),u=e.top):d&K?(l=t+(s-t)*(e.bottom-r)/(n-r),u=e.bottom):d&J?(u=r+(n-r)*(e.right-t)/(s-t),l=e.right):d&q&&(u=r+(n-r)*(e.left-t)/(s-t),l=e.left),d===i?(t=l,r=u,i=B(t,r,e)):(s=l,n=u,o=B(s,n,e));return{x0:t,x1:s,y0:r,y1:n}}function N(a,e){var t=e.anchor,r=a,s,n;return e.clamp&&(r=Ut(r,e.area)),t==="start"?(s=r.x0,n=r.y0):t==="end"?(s=r.x1,n=r.y1):(s=(r.x0+r.x1)/2,n=(r.y0+r.y1)/2),zt(s,n,a.vx,a.vy,e.align)}var O={arc:function(a,e){var t=(a.startAngle+a.endAngle)/2,r=Math.cos(t),s=Math.sin(t),n=a.innerRadius,i=a.outerRadius;return N({x0:a.x+r*n,y0:a.y+s*n,x1:a.x+r*i,y1:a.y+s*i,vx:r,vy:s},e)},point:function(a,e){var t=j(a,e.origin),r=t.x*a.options.radius,s=t.y*a.options.radius;return N({x0:a.x-r,y0:a.y-s,x1:a.x+r,y1:a.y+s,vx:t.x,vy:t.y},e)},bar:function(a,e){var t=j(a,e.origin),r=a.x,s=a.y,n=0,i=0;return a.horizontal?(r=Math.min(a.x,a.base),n=Math.abs(a.base-a.x)):(s=Math.min(a.y,a.base),i=Math.abs(a.base-a.y)),N({x0:r,y0:s+i,x1:r+n,y1:s,vx:t.x,vy:t.y},e)},fallback:function(a,e){var t=j(a,e.origin);return N({x0:a.x,y0:a.y,x1:a.x+(a.width||0),y1:a.y+(a.height||0),vx:t.x,vy:t.y},e)}},k=E.rasterize;function Vt(a){var e=a.borderWidth||0,t=a.padding,r=a.size.height,s=a.size.width,n=-s/2,i=-r/2;return{frame:{x:n-t.left-e,y:i-t.top-e,w:s+t.width+e*2,h:r+t.height+e*2},text:{x:n,y:i,w:s,h:r}}}function Wt(a,e){var t=e.chart.getDatasetMeta(e.datasetIndex).vScale;if(!t)return null;if(t.xCenter!==void 0&&t.yCenter!==void 0)return{x:t.xCenter,y:t.yCenter};var r=t.getBasePixel();return a.horizontal?{x:r,y:null}:{x:null,y:r}}function Gt(a){return a instanceof ct?O.arc:a instanceof pt?O.point:a instanceof vt?O.bar:O.fallback}function Ht(a,e,t,r,s,n){var i=Math.PI/2;if(n){var o=Math.min(n,s/2,r/2),d=e+o,l=t+o,u=e+r-o,c=t+s-o;a.moveTo(e,l),d<u&&l<c?(a.arc(d,l,o,-Math.PI,-i),a.arc(u,l,o,-i,0),a.arc(u,c,o,0,i),a.arc(d,c,o,i,Math.PI)):d<u?(a.moveTo(d,t),a.arc(u,l,o,-i,i),a.arc(d,l,o,i,Math.PI+i)):l<c?(a.arc(d,l,o,-Math.PI,0),a.arc(d,c,o,0,Math.PI)):a.arc(d,l,o,-Math.PI,Math.PI),a.closePath(),a.moveTo(e,t)}else a.rect(e,t,r,s)}function Yt(a,e,t){var r=t.backgroundColor,s=t.borderColor,n=t.borderWidth;!r&&(!s||!n)||(a.beginPath(),Ht(a,k(e.x)+n/2,k(e.y)+n/2,k(e.w)-n,k(e.h)-n,t.borderRadius),a.closePath(),r&&(a.fillStyle=r,a.fill()),s&&n&&(a.strokeStyle=s,a.lineWidth=n,a.lineJoin="miter",a.stroke()))}function Qt(a,e,t){var r=t.lineHeight,s=a.w,n=a.x,i=a.y+r/2;return e==="center"?n+=s/2:(e==="end"||e==="right")&&(n+=s),{h:r,w:s,x:n,y:i}}function Xt(a,e,t){var r=a.shadowBlur,s=t.stroked,n=k(t.x),i=k(t.y),o=k(t.w);s&&a.strokeText(e,n,i,o),t.filled&&(r&&s&&(a.shadowBlur=0),a.fillText(e,n,i,o),r&&s&&(a.shadowBlur=r))}function qt(a,e,t,r){var s=r.textAlign,n=r.color,i=!!n,o=r.font,d=e.length,l=r.textStrokeColor,u=r.textStrokeWidth,c=l&&u,$;if(!(!d||!i&&!c))for(t=Qt(t,s,o),a.font=o.string,a.textAlign=s,a.textBaseline="middle",a.shadowBlur=r.textShadowBlur,a.shadowColor=r.textShadowColor,i&&(a.fillStyle=n),c&&(a.lineJoin="round",a.lineWidth=u,a.strokeStyle=l),$=0,d=e.length;$<d;++$)Xt(a,e[$],{stroked:c,filled:i,w:t.w,x:t.x,y:t.y+t.h*$})}var tt=function(a,e,t,r){var s=this;s._config=a,s._index=r,s._model=null,s._rects=null,s._ctx=e,s._el=t};R(tt.prototype,{_modelize:function(a,e,t,r){var s=this,n=s._index,i=ot(p([t.font,{}],r,n)),o=p([t.color,lt.color],r,n);return{align:p([t.align,"center"],r,n),anchor:p([t.anchor,"center"],r,n),area:r.chart.chartArea,backgroundColor:p([t.backgroundColor,null],r,n),borderColor:p([t.borderColor,null],r,n),borderRadius:p([t.borderRadius,0],r,n),borderWidth:p([t.borderWidth,0],r,n),clamp:p([t.clamp,!1],r,n),clip:p([t.clip,!1],r,n),color:o,display:a,font:i,lines:e,offset:p([t.offset,4],r,n),opacity:p([t.opacity,1],r,n),origin:Wt(s._el,r),padding:dt(p([t.padding,4],r,n)),positioner:Gt(s._el),rotation:p([t.rotation,0],r,n)*(Math.PI/180),size:E.textSize(s._ctx,e,i),textAlign:p([t.textAlign,"start"],r,n),textShadowBlur:p([t.textShadowBlur,0],r,n),textShadowColor:p([t.textShadowColor,o],r,n),textStrokeColor:p([t.textStrokeColor,o],r,n),textStrokeWidth:p([t.textStrokeWidth,0],r,n)}},update:function(a){var e=this,t=null,r=null,s=e._index,n=e._config,i,o,d,l=p([n.display,!0],a,s);l&&(i=a.dataset.data[s],o=ut(X(n.formatter,[i,a]),i),d=C(o)?[]:E.toTextLines(o),d.length&&(t=e._modelize(l,d,n,a),r=Vt(t))),e._model=t,e._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(a,e){var t=this,r=a.ctx,s=t._model,n=t._rects,i;this.visible()&&(r.save(),s.clip&&(i=s.area,r.beginPath(),r.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),r.clip()),r.globalAlpha=E.bound(0,s.opacity,1),r.translate(k(e.x),k(e.y)),r.rotate(s.rotation),Yt(r,n.frame,s),qt(r,s.lines,n.text,s),r.restore())}});var Jt=Number.MIN_SAFE_INTEGER||-9007199254740991,Kt=Number.MAX_SAFE_INTEGER||9007199254740991;function P(a,e,t){var r=Math.cos(t),s=Math.sin(t),n=e.x,i=e.y;return{x:n+r*(a.x-n)-s*(a.y-i),y:i+s*(a.x-n)+r*(a.y-i)}}function Q(a,e){var t=Kt,r=Jt,s=e.origin,n,i,o,d,l;for(n=0;n<a.length;++n)i=a[n],o=i.x-s.x,d=i.y-s.y,l=e.vx*o+e.vy*d,t=Math.min(t,l),r=Math.max(r,l);return{min:t,max:r}}function D(a,e){var t=e.x-a.x,r=e.y-a.y,s=Math.sqrt(t*t+r*r);return{vx:(e.x-a.x)/s,vy:(e.y-a.y)/s,origin:a,ln:s}}var et=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};R(et.prototype,{center:function(){var a=this._rect;return{x:a.x+a.w/2,y:a.y+a.h/2}},update:function(a,e,t){this._rotation=t,this._rect={x:e.x+a.x,y:e.y+a.y,w:e.w,h:e.h}},contains:function(a){var e=this,t=1,r=e._rect;return a=P(a,e.center(),-e._rotation),!(a.x<r.x-t||a.y<r.y-t||a.x>r.x+r.w+t*2||a.y>r.y+r.h+t*2)},intersects:function(a){var e=this._points(),t=a._points(),r=[D(e[0],e[1]),D(e[0],e[3])],s,n,i;for(this._rotation!==a._rotation&&r.push(D(t[0],t[1]),D(t[0],t[3])),s=0;s<r.length;++s)if(n=Q(e,r[s]),i=Q(t,r[s]),n.max<i.min||i.max<n.min)return!1;return!0},_points:function(){var a=this,e=a._rect,t=a._rotation,r=a.center();return[P({x:e.x,y:e.y},r,t),P({x:e.x+e.w,y:e.y},r,t),P({x:e.x+e.w,y:e.y+e.h},r,t),P({x:e.x,y:e.y+e.h},r,t)]}});function at(a,e,t){var r=e.positioner(a,e),s=r.vx,n=r.vy;if(!s&&!n)return{x:r.x,y:r.y};var i=t.w,o=t.h,d=e.rotation,l=Math.abs(i/2*Math.cos(d))+Math.abs(o/2*Math.sin(d)),u=Math.abs(i/2*Math.sin(d))+Math.abs(o/2*Math.cos(d)),c=1/Math.max(Math.abs(s),Math.abs(n));return l*=s*c,u*=n*c,l+=e.offset*s,u+=e.offset*n,{x:r.x+l,y:r.y+u}}function Zt(a,e){var t,r,s,n;for(t=a.length-1;t>=0;--t)for(s=a[t].$layout,r=t-1;r>=0&&s._visible;--r)n=a[r].$layout,n._visible&&s._box.intersects(n._box)&&e(s,n);return a}function te(a){var e,t,r,s,n,i,o;for(e=0,t=a.length;e<t;++e)r=a[e],s=r.$layout,s._visible&&(o=new Proxy(r._el,{get:(d,l)=>d.getProps([l],!0)[l]}),n=r.geometry(),i=at(o,r.model(),n),s._box.update(i,n,r.rotation()));return Zt(a,function(d,l){var u=d._hidable,c=l._hidable;u&&c||c?l._visible=!1:u&&(d._visible=!1)})}var I={prepare:function(a){var e=[],t,r,s,n,i;for(t=0,s=a.length;t<s;++t)for(r=0,n=a[t].length;r<n;++r)i=a[t][r],e.push(i),i.$layout={_box:new et,_hidable:!1,_visible:!0,_set:t,_idx:i._index};return e.sort(function(o,d){var l=o.$layout,u=d.$layout;return l._idx===u._idx?u._set-l._set:u._idx-l._idx}),this.update(e),e},update:function(a){var e=!1,t,r,s,n,i;for(t=0,r=a.length;t<r;++t)s=a[t],n=s.model(),i=s.$layout,i._hidable=n&&n.display==="auto",i._visible=s.visible(),e|=i._hidable;e&&te(a)},lookup:function(a,e){var t,r;for(t=a.length-1;t>=0;--t)if(r=a[t].$layout,r&&r._visible&&r._box.contains(e))return a[t];return null},draw:function(a,e){var t,r,s,n,i,o;for(t=0,r=e.length;t<r;++t)s=e[t],n=s.$layout,n._visible&&(i=s.geometry(),o=at(s._el,s.model(),i),n._box.update(o,i,s.rotation()),s.draw(a,o))}},ee=function(a){if(C(a))return null;var e=a,t,r,s;if(ht(a))if(!C(a.label))e=a.label;else if(!C(a.r))e=a.r;else for(e="",t=Object.keys(a),s=0,r=t.length;s<r;++s)e+=(s!==0?", ":"")+t[s]+": "+a[t[s]];return""+e},ae={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:ee,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},h="$datalabels",rt="$default";function re(a,e){var t=a.datalabels,r={},s=[],n,i;return t===!1?null:(t===!0&&(t={}),e=R({},[e,t]),n=e.labels||{},i=Object.keys(n),delete e.labels,i.length?i.forEach(function(o){n[o]&&s.push(R({},[e,n[o],{_key:o}]))}):s.push(e),r=s.reduce(function(o,d){return ft(d.listeners||{},function(l,u){o[u]=o[u]||{},o[u][d._key||rt]=l}),delete d.listeners,o},{}),{labels:s,listeners:r})}function U(a,e,t,r){if(e){var s=t.$context,n=t.$groups,i;e[n._set]&&(i=e[n._set][n._key],i&&X(i,[s,r])===!0&&(a[h]._dirty=!0,t.update(s)))}}function se(a,e,t,r,s){var n,i;!t&&!r||(t?r?t!==r&&(i=n=!0):i=!0:n=!0,i&&U(a,e.leave,t,s),n&&U(a,e.enter,r,s))}function ne(a,e){var t=a[h],r=t._listeners,s,n;if(!(!r.enter&&!r.leave)){if(e.type==="mousemove")n=I.lookup(t._labels,e);else if(e.type!=="mouseout")return;s=t._hovered,t._hovered=n,se(a,r,s,n,e)}}function ie(a,e){var t=a[h],r=t._listeners.click,s=r&&I.lookup(t._labels,e);s&&U(a,r,s,e)}var oe={id:"datalabels",defaults:ae,beforeInit:function(a){a[h]={_actives:[]}},beforeUpdate:function(a){var e=a[h];e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(a,e,t){var r=e.index,s=a[h],n=s._datasets[r]=[],i=a.isDatasetVisible(r),o=a.data.datasets[r],d=re(o,t),l=e.meta.data||[],u=a.ctx,c,$,V,W,F,G,M,S;for(u.save(),c=0,V=l.length;c<V;++c)if(M=l[c],M[h]=[],i&&M&&a.getDataVisibility(c)&&!M.skip)for($=0,W=d.labels.length;$<W;++$)F=d.labels[$],G=F._key,S=new tt(F,u,M,c),S.$groups={_set:r,_key:G||rt},S.$context={active:!1,chart:a,dataIndex:c,dataset:o,datasetIndex:r},S.update(S.$context),M[h].push(S),n.push(S);u.restore(),R(s._listeners,d.listeners,{merger:function(T,z,st){z[T]=z[T]||{},z[T][e.index]=st[T],s._listened=!0}})},afterUpdate:function(a){a[h]._labels=I.prepare(a[h]._datasets)},afterDatasetsDraw:function(a){I.draw(a,a[h]._labels)},beforeEvent:function(a,e){if(a[h]._listened){var t=e.event;switch(t.type){case"mousemove":case"mouseout":ne(a,t);break;case"click":ie(a,t);break}}},afterEvent:function(a){var e=a[h],t=e._actives,r=e._actives=a.getActiveElements(),s=E.arrayDiff(t,r),n,i,o,d,l,u,c;for(n=0,i=s.length;n<i;++n)if(l=s[n],l[1])for(c=l[0].element[h]||[],o=0,d=c.length;o<d;++o)u=c[o],u.$context.active=l[1]===1,u.update(u.$context);(e._dirty||s.length)&&(I.update(e._labels),a.render()),delete e._dirty}};const le=v("canvas",{id:"ordersChart"},null,-1),de=[le],ue=y({__name:"OrdersChart",props:{data:null},setup(a){const e=a;let t=null;const r=x(()=>({type:"bar",data:{labels:e.data.testsOrders.map(s=>s.label),datasets:[{label:"Tests Orders",data:e.data.testsOrders.map(s=>s.count)},{label:"Packages Orders",data:e.data.packagesOrders.map(s=>s.count)},{label:"Services Orders",data:e.data.servicesOrders.map(s=>s.count)},{label:"Total Orders",data:e.data.totalOrders.map(s=>s.count),type:"line"}]},plugins:[oe],options:{responsive:!0,interaction:{mode:"index"},scales:{x:{stacked:!0},y:{stacked:!0}},plugins:{title:{display:!0,text:"Orders Chart"}}}}));return g(()=>{t=new b(document.getElementById("ordersChart"),r.value)}),w(e,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),m("div",null,de))}}),ce=v("canvas",{id:"topRegistrationUsers"},null,-1),pe=[ce],ve=y({__name:"TopRegistrationUsers",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:e.data.top.map(n=>`${r(n.count)}% ${n.name}`),datasets:[{data:e.data.top.map(n=>n.count)}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Top Registration Users"}}}}));return g(()=>{t=new b(document.getElementById("topRegistrationUsers"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,pe))}}),fe=v("canvas",{id:"profitStatistics"},null,-1),he=[fe],_e=y({__name:"ProfitStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=x(()=>({type:"pie",data:{labels:["Income","Expenses"],datasets:[{data:[e.data.income,e.data.expenses]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Profit: ${e.data.profit.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("profitStatistics"),r.value)}),w(e,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),m("div",null,he))}}),ye=v("canvas",{id:"expensesStatistics"},null,-1),ge=[ye],me=y({__name:"ExpensesStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(e.data.general)}% General`,`${r(e.data.rates)}% Rates`,`${r(e.data.costs)}% Costs`],datasets:[{data:[e.data.general,e.data.rates,e.data.costs]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Expenses: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("expensesStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,ge))}}),xe=v("canvas",{id:"transactionsStatistics"},null,-1),be=[xe],we=y({__name:"TransactionsStatistics",props:{data:null},setup(a){const e=a;let t=null;const r=n=>{const i=n/e.data.total*100;return isNaN(i)?0:i.toFixed()},s=x(()=>({type:"pie",data:{labels:[`${r(e.data.payments)}% Payments`,`${r(e.data.discounts)}% Discounts`,`${r(e.data.refunds)}% Refunds`],datasets:[{data:[e.data.payments,e.data.discounts,e.data.refunds]}]},options:{responsive:!0,plugins:{title:{display:!0,text:`Transactions: ${e.data.total.toLocaleString()}`}}}}));return g(()=>{t=new b(document.getElementById("transactionsStatistics"),s.value)}),w(e,()=>{t.options=s.value.options,t.data=s.value.data,t.update()}),(n,i)=>(_(),m("div",null,be))}}),$e=v("canvas",{id:"profitChart"},null,-1),ke=[$e],Se=y({__name:"profitChart",props:{data:null},setup(a){const e=a;let t=null;const r=x(()=>({type:"line",data:{labels:e.data.profit.map(s=>s.label),datasets:[{label:"Income",data:e.data.income.map(s=>s.count)},{label:"Expenses",data:e.data.expenses.map(s=>s.count)},{label:"Profit",data:e.data.profit.map(s=>s.count),fill:!0}]},options:{responsive:!0,interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,text:"Visits Chart"}}}}));return g(()=>{t=new b(document.getElementById("profitChart"),r.value)}),w(e,()=>{t.options=r.value.options,t.data=r.value.data,t.update()}),(s,n)=>(_(),m("div",null,ke))}}),Me={class:"flex items-center justify-between"},Pe=v("h1",null,"Dashboard",-1),Ce={class:"pr-1 h-[calc(100vh-9rem)] overflow-y-auto"},Ee={class:"grid grid-cols-12 gap-5"},Le=y({__name:"Dashboard",setup(a){const{updateUrlQuery:e}=wt(),t=L(!0),r=L([]);g(async()=>s(location.search));const s=async n=>{const i=await e(n),{data:o}=await _t.get(`/api/dashboard?${i}`);r.value=o,t.value=!1};return(n,i)=>(_(),yt(nt,null,gt({header:A(()=>[v("div",Me,[Pe,f(kt,{onChange:s})])]),_:2},[t.value?{name:"body",fn:A(()=>[v("div",{class:"h-[calc(100vh-8.6rem)] flex flex-col items-center justify-center gap-5"},[(_(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"w-24 animate-spin"},[v("path",{d:"M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"})])),v("span",{class:"text-4xl"},"Generating Dashboard...")])]),key:"1"}:{name:"body",fn:A(()=>[v("section",Ce,[v("div",Ee,[f(Pt,{data:r.value.visitsStatistics,class:"col-span-3 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(It,{data:r.value.visitsChart,class:"col-span-6 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(ve,{data:r.value.topRegistrationUsers,class:"col-span-3 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(Bt,{data:r.value.testsStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(Dt,{data:r.value.packagesStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(Ft,{data:r.value.ordersStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(ue,{data:r.value.ordersChart,class:"col-span-12 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(_e,{data:r.value.profitStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(me,{data:r.value.expensesStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(we,{data:r.value.transactionsStatistics,class:"col-span-4 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"]),f(Se,{data:r.value.profitChart,class:"col-span-12 flex items-center p-5 border border-gray-200 shadow-md rounded-lg bg-gray-50"},null,8,["data"])])])]),key:"0"}]),1024))}});export{Le as default};
