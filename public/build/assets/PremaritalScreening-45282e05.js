import{d as q,g as w,x as J,y as ee,o as n,c,a as S,j as k,W as O,b as t,t as o,i as e,v as Q,a1 as Y,w as M,p as a,Y as te,Q as B,r as se,V as oe,m as ae,R as j,k as p,F as U,a2 as ne,h as C,n as E,a3 as le,a4 as re,T as de,a0 as H}from"./main-bf2af1c2.js";import{M as ie}from"./Master-fd48b992.js";import{_ as ue}from"./Paginator.vue_vue_type_script_setup_true_lang-ae9d2a51.js";import{u as ce}from"./urlQueryManager-97734f58.js";import{u as pe,P as L,p as V}from"./websocketPrint-798d7766.js";import{u as he}from"./printTemplateManager-971d338c.js";import{i as ve}from"./index.es-d69483ac.js";import{d as be}from"./datepickerPresets-09eddff9.js";import{_ as me}from"./BranchFilter.vue_vue_type_script_setup_true_lang-7984eace.js";import{P as W}from"./premaritalScreeningUploadStatus-600ff545.js";import{O as T}from"./orderStatus-e3a3f9a7.js";import{A as _e}from"./ActivityLogSidebar-27791482.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./multiselect-4f06085e.js";const fe={class:"rtl:mr-auto ltr:ml-auto flex flex-wrap items-center gap-2"},we={value:""},ye={value:"pending"},xe={value:"completed"},ge={value:""},Ce=["value"],ke=["value"],$e=["value"],Pe=["onKeyup","placeholder"],Ie=["onKeyup","placeholder"],Re=q({__name:"PremaritalScreeningFilter",emits:["change"],setup(G,{emit:A}){const _=new URLSearchParams(location.search),P=w(""),I=w(""),R=w(""),d=w(""),y=w(""),x=w([null,null]);J(()=>z());const f=ee(()=>x.value[0]===null||x.value[1]===null?"":`${x.value[0]}~${x.value[1]}`),z=()=>{P.value=_.get("branchId")??"",I.value=_.get("resultsStatus")??"",R.value=_.get("uploadStatus")??"",d.value=_.get("husbandName")??"",y.value=_.get("wifeName")??"",_.get("dateRange")&&(x.value=_.get("dateRange").split("~"))},g=()=>{let l=`branchId=${P.value}&resultsStatus=${I.value}&uploadStatus=${R.value}&husbandName=${d.value}&wifeName=${y.value}&dateRange=${f.value}&page=1`;A("change",l)};return(l,h)=>(n(),c("div",fe,[S(me,{modelValue:P.value,"onUpdate:modelValue":h[0]||(h[0]=v=>P.value=v),onChange:g},null,8,["modelValue"]),k(t("select",{"onUpdate:modelValue":h[1]||(h[1]=v=>I.value=v),onChange:g,class:"px-2 h-[38px] border border-gray-300 !rounded"},[t("option",we,o(e(a)("Results Status")),1),t("option",ye,o(e(a)("Pending")),1),t("option",xe,o(e(a)("Completed")),1)],544),[[O,I.value]]),k(t("select",{"onUpdate:modelValue":h[2]||(h[2]=v=>R.value=v),onChange:g,class:"px-2 h-[38px] border border-gray-300 !rounded"},[t("option",ge,o(e(a)("Upload Status")),1),t("option",{value:e(W).Pending},o(e(a)("Pending")),9,Ce),t("option",{value:e(W).Succeeded},o(e(a)("Succeeded")),9,ke),t("option",{value:e(W).Failed},o(e(a)("Failed")),9,$e)],544),[[O,R.value]]),k(t("input",{"onUpdate:modelValue":h[3]||(h[3]=v=>d.value=v),onKeyup:Y(g,["enter"]),type:"text",placeholder:e(a)("Husband name"),class:"w-56 rounded border border-gray-300 p-1.5 focus:border-blue-500"},null,40,Pe),[[Q,d.value]]),k(t("input",{"onUpdate:modelValue":h[4]||(h[4]=v=>y.value=v),onKeyup:Y(g,["enter"]),type:"text",placeholder:e(a)("Wife name"),class:"w-56 rounded border border-gray-300 p-1.5 focus:border-blue-500"},null,40,Ie),[[Q,y.value]]),S(e(ve),{range:"",lang:{formatLocale:{firstDayOfWeek:6}},type:"date","value-type":"format",format:"YYYY-MM-DD",shortcuts:e(be),placeholder:e(a)("Select date range"),value:x.value,"onUpdate:value":h[5]||(h[5]=v=>x.value=v),onChange:g,class:"!w-56","input-class":"w-full rounded border border-gray-300 p-1.5 focus:border-blue-500"},{"icon-calendar":M(()=>[]),_:1},8,["shortcuts","placeholder","value"])]))}}),Be={class:"mb-5 flex flex-wrap items-center gap-2"},Me=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",class:"h-4 w-4"},[t("path",{d:"M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"})],-1),Se={class:"font-semibold"},He={class:"pr-1 h-[calc(100vh-15.7rem)] overflow-y-auto"},We={class:"w-full"},Ae={class:"sticky top-0 z-10 ltr:text-left rtl:text-right"},ze={class:"ltr:rounded-tl rtl:rounded-tr bg-gray-600 p-2 font-semibold text-white"},De={class:"bg-gray-600 p-2 font-semibold text-white"},Ne={class:"bg-gray-600 p-2 font-semibold text-white"},Ue={class:"bg-gray-600 p-2 font-semibold text-white"},Le={class:"bg-gray-600 p-2 font-semibold text-white"},Ve={class:"bg-gray-600 p-2 font-semibold text-white"},Te={class:"bg-gray-600 p-2 text-center font-semibold text-white"},je={class:"bg-gray-600 p-2 text-center font-semibold text-white"},Fe={class:"bg-gray-600 p-2 font-semibold text-white"},Ke={class:"bg-gray-600 p-2 font-semibold text-white"},Oe={key:1,class:"rtl:rounded-tl ltr:rounded-tr bg-gray-600 p-2 font-semibold text-white"},Qe={class:"transition even:bg-gray-100"},Ye={class:"border border-gray-200 p-1"},Ee={class:"border border-gray-200 p-1"},qe={class:"border border-gray-200 p-1 rtl:text-right",dir:"ltr"},Je={class:"border border-gray-200 p-1"},Ge={class:"border border-gray-200 p-1"},Xe={class:"border border-gray-200 p-1"},Ze={class:"border border-gray-200 p-1"},et={class:"flex flex-wrap items-center justify-center gap-1"},tt=["onClick","onContextmenu","disabled"],st=["onClick","onContextmenu","disabled"],ot=["onClick","onContextmenu","disabled"],at=["onClick","onContextmenu","disabled"],nt={class:"border border-gray-200 p-1"},lt={class:"flex flex-wrap items-center justify-center gap-1"},rt=["onClick","onContextmenu","disabled"],dt=["onClick","onContextmenu","disabled"],it=["onClick","onContextmenu","disabled"],ut=["onClick","onContextmenu","disabled"],ct={class:"border border-gray-200 p-1"},pt={class:"border border-gray-200 p-1"},ht={key:1,class:"border border-gray-200 px-2 py-1 text-center"},vt={class:"flex justify-center gap-2"},bt=t("svg",{class:"h-6 w-6 cursor-pointer text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})],-1),mt=["onClick","onContextmenu","disabled"],_t=t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),ft=[_t],wt=["onClick","disabled"],yt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-6 w-6"},[t("path",{d:"M9.25 13.25a.75.75 0 001.5 0V4.636l2.955 3.129a.75.75 0 001.09-1.03l-4.25-4.5a.75.75 0 00-1.09 0l-4.25 4.5a.75.75 0 101.09 1.03L9.25 4.636v8.614z"}),t("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),xt=[yt],gt=t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Ct=["onClick"],kt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"h-5 w-5"},[t("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"})],-1),$t=[kt],Vt=q({__name:"PremaritalScreening",setup(G){const{hasDefaultDepWiseBarcodeTemplate:A,hasDefaultSampleWiseBarcodeTemplate:_,hasDefaultInvoiceTemplate:P,hasDefaultVisitBarcodeTemplate:I}=he(),{updateUrlQuery:R}=ce(),{hasPermissionTo:d,hasAnyPermission:y}=de(),x=te(),f=pe(),z=w([]),g=w({}),l=w(!1),h=w(!1);J(()=>v(location.search));const v=async i=>{const b=await R(i),{data:r}=await B.get(`/api/premarital-screening?${b}`);z.value=r.data,g.value=r.meta},F=i=>{const b=!!i.husbandVisit.orders.find(m=>![T.Authorized,T.Released].includes(m.status)),r=!!i.wifeVisit.orders.find(m=>![T.Authorized,T.Released].includes(m.status));return!(b||r)},$=async(i,b,r=!1)=>{l.value=!0;const{data:m}=await B.post("/api/samples/print",{type:b,visitId:i.id});f.isConnected&&!r?f.submit({type:L.Barcodes,url:"barcode.pdf",file_content:m}):V({printable:m,type:"pdf",base64:!0}),H.fire(),l.value=!1},D=async(i,b=!1)=>{l.value=!0;const{data:r}=await B.post("/api/visits/print-barcode",{visitId:i.id});f.isConnected&&!b?f.submit({type:L.Barcodes,url:"barcode.pdf",file_content:r}):V({printable:r,type:"pdf",base64:!0}),H.fire(),l.value=!1},N=async(i,b=!1)=>{l.value=!0;const{data:r}=await B.post("/api/invoices/print",{invoiceId:i.id});f.isConnected&&!b?f.submit({type:L.Invoices,url:"invoice.pdf",file_content:r}):V({printable:r,type:"pdf",base64:!0}),H.fire(),l.value=!1},K=async(i,b=!1)=>{l.value=!0;const{data:r}=await B.post(`/api/premarital-screening/${i.id}/print`);f.isConnected&&!b?f.submit({type:L.Results,url:"result.pdf",file_content:r}):V({printable:r,type:"pdf",base64:!0}),H.fire(),l.value=!1},X=async i=>{h.value=!0,await B.post(`/api/premarital-screening/${i.id}/upload`),H.fire(),h.value=!1,v(location.search)},Z=i=>!x.data.premaritalScreeningPortal?.find(r=>r.branchId===i.branchId)?.enabled||i.uploadStatus===W.Succeeded?!1:d("PremaritalScreeningResult.upload")&&F(i);return(i,b)=>{const r=se("router-link"),m=oe("tip");return n(),c(U,null,[S(ie,null,{header:M(()=>[ae(o(e(a)("Premarital Screening Visits")),1)]),body:M(()=>[t("div",Be,[e(d)("PremaritalScreeningVisit.create")?(n(),j(r,{key:0,to:"/premarital-screening/create",class:"inline-flex items-center gap-1 btn-blue"},{default:M(()=>[Me,t("span",Se,o(e(a)("Create New Visit")),1)]),_:1})):p("",!0),S(Re,{onChange:v})]),t("section",He,[t("table",We,[t("thead",null,[t("tr",Ae,[t("th",ze,o(e(a)("Husband Name")),1),t("th",De,o(e(a)("Wife Name")),1),t("th",Ne,o(e(a)("Phone")),1),t("th",Ue,o(e(a)("Husband Address")),1),t("th",Le,o(e(a)("Wife Address")),1),t("th",Ve,o(e(a)("Upload Status")),1),e(y)("Invoice.print","Sample.print","Visit.printBarcode")?(n(),c(U,{key:0},[t("th",Te,o(e(a)("Husband Print")),1),t("th",je,o(e(a)("Wife Print")),1)],64)):p("",!0),t("th",Fe,o(e(a)("Date")),1),t("th",Ke,o(e(a)("Branch")),1),e(y)("PremaritalScreeningVisit.update","PremaritalScreeningResult.show","PremaritalScreeningResult.print","PremaritalScreeningResult.upload","ActivityLog.list")?(n(),c("th",Oe)):p("",!0)])]),t("tbody",null,[(n(!0),c(U,null,ne(z.value,s=>(n(),c("tr",Qe,[t("td",Ye,o(s.husbandInformation.name),1),t("td",Ee,o(s.wifeInformation.name),1),t("td",qe,o(s.phoneNumber),1),t("td",Je,o(s.husbandInformation.address),1),t("td",Ge,o(s.wifeInformation.address),1),t("td",Xe,o(e(a)(s.uploadStatus.capitalize())),1),e(y)("Invoice.print","Sample.print")?(n(),c(U,{key:0},[t("td",Ze,[t("div",et,[e(d)("Visit.printBarcode")&&e(I)(s.branchId)?(n(),c("button",{key:0,onClick:u=>D(s.husbandVisit),onContextmenu:C(u=>D(s.husbandVisit,!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Visit barcode",40,tt)):p("",!0),e(d)("Sample.print")&&e(A)(s.branchId)?(n(),c("button",{key:1,onClick:u=>$(s.husbandVisit,"departmentWise"),onContextmenu:C(u=>$(s.husbandVisit,"departmentWise",!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Dep. wise",40,st)):p("",!0),e(d)("Sample.print")&&e(_)(s.branchId)?(n(),c("button",{key:2,onClick:u=>$(s.husbandVisit,"sampleWise"),onContextmenu:C(u=>$(s.husbandVisit,"sampleWise",!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Sample wise",40,ot)):p("",!0),e(d)("Invoice.print")&&e(P)(s.branchId)?(n(),c("button",{key:3,onClick:u=>N(s.husbandVisit.invoice),onContextmenu:C(u=>N(s.husbandVisit.invoice,!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Invoice",40,at)):p("",!0)])]),t("td",nt,[t("div",lt,[e(d)("Visit.printBarcode")&&e(I)(s.branchId)?(n(),c("button",{key:0,onClick:u=>D(s.wifeVisit),onContextmenu:C(u=>D(s.wifeVisit,!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Visit barcode",40,rt)):p("",!0),e(d)("Sample.print")&&e(A)(s.branchId)?(n(),c("button",{key:1,onClick:u=>$(s.wifeVisit,"departmentWise"),onContextmenu:C(u=>$(s.wifeVisit,"departmentWise",!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Dep. wise",40,dt)):p("",!0),e(d)("Sample.print")&&e(_)(s.branchId)?(n(),c("button",{key:2,onClick:u=>$(s.wifeVisit,"sampleWise"),onContextmenu:C(u=>$(s.wifeVisit,"sampleWise",!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Sample wise",40,it)):p("",!0),e(d)("Invoice.print")&&e(P)(s.branchId)?(n(),c("button",{key:3,onClick:u=>N(s.wifeVisit.invoice),onContextmenu:C(u=>N(s.wifeVisit.invoice,!0),["prevent"]),class:"px-1 py-0 text-sm btn-blue hover:shadow-none",disabled:l.value},"Invoice",40,ut)):p("",!0)])])],64)):p("",!0),t("td",ct,o(s.date),1),t("td",pt,o(s.branch.name),1),e(y)("PremaritalScreeningVisit.update","PremaritalScreeningResult.show","PremaritalScreeningResult.print","PremaritalScreeningResult.upload","ActivityLog.list")?(n(),c("td",ht,[t("div",vt,[e(d)("PremaritalScreeningResult.show")?k((n(),j(r,{key:0,to:`/premarital-screening/${s.id}/result`,class:"cursor-pointer text-orange-500"},{default:M(()=>[bt]),_:2},1032,["to"])),[[m,e(a)("View Result")]]):p("",!0),e(d)("PremaritalScreeningResult.print")&&F(s)?k((n(),c("button",{key:1,onClick:u=>K(s),onContextmenu:C(u=>K(s,!0),["prevent"]),disabled:l.value,class:E(["text-blue-500",{"text-blue-500/80":l.value}])},ft,42,mt)),[[m,e(a)("Print")]]):p("",!0),Z(s)?k((n(),c("button",{key:2,onClick:u=>X(s),disabled:h.value,class:E(["text-blue-500",{"text-blue-500/80":h.value}])},xt,10,wt)),[[m,e(a)("Upload")]]):p("",!0),e(d)("PremaritalScreeningVisit.update")&&s.uploadStatus!==e(W).Succeeded?k((n(),j(r,{key:3,to:`/premarital-screening/${s.id}/edit`,class:"cursor-pointer text-orange-500"},{default:M(()=>[gt]),_:2},1032,["to"])),[[m,e(a)("Edit")]]):p("",!0),e(d)("ActivityLog.list")?k((n(),c("button",{key:4,onClick:u=>e(le).emit(e(re).Show,s.id),class:"cursor-pointer text-gray-600"},$t,8,Ct)),[[m,"View Activities"]]):p("",!0)])])):p("",!0)]))),256))])])])]),_:1}),S(ue,{data:g.value,onChange:b[0]||(b[0]=s=>v(`page=${s}`)),class:"mt-3"},null,8,["data"]),S(_e)],64)}}});export{Vt as default};
