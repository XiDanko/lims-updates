import{d as x,g as n,x as _,s as B,y as I,o as u,c as r,b as $,ae as E,a1 as i,n as c,af as K,F as S,a2 as q,k as H,h as M,t as z,Q as A}from"./main-5548143a.js";const L=["value","onKeyup","onKeydown"],F=["onMouseover"],N={inheritAttrs:!1},Q=x({...N,__name:"Autocomplete",props:{modelValue:{},endpoint:{},query:{},limit:{},label:{},maxHeight:{},parentClasses:{},listClasses:{}},emits:["update:modelValue","select"],setup(g,{emit:h}){const s=g,a=n([]),t=n(-1),d=n(0),m=n(null);_(()=>{const e=document.querySelector(".autocomplete input");d.value=e.offsetHeight,document.addEventListener("mousedown",p)}),B(()=>document.removeEventListener("mousedown",p));const p=e=>m.value=e.target,w=I(()=>({"max-height":(s.maxHeight??200)+"px",top:d.value+"px"})),C=async()=>{if(t.value=-1,s.modelValue===""){l();return}const{data:e}=await A.get(`${s.endpoint}&${s.query}=${s.modelValue}`);a.value=s.limit?e.data.splice(0,s.limit):e.data},b=()=>{m.value!==document.querySelector("li.selected")&&l()},k=()=>{t.value<a.value.length-1&&t.value++},V=()=>{t.value>0&&t.value--},v=()=>{if(a.value.length!==0){if(t.value===-1){l();return}h("select",a.value[t.value]),l()}},l=()=>{a.value=[]};return(e,y)=>(u(),r("div",{class:c(["relative autocomplete",e.parentClasses])},[$("input",E({type:"text",value:e.modelValue},e.$attrs,{class:{"!rounded-b-none":a.value.length!==0},onInput:y[0]||(y[0]=o=>e.$emit("update:modelValue",o.target.value)),onKeyup:[i(C,["space"]),i(k,["down"]),i(V,["up"])],onKeydown:i(M(v,["prevent"]),["enter"]),onBlur:b}),null,16,L),a.value.length!==0?(u(),r("ul",{key:0,class:c(["absolute inset-x-0 z-50 overflow-y-auto rounded-b bg-white shadow",e.listClasses]),style:K(w.value)},[(u(!0),r(S,null,q(a.value,(o,f)=>(u(),r("li",{key:o.id,onMouseover:D=>t.value=f,onClick:v,class:c(["cursor-pointer px-2 py-1",{"selected bg-gray-100":f===t.value}])},z(o[e.label]),43,F))),128))],6)):H("",!0)],2))}});export{Q as _};
