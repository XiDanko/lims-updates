import{d as L,e as d,u as Q,x as q,Q as p,o as u,R as S,w as y,k,t as f,g as l,b as t,c as v,a as m,i as c,h as V,v as T,n as i,V as G,f as H,_ as J,a4 as K,m as X,l as Y,aI as Z,$ as ee}from"./main-DNdNUUJ7.js";import{b as R}from"./toggle-B4ffD-ge.js";import{s as B}from"./multiselect-K4eUN8Nz.js";import{F as h}from"./formMode-Bz--3d4P.js";import{P as n}from"./printTemplateType-BiK7zB0k.js";import{_ as te}from"./BranchSelect.vue_vue_type_script_setup_true_lang-BebEpNal.js";const ae={key:0,class:"relative"},se={class:"relative"},le={key:0,class:"text-sm text-red-500"},oe={class:"relative"},re=t("option",{value:void 0,disabled:""},"Select...",-1),ne=["value"],ie=["value"],ue=["value"],de=["value"],pe=["value"],ce=["value"],ve=["value"],me=["value"],he=["value"],be={key:0,class:"text-sm text-red-500"},_e={key:1,class:"relative"},ye={class:"relative"},fe={key:0,class:"text-sm text-red-500"},Pe={class:"relative"},ge={class:"relative"},we=t("label",{class:"label"},"Default",-1),Ve=["disabled"],Be=L({__name:"PrintTemplateForm",emits:["close"],setup(xe,{emit:C}){const D=C,x=X(),U=Y(),e=d({}),P=Q().user.branches,O=d([]),g=d([]),b=d(h.Create),_=d(!1),s=d({});q(()=>{P.length===1&&(e.value.branchId=P[0].id,w()),x.path.endsWith("/edit")&&(b.value=h.Edit,$(x.params.id))});const $=async r=>{const{data:a}=await p.get(`/api/print-templates/${r}`);e.value=a.data,w()},w=()=>{F(),M()},N=()=>{e.value.tests=[],e.value.printer=null},F=async()=>{const{data:r}=await p.get(`/api/tests/list?branchId=${e.value.branchId}`);O.value=r.data},M=async()=>{const{data:r}=await p.get(`/api/suggestions/list?branchId=${e.value.branchId}&type=printer`);g.value=r.data},A=async({content:r})=>{const{data:a}=await p.post("/api/suggestions",{branchId:e.value.branchId,type:"printer",content:r});return g.value.push(a.data),a.data},E=async()=>{_.value=!0;try{b.value===h.Create?await W():await j(),Z().fetch(),s.value={},ee.fire()}catch(r){s.value=r.response.data.errors??{}}_.value=!1},W=async()=>{await p.post("/api/print-templates",e.value),z()},j=async()=>{await p.patch(`/api/print-templates/${e.value.id}`,e.value),I()},z=()=>{e.value={branchId:e.value.branchId},s.value=[]},I=()=>{D("close"),U.back()};return(r,a)=>(u(),S(K,null,{header:y(()=>[k(f(b.value===l(h).Create?"Create New Print Template":"Edit Print Template"),1)]),body:y(()=>[t("form",{id:"form",onSubmit:H(E,["prevent","stop"]),class:"grid grid-cols-1 gap-4"},[l(P).length>1?(u(),v("div",ae,[m(te,{modelValue:e.value.branchId,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.branchId=o),error:s.value.branchId,onSelect:w,onChange:N},null,8,["modelValue","error"])])):c("",!0),t("div",se,[V(t("input",{"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.name=o),class:i(["input peer",{"border-red-500":s.value.hasOwnProperty("name")}])},null,2),[[T,e.value.name]]),t("label",{class:i(["label",{"text-red-500":s.value.hasOwnProperty("name")}])},"Name",2),s.value.hasOwnProperty("name")?(u(),v("p",le,f(s.value.name[0]),1)):c("",!0)]),t("div",oe,[V(t("select",{"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.type=o),class:i(["input h-[2.75rem] peer",{"border-red-500":s.value.hasOwnProperty("type")}])},[re,t("option",{value:l(n).VisitBarcode},"Visit Barcode",8,ne),t("option",{value:l(n).SampleBarcode},"Sample Barcode",8,ie),t("option",{value:l(n).SampleBarcodeDepWise},"Sample Barcode (Dep. Wise)",8,ue),t("option",{value:l(n).Invoice},"Invoice",8,de),t("option",{value:l(n).Results},"Results",8,pe),t("option",{value:l(n).PremaritalResult},"Premarital Result",8,ce),t("option",{value:l(n).PremaritalReferral},"Premarital Referral",8,ve),t("option",{value:l(n).PurchaseOrder},"Purchase Order",8,me),t("option",{value:l(n).ReceivingOrder},"Receiving Order",8,he)],2),[[G,e.value.type]]),t("label",{class:i(["label",{"text-red-500":s.value.hasOwnProperty("type")}])},"Type",2),s.value.hasOwnProperty("type")?(u(),v("p",be,f(s.value.type[0]),1)):c("",!0)]),e.value.type===l(n).Results?(u(),v("div",_e,[m(l(B),{modelValue:e.value.tests,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.tests=o),mode:"tags",options:O.value,searchable:!0,object:!0,"value-prop":"id",label:"shortForm","track-by":"searchableForm",class:"px-0 input peer"},null,8,["modelValue","options"]),t("label",{class:i(["label",{"text-red-500":s.value.hasOwnProperty("tests")}])},"Tests",2)])):c("",!0),t("div",ye,[V(t("input",{"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.reportPath=o),class:i(["input peer",{"border-red-500":s.value.hasOwnProperty("reportPath")}])},null,2),[[T,e.value.reportPath]]),t("label",{class:i(["label",{"text-red-500":s.value.hasOwnProperty("reportPath")}])},"Report Path",2),s.value.hasOwnProperty("reportPath")?(u(),v("p",fe,f(s.value.reportPath[0]),1)):c("",!0)]),t("div",Pe,[m(l(B),{modelValue:e.value.printer,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.printer=o),options:g.value,"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":!0,"on-create":A,class:i(["input peer",{"border-red-500":s.value.hasOwnProperty("printer")}])},null,8,["modelValue","options","class"]),t("label",{class:i(["label",{"text-red-500":s.value.hasOwnProperty("printer")}])},"Printer",2)]),t("div",ge,[m(l(R),{modelValue:e.value.isDefault,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value.isDefault=o),class:"input peer pt-2.5"},null,8,["modelValue"]),we])],32)]),footer:y(()=>[t("button",{class:"me-2 btn-blue",disabled:_.value,form:"form"},[m(J,{"is-loading":_.value},{default:y(()=>[k("Save")]),_:1},8,["is-loading"])],8,Ve),t("button",{onClick:I,class:"btn-gray"},"Cancel"),b.value===l(h).Edit?(u(),S(l(R),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.isActive=o),class:"toggle:off:red ms-auto"},null,8,["modelValue"])):c("",!0)]),_:1}))}});export{Be as default};
