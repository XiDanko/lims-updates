import{d as q,e as y,x as z,Q as x,o as d,c as u,b as t,a as h,g as a,u as Z,a2 as J,U as K,R as L,w as R,k as E,t as c,n as m,i,h as g,v as k,a0 as F,F as X,V as Y,f as ee,_ as te,a9 as re,m as oe,l as se,Z as le}from"./main-56f58ed8.js";import{b as ae}from"./toggle-876d3de4.js";import{s as P}from"./multiselect-167e14f5.js";import{_ as ne}from"./Tinymce.vue_vue_type_script_setup_true_lang-422859e6.js";import{F as $}from"./formMode-f60a729f.js";import{R as p}from"./resultType-49e5c481.js";const de={class:"flex"},ue={class:"select-none w-52 grid grid-cols-4 gap-1 mt-3 mx-auto"},ie=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",class:"w-6 h-6 mx-auto mt-0.5"},[t("path",{d:"M9.375 233.4l128-128c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H480c17.69 0 32 14.31 32 32s-14.31 32-32 32H109.3l73.38 73.38c12.5 12.5 12.5 32.75 0 45.25c-12.49 12.49-32.74 12.51-45.25 0l-128-128C-3.125 266.1-3.125 245.9 9.375 233.4z"})],-1),pe=[ie],ve=q({__name:"FormulaGenerator",props:{modelValue:null},emits:["update:modelValue"],setup(N,{emit:V}){const C=N,I=y([]),e=y([]),b=y("");z(()=>{C.modelValue&&(b.value=C.modelValue),_()});const _=async()=>{const{data:f}=await x.get("/api/parameters/list");I.value=f.data},r=f=>{b.value+=f,V("update:modelValue",b.value)},T=()=>{b.value="",e.value=[],V("update:modelValue",b.value)},w=()=>{b.value=b.value.slice(0,-1),V("update:modelValue",b.value)};return(f,o)=>(d(),u("div",null,[t("div",de,[h(a(P),{options:I.value,modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value=n),mode:"multiple",onSelect:o[1]||(o[1]=n=>r(`{${n}}`)),searchable:!0,"value-prop":"shortForm","track-by":"searchableForm",label:"shortForm",class:"w-52 m-0 border border-gray-300 !rounded"},null,8,["options","modelValue"])]),t("div",ue,[t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[2]||(o[2]=n=>r("("))},"("),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[3]||(o[3]=n=>r(")"))},")"),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[4]||(o[4]=n=>r("%"))},"%"),t("div",{class:"transition py-1 text-center bg-red-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-red-600",onClick:w},pe),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[5]||(o[5]=n=>r("7"))},"7"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[6]||(o[6]=n=>r("8"))},"8"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[7]||(o[7]=n=>r("9"))},"9"),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[8]||(o[8]=n=>r("+"))},"+"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[9]||(o[9]=n=>r("4"))},"4"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[10]||(o[10]=n=>r("5"))},"5"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[11]||(o[11]=n=>r("6"))},"6"),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[12]||(o[12]=n=>r("-"))},"-"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[13]||(o[13]=n=>r("1"))},"1"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[14]||(o[14]=n=>r("2"))},"2"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[15]||(o[15]=n=>r("3"))},"3"),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[16]||(o[16]=n=>r("*"))},"*"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[17]||(o[17]=n=>r("0"))},"0"),t("div",{class:"transition py-1 text-center bg-blue-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-blue-600",onClick:o[18]||(o[18]=n=>r("."))},"."),t("div",{class:"transition py-1 text-center bg-red-500 text-white text-lg font-bold rounded cursor-pointer hover:bg-red-600",onClick:T},"AC"),t("div",{class:"transition py-1 text-center bg-gray-600 text-white text-lg font-bold rounded cursor-pointer hover:bg-gray-700",onClick:o[19]||(o[19]=n=>r("/"))},"/")])]))}}),be=["onSubmit"],ce={class:"grid grid-cols-2 gap-3"},me={key:0,class:"flex flex-wrap items-start"},ge=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Branch",-1),ye={key:0,class:"ml-40 w-full text-red-500 text-sm"},fe={class:"flex flex-wrap items-start"},xe=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Test",-1),he={key:0,class:"ml-40 w-full text-red-500 text-sm"},we={class:"flex flex-wrap items-start"},ke=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Seq. No.",-1),_e={key:0,class:"ml-40 w-full text-red-500 text-sm"},Ve={class:"flex flex-wrap items-start"},Ce=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Code",-1),$e={key:0,class:"ml-40 w-full text-red-500 text-sm"},Pe={class:"flex flex-wrap items-start"},Ie=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Name",-1),Te={key:0,class:"ml-40 w-full text-red-500 text-sm"},Re={class:"flex flex-wrap items-start"},Fe=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Short Form",-1),Ne={key:0,class:"ml-40 w-full text-red-500 text-sm"},Oe={class:"flex flex-wrap items-start"},Se=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Heading",-1),Ue=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Result Type",-1),Le=["value"],Ee=["value"],qe=["value"],ze=["value"],Be=["value"],He=["value"],Me={key:0,class:"ml-40 w-full text-red-500 text-sm"},De={key:1,class:"col-span-2 flex flex-wrap items-start"},Ae=t("span",{class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},"Results List",-1),We={key:0,class:"ml-40 w-full text-red-500 text-sm"},je={class:"col-span-2 flex flex-wrap items-start"},Ge={key:0,class:"w-40 p-2 border border-gray-300 border-r-0 rounded-l bg-gray-100"},Qe=t("option",{value:""},null,-1),Ze=t("option",{value:"negative"},"Negative",-1),Je=t("option",{value:"positive"},"Positive",-1),Ke=[Qe,Ze,Je],Xe=t("option",{value:""},null,-1),Ye=["value"],et=["readonly"],tt={key:5},rt={key:7,class:"ml-40 w-full text-red-500 text-sm"},ot={key:2,class:"col-span-2"},st={class:"flex flex-wrap items-start justify-center"},lt=["disabled"],vt=q({__name:"ParameterForm",emits:["close"],setup(N,{emit:V}){const C=oe(),I=se(),e=y({}),b=y($.Create),_=y(!1),r=y({}),T=y([]),w=Z().user.branches,f=y([]),o=y({});z(()=>{w.length===1&&(e.value.branchId=w[0].id,n()),C.path.endsWith("/edit")&&(b.value=$.Edit,A(C.params.id))});const n=()=>{D(),H(),o.value=J().data.general?.find(v=>v.branchId===e.value.branchId)},B=()=>{e.value.testId=null,e.value.heading=null,e.value.sequenceNumber=null},H=async()=>{const{data:v}=await x.get(`/api/suggestions/list?branchId=${e.value.branchId}&type=parameterHeading`);f.value=v.data},M=async({content:v})=>{const{data:s}=await x.post("/api/suggestions",{branchId:e.value.branchId,type:"parameterHeading",content:v});return f.value.push(s.data),s.data},D=async()=>{const{data:v}=await x.get(`/api/tests/list?branchId=${e.value.branchId}`);T.value=v.data},O=async()=>{const{data:v}=await x.post("/api/parameters/generate-sequence",{testId:e.value.testId});e.value.sequenceNumber=v},A=async v=>{const{data:s}=await x.get(`/api/parameters/${v}`);e.value=s.data,n()},W=async()=>{_.value=!0;try{b.value===$.Create?await j():await G(),le.fire()}catch(v){r.value=v.response.data.errors??{}}_.value=!1},j=async()=>{await x.post("/api/parameters",e.value),Q(),await O()},G=async()=>{await x.patch(`/api/parameters/${e.value.id}`,e.value),S()},Q=()=>{e.value={branchId:e.value.branchId,testId:e.value.testId,heading:e.value.heading},r.value=[]},S=()=>{V("close"),I.back()};return(v,s)=>{const U=K("maska");return d(),L(re,{"modal-class":"!w-[56rem]"},{header:R(()=>[E(c(b.value===a($).Create?"Create New Parameter":"Edit Parameter"),1)]),body:R(()=>[t("form",{id:"form",onSubmit:ee(W,["prevent","stop"])},[t("div",ce,[a(w).length>1?(d(),u("div",me,[ge,h(a(P),{modelValue:e.value.branchId,"onUpdate:modelValue":s[0]||(s[0]=l=>e.value.branchId=l),options:a(w),onSelect:n,onChange:B,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"name","can-deselect":!1,"can-clear":!1,class:m(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("branchId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("branchId")?(d(),u("p",ye,c(r.value.branchId[0]),1)):i("",!0)])):i("",!0),t("div",fe,[xe,h(a(P),{modelValue:e.value.testId,"onUpdate:modelValue":s[1]||(s[1]=l=>e.value.testId=l),options:T.value,onSelect:O,searchable:!0,"value-prop":"id","track-by":"searchableForm",label:"shortForm",class:m(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("testId")}])},null,8,["modelValue","options","class"]),r.value.hasOwnProperty("testId")?(d(),u("p",he,c(r.value.testId[0]),1)):i("",!0)]),t("div",we,[ke,g(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>e.value.sequenceNumber=l),"data-maska":"###",size:"1",class:m(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("sequenceNumber")}])},null,2),[[k,e.value.sequenceNumber],[U]]),r.value.hasOwnProperty("sequenceNumber")?(d(),u("p",_e,c(r.value.sequenceNumber[0]),1)):i("",!0)]),t("div",Ve,[Ce,g(t("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>e.value.code=l),size:"1",class:m(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("code")}])},null,2),[[k,e.value.code]]),r.value.hasOwnProperty("code")?(d(),u("p",$e,c(r.value.code[0]),1)):i("",!0)]),t("div",Pe,[Ie,g(t("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>e.value.name=l),size:"1",class:m(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("name")}])},null,2),[[k,e.value.name]]),r.value.hasOwnProperty("name")?(d(),u("p",Te,c(r.value.name[0]),1)):i("",!0)]),t("div",Re,[Fe,g(t("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>e.value.shortForm=l),size:"1",class:m(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("shortForm")}])},null,2),[[k,e.value.shortForm]]),r.value.hasOwnProperty("shortForm")?(d(),u("p",Ne,c(r.value.shortForm[0]),1)):i("",!0)]),t("div",Oe,[Se,h(a(P),{modelValue:e.value.heading,"onUpdate:modelValue":s[6]||(s[6]=l=>e.value.heading=l),options:f.value,"value-prop":"content","track-by":"content",label:"content",searchable:!0,"create-option":!0,"on-create":M,class:"flex-1 border border-gray-300 !rounded-r"},null,8,["modelValue","options"])]),t("div",{class:m(["flex flex-wrap items-start",{"col-span-2 ":a(w).length===1}])},[Ue,g(t("select",{"onUpdate:modelValue":s[7]||(s[7]=l=>e.value.resultType=l),onChange:s[8]||(s[8]=l=>e.value.defaultResult=null),class:m(["flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("resultType")}])},[t("option",{value:a(p).NegativePositive},"N/P",8,Le),t("option",{value:a(p).Numeric},"Numeric",8,Ee),t("option",{value:a(p).Text},"Text",8,qe),t("option",{value:a(p).List},"List",8,ze),t("option",{value:a(p).Formula},"Formula",8,Be),t("option",{value:a(p).Editor},"Editor",8,He)],34),[[F,e.value.resultType]]),r.value.hasOwnProperty("resultType")?(d(),u("p",Me,c(r.value.resultType[0]),1)):i("",!0)],2),e.value.resultType===a(p).List?(d(),u("div",De,[Ae,h(a(P),{class:m(["flex-1 border border-gray-300 !rounded-r",{"!border-red-500":r.value.hasOwnProperty("resultsList")}]),placeholder:"Type then press enter to create",modelValue:e.value.resultsList,"onUpdate:modelValue":s[9]||(s[9]=l=>e.value.resultsList=l),options:e.value.resultsList,mode:"tags","create-option":!0,searchable:!0,"close-on-select":!1},null,8,["class","modelValue","options"]),r.value.hasOwnProperty("resultsList")?(d(),u("p",We,c(r.value.resultsList[0]),1)):i("",!0)])):i("",!0),t("div",je,[e.value.resultType!==a(p).Editor?(d(),u("span",Ge,"Default Result")):i("",!0),e.value.resultType===a(p).NegativePositive?g((d(),u("select",{key:1,"onUpdate:modelValue":s[10]||(s[10]=l=>e.value.defaultResult=l),class:"flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500"},Ke,512)),[[F,e.value.defaultResult]]):i("",!0),e.value.resultType===a(p).List?g((d(),u("select",{key:2,"onUpdate:modelValue":s[11]||(s[11]=l=>e.value.defaultResult=l),class:"flex-1 px-2 py-1 h-[42px] border border-gray-300 rounded-r focus:border-blue-500"},[Xe,(d(!0),u(X,null,Y(e.value.resultsList,l=>(d(),u("option",{value:l},c(l),9,Ye))),256))],512)),[[F,e.value.defaultResult]]):i("",!0),[a(p).Text,a(p).Formula].includes(e.value.resultType)?g((d(),u("input",{key:3,"onUpdate:modelValue":s[12]||(s[12]=l=>e.value.defaultResult=l),readonly:e.value.resultType===a(p).Formula,size:"1",class:m(["flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500",{"!border-red-500":r.value.hasOwnProperty("defaultResult")}])},null,10,et)),[[k,e.value.defaultResult]]):i("",!0),e.value.resultType===a(p).Numeric?g((d(),u("input",{key:4,"onUpdate:modelValue":s[13]||(s[13]=l=>e.value.defaultResult=l),"data-maska":"0.0","data-maska-tokens":"0:[0-9]:multiple",size:"1",class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512)),[[k,e.value.defaultResult],[U]]):i("",!0),e.value.resultType===a(p).Editor?(d(),u("div",tt,[h(ne,{modelValue:e.value.defaultResult,"onUpdate:modelValue":s[14]||(s[14]=l=>e.value.defaultResult=l),"limit-width":o.value?.resultEditorMaxWidth,"limit-height":o.value?.resultEditorMaxHeight},null,8,["modelValue","limit-width","limit-height"])])):i("",!0),e.value.resultType?i("",!0):g((d(),u("input",{key:6,"onUpdate:modelValue":s[15]||(s[15]=l=>e.value.defaultResult=l),size:"1",disabled:"",class:"flex-1 p-2 border border-gray-300 rounded-r focus:border-blue-500"},null,512)),[[k,e.value.defaultResult]]),r.value.hasOwnProperty("defaultResult")?(d(),u("p",rt,c(r.value.defaultResult[0]),1)):i("",!0)]),e.value.resultType===a(p).Formula?(d(),u("div",ot,[t("div",st,[h(ve,{modelValue:e.value.defaultResult,"onUpdate:modelValue":s[16]||(s[16]=l=>e.value.defaultResult=l)},null,8,["modelValue"])])])):i("",!0)])],40,be)]),footer:R(()=>[t("button",{class:"btn-blue mr-2",disabled:_.value,form:"form"},[h(te,{"is-loading":_.value},{default:R(()=>[E("Save")]),_:1},8,["is-loading"])],8,lt),t("button",{onClick:S,class:"btn-gray"},"Cancel"),b.value===a($).Edit?(d(),L(a(ae),{key:0,modelValue:e.value.isActive,"onUpdate:modelValue":s[17]||(s[17]=l=>e.value.isActive=l),class:"ml-auto toggle:off:red"},null,8,["modelValue"])):i("",!0)]),_:1})}}});export{vt as default};
